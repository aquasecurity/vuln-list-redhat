{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20242905",
  "Version": "636",
  "Metadata": {
    "Title": "rpm-ostree: world-readable /etc/shadow file (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-2905",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-2905"
      }
    ],
    "Description": "DOCUMENTATION: A security vulnerability has been discovered within rpm-ostree, pertaining to the /etc/shadow file in default builds having the world-readable bit enabled. This issue arises from the default permissions being set at a higher level than recommended, potentially exposing sensitive authentication data to unauthorized access. \n            STATEMENT: This vulnerability lets local, unconfined applications read the hashed password for all users of the system from those files. To gain further access to the system, those hashed passwords need to be brute-forced to discover the real passwords that may be used to authenticate as a more privileged user on the system, for example over SSH.\n\nOn systems with SELinux enabled and in enforcing mode, access to those files is limited to unconfined (usually interactive) users, unconfined systemd services and privileged containers. Confined daemons, users and containers are not able to access them.\n\n\nOnly OpenShift clusters installed on OCP version 4.14 and later are affected.\nOpenShift Clusters installed on previous OCP releases or updated to 4.14 and later are not affected, because /etc/shadow is usually “locally modified” and the local version remains.\nClusters with no passwords set for any users (i.e. only SSH keys were used; the OpenShift default) are not impacted by this vulnerability even though it is present on the node.\n            MITIGATION: If you need to apply the fix immediately, you can run the following commands, using credentials that have administrator access to an OpenShift cluster:\n\n# List current permissions for all nodes\nfor node in $( oc get nodes -oname) ; do echo $node ; oc debug $node -- bash -c \"ls -alhZ /host/etc/*shadow*\"; done\n\n# Set correct permissions\nfor node in $( oc get nodes -oname) ; do echo $node ; oc debug $node -- chmod --verbose 0000 /host/etc/shadow /host/etc/gshadow /host/etc/shadow- /host/etc/gshadow-; done\n\nAs a precaution, we recommend rotating all user credentials stored in those files.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-04-10"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-2905",
          "Cvss3": "6.2/CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-732",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-2905",
          "Public": "20240409:1100"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.15",
        "cpe:/a:redhat:openshift:4.15::el8"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201714623004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623003"
          },
          {
            "Comment": "rpm-ostree is installed",
            "TestRef": "oval:com.redhat.cve:tst:20242905001"
          },
          {
            "Comment": "rpm-ostree is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:20242905002"
          }
        ]
      }
    ]
  }
}