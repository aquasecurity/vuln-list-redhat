{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202330861",
  "Version": "636",
  "Metadata": {
    "Title": "flask: Possible disclosure of permanent session cookie due to missing Vary: Cookie header (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-30861",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-30861"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the Python Flask package. A cached response may contain data for one client sent by a proxy to other clients, including session cookies, resulting in the compromise of data confidentiality contained in the leak requests or cookies. This happens when the following conditions are met by the proxy's behavior regarding cookies and the application's behavior session usage:\n1. The caching proxy does not strip or ignore response with cookies\n2. The application sets a permanent session\n3. The application does not access or modify the session during requests\n4. SESSION_REFRESH_EACH_REQUEST is enabled, which is the default Flask behavior\n5. The application does not set the Cache-Control header to avoid being cached",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2023-11-30"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-30861",
          "Cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-488",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-30861",
          "Public": "20230505"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          },
          {
            "Comment": "python3-flask is installed",
            "TestRef": "oval:com.redhat.cve:tst:202330861001"
          },
          {
            "Comment": "python3-flask is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:202330861002"
          }
        ]
      }
    ]
  }
}