{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202434064",
  "Version": "636",
  "Metadata": {
    "Title": "jinja2: accepts keys containing non-attribute characters (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-34064",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-34064"
      }
    ],
    "Description": "DOCUMENTATION: The MITRE CVE dictionary describes this issue as: Jinja is an extensible templating engine. The `xmlattr` filter in affected versions of Jinja accepts keys containing non-attribute characters. XML/HTML attributes cannot contain spaces, `/`, `\u003e`, or `=`, as each would then be interpreted as starting a separate attribute. If an application accepts keys (as opposed to only values) as user input, and renders these in pages that other users see as well, an attacker could use this to inject other attributes and perform XSS. The fix for CVE-2024-22195 only addressed spaces but not other characters. Accepting keys as user input is now explicitly considered an unintended use case of the `xmlattr` filter, and code that does so without otherwise validating the input should be flagged as insecure, regardless of Jinja version. Accepting _values_ as user input continues to be safe. This vulnerability is fixed in 3.1.4. \n            STATEMENT: The fix for CVE-2024-22195 only addressed spaces, not other characters. Accepting keys as user input is now explicitly considered an unintended use case of the `xmlattr` filter, and code that does so without otherwise validating the input should be flagged as insecure, regardless of Jinja version. Accepting _values_ as user input continues to be safe.\n\nFence agents on RHEL 8 has been fixed as a part of https://access.redhat.com/errata/RHBA-2024:4238\n            MITIGATION: Do not accept user input as keys to the xmlattr filter without validation. See the statement above for more information.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-08-19"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-34064",
          "Cvss3": "5.4/CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
          "Cwe": "CWE-79",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-34064",
          "Public": "20240506"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ilo2 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153079"
                  },
                  {
                    "Comment": "fence-agents-ilo2 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153080"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ilo-ssh is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153017"
                  },
                  {
                    "Comment": "fence-agents-ilo-ssh is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-compute is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153009"
                  },
                  {
                    "Comment": "fence-agents-compute is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-apc-snmp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153019"
                  },
                  {
                    "Comment": "fence-agents-apc-snmp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-amt-ws is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153035"
                  },
                  {
                    "Comment": "fence-agents-amt-ws is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153036"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-apc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153031"
                  },
                  {
                    "Comment": "fence-agents-apc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153032"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-cisco-ucs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153041"
                  },
                  {
                    "Comment": "fence-agents-cisco-ucs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-heuristics-ping is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153053"
                  },
                  {
                    "Comment": "fence-agents-heuristics-ping is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153054"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202434064017"
                  },
                  {
                    "Comment": "fence-agents is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202434064018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-vmware-rest is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153093"
                  },
                  {
                    "Comment": "fence-agents-vmware-rest is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153094"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-aliyun is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153069"
                  },
                  {
                    "Comment": "fence-agents-aliyun is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153070"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ibm-powervs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153057"
                  },
                  {
                    "Comment": "fence-agents-ibm-powervs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153058"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-rhevm is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153049"
                  },
                  {
                    "Comment": "fence-agents-rhevm is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153050"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-bladecenter is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153029"
                  },
                  {
                    "Comment": "fence-agents-bladecenter is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-redfish is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153045"
                  },
                  {
                    "Comment": "fence-agents-redfish is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153046"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-eps is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153001"
                  },
                  {
                    "Comment": "fence-agents-eps is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-mpath is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153055"
                  },
                  {
                    "Comment": "fence-agents-mpath is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153056"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-hpblade is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153021"
                  },
                  {
                    "Comment": "fence-agents-hpblade is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ilo-moonshot is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153039"
                  },
                  {
                    "Comment": "fence-agents-ilo-moonshot is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ilo-mp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153099"
                  },
                  {
                    "Comment": "fence-agents-ilo-mp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153100"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-rsa is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153013"
                  },
                  {
                    "Comment": "fence-agents-rsa is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-drac5 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153011"
                  },
                  {
                    "Comment": "fence-agents-drac5 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-aws is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153077"
                  },
                  {
                    "Comment": "fence-agents-aws is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153078"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ifmib is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153067"
                  },
                  {
                    "Comment": "fence-agents-ifmib is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153068"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-kubevirt is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153105"
                  },
                  {
                    "Comment": "fence-agents-kubevirt is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153106"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ibmblade is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153101"
                  },
                  {
                    "Comment": "fence-agents-ibmblade is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153102"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-scsi is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153087"
                  },
                  {
                    "Comment": "fence-agents-scsi is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153088"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-intelmodular is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153025"
                  },
                  {
                    "Comment": "fence-agents-intelmodular is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ipmilan is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153047"
                  },
                  {
                    "Comment": "fence-agents-ipmilan is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153048"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-wti is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153075"
                  },
                  {
                    "Comment": "fence-agents-wti is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153076"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-virsh is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153089"
                  },
                  {
                    "Comment": "fence-agents-virsh is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153090"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-kdump is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153051"
                  },
                  {
                    "Comment": "fence-agents-kdump is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153052"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ipdu is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153083"
                  },
                  {
                    "Comment": "fence-agents-ipdu is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153084"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-all is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153023"
                  },
                  {
                    "Comment": "fence-agents-all is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-cisco-mds is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153091"
                  },
                  {
                    "Comment": "fence-agents-cisco-mds is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153092"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-brocade is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153065"
                  },
                  {
                    "Comment": "fence-agents-brocade is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153066"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-vmware-soap is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153005"
                  },
                  {
                    "Comment": "fence-agents-vmware-soap is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-sbd is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153007"
                  },
                  {
                    "Comment": "fence-agents-sbd is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-lpar is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153063"
                  },
                  {
                    "Comment": "fence-agents-lpar is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153064"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-gce is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153073"
                  },
                  {
                    "Comment": "fence-agents-gce is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153074"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-rsb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153097"
                  },
                  {
                    "Comment": "fence-agents-rsb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153098"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-openstack is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202434064083"
                  },
                  {
                    "Comment": "fence-agents-openstack is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202434064084"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-eaton-snmp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153027"
                  },
                  {
                    "Comment": "fence-agents-eaton-snmp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-azure-arm is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153059"
                  },
                  {
                    "Comment": "fence-agents-azure-arm is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153060"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-ibm-vpc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153061"
                  },
                  {
                    "Comment": "fence-agents-ibm-vpc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153062"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-zvm is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153071"
                  },
                  {
                    "Comment": "fence-agents-zvm is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153072"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153095"
                  },
                  {
                    "Comment": "fence-agents-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153096"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "fence-agents-emerson is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201910153033"
                  },
                  {
                    "Comment": "fence-agents-emerson is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201910153034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module python27:2.7 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:20074559015"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "python-jinja2 is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202128861071"
                          },
                          {
                            "Comment": "python-jinja2 is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202128861072"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "python3-jinja2 is installed",
                            "TestRef": "oval:com.redhat.cve:tst:202434064099"
                          },
                          {
                            "Comment": "python3-jinja2 is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:202434064100"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}