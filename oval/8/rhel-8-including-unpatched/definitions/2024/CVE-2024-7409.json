{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20247409",
  "Version": "636",
  "Metadata": {
    "Title": "QEMU: Denial of Service via Improper Synchronization in QEMU NBD Server During Socket Closure (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-7409",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-7409"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the QEMU NBD Server. This vulnerability allows a denial of service (DoS) attack via improper synchronization during socket closure when a client keeps a socket open as the server is taken offline. \n            STATEMENT: This issue is classified as Moderate severity rather than Important because it primarily results in a denial of service condition rather than a more crucial impact such as data corruption, unauthorized access, or system compromise. The NULL pointer dereference occurs under specific conditions where the NBD server is stopped before nbd_blockdev_client_closed is called, which leads to a segmentation fault and crash of the QEMU process. However, this scenario is mitigated by the fact that it requires a particular sequence of events involving client connection handling and server shutdown. Additionally, proper network segmentation and the use of secure client connections can further reduce the likelihood of this issue being exploited.\n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-08-05"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-7409",
          "Cvss3": "7.5/CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-662",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-7409",
          "Public": "20240802:1105"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt-devel:rhel is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:20247409031"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-ui-spice is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067019"
                          },
                          {
                            "Comment": "qemu-kvm-ui-spice is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067020"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-core is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067003"
                          },
                          {
                            "Comment": "qemu-kvm-core is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-ssh is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067009"
                          },
                          {
                            "Comment": "qemu-kvm-block-ssh is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067010"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-curl is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067027"
                          },
                          {
                            "Comment": "qemu-kvm-block-curl is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067028"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-img is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067017"
                          },
                          {
                            "Comment": "qemu-img is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067018"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-common is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067021"
                          },
                          {
                            "Comment": "qemu-kvm-common is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067022"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-tests is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067023"
                          },
                          {
                            "Comment": "qemu-kvm-tests is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067024"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-hw-usbredir is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067025"
                          },
                          {
                            "Comment": "qemu-kvm-hw-usbredir is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067026"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-rbd is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067029"
                          },
                          {
                            "Comment": "qemu-kvm-block-rbd is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067030"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-iscsi is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067005"
                          },
                          {
                            "Comment": "qemu-kvm-block-iscsi is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067006"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-docs is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067015"
                          },
                          {
                            "Comment": "qemu-kvm-docs is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067016"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067001"
                          },
                          {
                            "Comment": "qemu-kvm is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-gluster is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067031"
                          },
                          {
                            "Comment": "qemu-kvm-block-gluster is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067032"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-guest-agent is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067013"
                          },
                          {
                            "Comment": "qemu-guest-agent is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067014"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-ui-opengl is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067011"
                          },
                          {
                            "Comment": "qemu-kvm-ui-opengl is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067012"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module virt:rhel is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:201913164033"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "OR",
                    "Criterias": [
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-ui-spice is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067019"
                          },
                          {
                            "Comment": "qemu-kvm-ui-spice is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067020"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-core is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067003"
                          },
                          {
                            "Comment": "qemu-kvm-core is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067004"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-ssh is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067009"
                          },
                          {
                            "Comment": "qemu-kvm-block-ssh is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067010"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-curl is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067027"
                          },
                          {
                            "Comment": "qemu-kvm-block-curl is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067028"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-img is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067017"
                          },
                          {
                            "Comment": "qemu-img is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067018"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-common is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067021"
                          },
                          {
                            "Comment": "qemu-kvm-common is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067022"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-tests is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067023"
                          },
                          {
                            "Comment": "qemu-kvm-tests is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067024"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-hw-usbredir is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067025"
                          },
                          {
                            "Comment": "qemu-kvm-hw-usbredir is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067026"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-rbd is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067029"
                          },
                          {
                            "Comment": "qemu-kvm-block-rbd is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067030"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-iscsi is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067005"
                          },
                          {
                            "Comment": "qemu-kvm-block-iscsi is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067006"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-docs is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067015"
                          },
                          {
                            "Comment": "qemu-kvm-docs is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067016"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067001"
                          },
                          {
                            "Comment": "qemu-kvm is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067002"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-block-gluster is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067031"
                          },
                          {
                            "Comment": "qemu-kvm-block-gluster is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067032"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-guest-agent is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067013"
                          },
                          {
                            "Comment": "qemu-guest-agent is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067014"
                          }
                        ]
                      },
                      {
                        "Operator": "AND",
                        "Criterions": [
                          {
                            "Comment": "qemu-kvm-ui-opengl is installed",
                            "TestRef": "oval:com.redhat.cve:tst:201912067011"
                          },
                          {
                            "Comment": "qemu-kvm-ui-opengl is signed with Red Hat redhatrelease2 key",
                            "TestRef": "oval:com.redhat.cve:tst:201912067012"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}