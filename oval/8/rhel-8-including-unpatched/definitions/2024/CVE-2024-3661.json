{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20243661",
  "Version": "636",
  "Metadata": {
    "Title": "DHCP: DHCP routing options can manipulate interface-based VPN traffic (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-3661",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-3661"
      }
    ],
    "Description": "DOCUMENTATION: DHCP can add routes to a clientâ€™s routing table via the classless static route option (121). VPN-based security solutions that rely on routes to redirect traffic can be forced to leak traffic over the physical interface. An attacker on the same local network can read, disrupt, or possibly modify network traffic expected to be protected by the VPN. \n            STATEMENT: This vulnerability is also known as TunnelVision and it describes a technique to use DHCP configuration to manipulate hosts to send traffic to an attacker's host instead of through a VPN, as expected. According to MITRE it is reported as a vulnerability against DHCP. However, the DHCP protocol works as intended and as a protocol without cryptographic protection, attackers do not break a security boundary in the DHCP protocol by using the DHCP option 121. To prevent against the attack vector, users or VPN configuration software need to configure the VPN correctly or use other techniques to avoid that a DHCP configuration manipulates routing decisions for packets intended to be contained in the VPN.\n\nThis affects only situations where hosts use DHCP in a network and attackers can control a DHCP server. It affects full-tunnel and split-tunnel based VPNs. IPSec policy-based VPNs do not send unencrypted traffic to attackers as they encrypt traffic regardless of the routing decision.\n            MITIGATION: The mitigation steps also ensure that the applications using the VPN cannot access local resources outside the VPN in full-tunnel mode. If access to local resources outside the VPN is needed, additional routing configuration is necessary.\n\nThe following steps demonstrate how to configure VPN profiles with NetworkManager to prioritize VPN routes over DHCP routes. This uses routing rules with a higher priority than the rule to lookup the main routing table. This means that the VPN routing table is consulted prior to the main routing table. Please note that a higher priority is configured by setting a lower priority value in the routing configuration.\n\n1. There were two bugs in NetworkManager that prevented these steps from working with profiles using VPN plugins, such as libreswan. Therefore first update NetworkManager:\n- On RHEL 8.10, use NetworkManager-1.40.16-18.el8_10 or later.\n- On RHEL 9.5 and later, use NetworkManager-1.48.10-5.el9_5 or later.\n\n2. In the next steps, you will assign the VPN routes to a dedicated routing table. By default, RHEL does not use the routing tables 1-252, and you can use one of them. If you configured the system to use some of these tables, identify a free routing table number. The following example uses the routing table 75.\n\n3. Optional: Configure a name for the routing table by adding a line, such as the following, to the /etc/iproute2/rt_tables file:\n75 vpn\n\nThis makes the output of ip commands easier to understand. Note that NetworkManager only supports using a table ID and not the table name.\n\n4. Configure the VPN connection profile to place the VPN routes in a dedicated routing table:\n# nmcli connection modify \u003cVPN_connection_profile\u003e ipv4.route-table \u003crouting_table_number\u003e\n\nFor example:\n# nmcli connection modify \"Company VPN\" ipv4.route-table 75\n\n5. Set a low priority value for the table you used in the previous command:\n# nmcli connection modify \u003cVPN_connection_profile\u003e ipv4.routing-rules \"priority \u003clow_priority_value\u003e from all table \u003crouting_table_number\u003e\"\n\nThe priority value can be any value between 1 and 32766 but, the lower the value, the higher the priority!\n\nFor example:\n# nmcli connection modify \"Company VPN\" ipv4.routing-rules \"priority 32345 from all table 75\"\n\n6. Reconnect the VPN:\n# nmcli connection down \u003cVPN_connection_profile\u003e\n# nmcli connection up \u003cVPN_connection_profile\u003e\n\nThis only prevents the TunnelVision techniques and possibly related issues regarding IPv4. For IPv6 it might be necessary to repeat the steps for IPv6.\nIf other software than NetworkManager is used to configure a VPN, it might need similar configuration changes to mitigate against TunnelVision.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2025-01-10"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-3661",
          "Cvss3": "7.6/CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
          "Cwe": "(CWE-306|CWE-501)",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-3661",
          "Public": "20240506:1831"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-config-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661001"
                  },
                  {
                    "Comment": "NetworkManager-config-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-wifi is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661003"
                  },
                  {
                    "Comment": "NetworkManager-wifi is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-dispatcher-routing-rules is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661005"
                  },
                  {
                    "Comment": "NetworkManager-dispatcher-routing-rules is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-bluetooth is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661007"
                  },
                  {
                    "Comment": "NetworkManager-bluetooth is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-libnm-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661009"
                  },
                  {
                    "Comment": "NetworkManager-libnm-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-tui is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661011"
                  },
                  {
                    "Comment": "NetworkManager-tui is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-adsl is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661013"
                  },
                  {
                    "Comment": "NetworkManager-adsl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-team is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661015"
                  },
                  {
                    "Comment": "NetworkManager-team is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-ovs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661017"
                  },
                  {
                    "Comment": "NetworkManager-ovs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-cloud-setup is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661019"
                  },
                  {
                    "Comment": "NetworkManager-cloud-setup is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-ppp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661021"
                  },
                  {
                    "Comment": "NetworkManager-ppp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-libnm is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661023"
                  },
                  {
                    "Comment": "NetworkManager-libnm is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-config-connectivity-redhat is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661025"
                  },
                  {
                    "Comment": "NetworkManager-config-connectivity-redhat is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager-wwan is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661027"
                  },
                  {
                    "Comment": "NetworkManager-wwan is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "NetworkManager is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20243661029"
                  },
                  {
                    "Comment": "NetworkManager is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20243661030"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}