{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202345142",
  "Version": "636",
  "Metadata": {
    "Title": "opentelemetry: DoS vulnerability in otelhttp (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-45142",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-45142"
      }
    ],
    "Description": "DOCUMENTATION: A memory leak was found in the otelhttp handler of open-telemetry. This flaw allows a remote, unauthenticated attacker to exhaust the server's memory by sending many malicious requests, affecting the availability. \n            STATEMENT: While no authentication is required, there are a significant number of non-default factors which prevent widespread exploitation of this flaw. For a service to be affected, all of the following must be true:\n* The go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp package must be in use\n* Configured a metrics pipeline which uses the otelhttp.NewHandler wrapper function\n* No filtering of unknown HTTP methods or user agents at a higher level (such as Content Delivery Network/Load Balancer/etc...)\n\nDue to the limited attack surface, Red Hat Product Security rates the impact as Moderate.\n            MITIGATION: As a workaround to stop being affected otelhttp.WithFilter() can be used.\n\nFor convenience and safe usage of this library, it should by default mark with the label unknown non-standard HTTP methods and User agents to show that such requests were made but do not increase cardinality. In case someone wants to stay with the current behavior, library API should allow to enable it.\n\nThe other possibility is to disable HTTP metrics instrumentation by passing otelhttp.WithMeterProvider option with noop.NewMeterProvider.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-06-27"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-45142",
          "Cvss3": "7.5/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-770",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-45142",
          "Public": "20231012"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.16",
        "cpe:/a:redhat:openshift:4.16::el9"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201714623004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202325809001"
                  },
                  {
                    "Comment": "microshift is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202325809002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift-hyperkube is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142003"
                  },
                  {
                    "Comment": "openshift-hyperkube is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-greenboot is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142005"
                  },
                  {
                    "Comment": "microshift-greenboot is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-multus-release-info is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142007"
                  },
                  {
                    "Comment": "microshift-multus-release-info is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift-kube-controller-manager is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142009"
                  },
                  {
                    "Comment": "openshift-kube-controller-manager is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-olm is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142011"
                  },
                  {
                    "Comment": "microshift-olm is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift-kube-scheduler is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142013"
                  },
                  {
                    "Comment": "openshift-kube-scheduler is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift-kubelet is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142015"
                  },
                  {
                    "Comment": "openshift-kubelet is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-multus is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142017"
                  },
                  {
                    "Comment": "microshift-multus is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-selinux is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142019"
                  },
                  {
                    "Comment": "microshift-selinux is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-networking is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142021"
                  },
                  {
                    "Comment": "microshift-networking is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-olm-release-info is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142023"
                  },
                  {
                    "Comment": "microshift-olm-release-info is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101001"
                  },
                  {
                    "Comment": "openshift is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openshift-kube-apiserver is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142027"
                  },
                  {
                    "Comment": "openshift-kube-apiserver is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "microshift-release-info is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202345142029"
                  },
                  {
                    "Comment": "microshift-release-info is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202345142030"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}