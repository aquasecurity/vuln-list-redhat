{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202411218",
  "Version": "636",
  "Metadata": {
    "Title": "podman: buildah: Container breakout by using --jobs=2 and a race condition when building a malicious Containerfile (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-11218",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-11218"
      }
    ],
    "Description": "DOCUMENTATION: A vulnerability was found in `podman build` and `buildah.` This issue occurs in a container breakout by using --jobs=2 and a race condition when building a malicious Containerfile. SELinux might mitigate it, but even with SELinux on, it still allows the enumeration of files and directories on the host. \n            STATEMENT: This vulnerability marked as important severity rather than moderate because it allows a malicious Containerfile to exploit the `--mount` flag in `RUN` instructions to directly interact with the build host's filesystem. By leveraging this, an attacker can gain unauthorized access to sensitive files or inject malicious content using the privileges of the build process. In environments where the build process is executed by a root-owned Podman system service exposed to unprivileged users, this vulnerability escalates to a high level, as it enables unauthorized read/write access to high-privilege files, such as setuid executables.\n            MITIGATION: Mandatory access controls should limit the access of the process performing the build, on systems where they are enabled.\n\nSELinux enforces strict access controls by confining the build process (e.g., Podman) to specific domains like container_t. This prevents unauthorized access to sensitive host files and directories, even if a malicious Containerfile tries to exploit the --mount flag.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2025-01-23"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-11218",
          "Cvss3": "8.6/CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
          "Cwe": "CWE-269",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-11218",
          "Public": "20250120"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.18",
        "cpe:/a:redhat:openshift:4.18::el9"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201714623004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "buildah is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202120206003"
                  },
                  {
                    "Comment": "buildah is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202120206004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "podman is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201918466001"
                  },
                  {
                    "Comment": "podman is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201918466002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rhcos is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202249043001"
                  },
                  {
                    "Comment": "rhcos is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202249043002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}