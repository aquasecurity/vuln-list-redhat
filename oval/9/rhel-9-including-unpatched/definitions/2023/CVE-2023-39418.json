{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202339418",
  "Version": "636",
  "Metadata": {
    "Title": "postgresql: MERGE fails to enforce UPDATE or SELECT row security policies (low)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-39418",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-39418"
      }
    ],
    "Description": "DOCUMENTATION: A vulnerability was found in PostgreSQL with the use of the MERGE command, which fails to test new rows against row security policies defined for UPDATE and SELECT. If UPDATE and SELECT policies forbid some rows that INSERT policies do not forbid, a user could store such rows. \n            STATEMENT: This vulnerability introduced with the use of MERGE Command in PostgreSQL 15 and only affects the databases that have used CREATE POLICY to define a row\nsecurity policy.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Low",
      "Issued": {},
      "Updated": {
        "Date": "2023-12-13"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-39418",
          "Cvss3": "3.1/CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N",
          "Impact": "low",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-39418",
          "Public": "20230810"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          },
          {
            "Comment": "Module postgresql:15 is enabled",
            "TestRef": "oval:com.redhat.cve:tst:20232454029"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-upgrade-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454015"
                  },
                  {
                    "Comment": "postgresql-upgrade-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454017"
                  },
                  {
                    "Comment": "postgresql is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-private-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454005"
                  },
                  {
                    "Comment": "postgresql-private-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454023"
                  },
                  {
                    "Comment": "postgresql-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-plperl is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454021"
                  },
                  {
                    "Comment": "postgresql-plperl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-upgrade is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454025"
                  },
                  {
                    "Comment": "postgresql-upgrade is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-private-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454013"
                  },
                  {
                    "Comment": "postgresql-private-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454019"
                  },
                  {
                    "Comment": "postgresql-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-pltcl is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454007"
                  },
                  {
                    "Comment": "postgresql-pltcl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-plpython3 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454001"
                  },
                  {
                    "Comment": "postgresql-plpython3 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-static is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454003"
                  },
                  {
                    "Comment": "postgresql-static is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-docs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454011"
                  },
                  {
                    "Comment": "postgresql-docs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-server-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454009"
                  },
                  {
                    "Comment": "postgresql-server-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "postgresql-contrib is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20232454027"
                  },
                  {
                    "Comment": "postgresql-contrib is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20232454028"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}