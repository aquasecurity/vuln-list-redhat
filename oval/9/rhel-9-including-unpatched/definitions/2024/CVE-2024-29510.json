{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202429510",
  "Version": "636",
  "Metadata": {
    "Title": "ghostscript: format string injection leads to shell command execution (SAFER bypass) (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-29510",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-29510"
      }
    ],
    "Description": "DOCUMENTATION: A flaw in Ghostscript has been identified where the uniprint device allows users to pass various string fragments as device options. These strings, particularly upWriteComponentCommands and upYMoveCommand, are treated as format strings for gp_fprintf and gs_snprintf. This lack of restriction permits arbitrary format strings with multiple specifiers, potentially leading to data leakage from the stack and memory corruption. In RHEL 9 or newer, an attacker could exploit this vulnerability to temporarily disable Ghostscriptâ€™s SAFER mode, which prevents Postscript code from executing commands or opening arbitrary files during the current invocation. \n            \n            MITIGATION: Passing the -dSAFER safety argument on the command line prevents the issue by locking security-related variables after Ghostscript's initialization. In RHEL 9, -dSAFER is enabled by default, ensuring that insecure commands are rejected in a safer environment. The versions of Ghostscript in RHEL 7 and RHEL 8 have an older implementation of SAFER mode that is not enabled by default, but can be enabled by passing -dSAFER on the command line when invoking Ghostscript. This older SAFER mode implementation denies Postscript code the ability to change the output device, and therefore prevents malicious Postscript code from selecting the uniprint output device in order to exploit the format string vulnerabilities in its upWriteComponentCommands and upYMoveCommand parameters. On RHEL 7 and RHEL 8, we recommend always passing -dSAFER on the command line, and avoiding manually selecting the uniprint output device on the command line.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-08-05"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-29510",
          "Cvss3": "5.5/CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-20",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-29510",
          "Public": "20240516"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ghostscript-tools-printing is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059009"
                  },
                  {
                    "Comment": "ghostscript-tools-printing is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ghostscript-tools-dvipdf is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059013"
                  },
                  {
                    "Comment": "ghostscript-tools-dvipdf is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libgs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059005"
                  },
                  {
                    "Comment": "libgs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ghostscript-tools-fonts is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059007"
                  },
                  {
                    "Comment": "ghostscript-tools-fonts is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libgs-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059011"
                  },
                  {
                    "Comment": "libgs-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ghostscript-doc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059015"
                  },
                  {
                    "Comment": "ghostscript-doc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ghostscript-x11 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059001"
                  },
                  {
                    "Comment": "ghostscript-x11 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ghostscript is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925059003"
                  },
                  {
                    "Comment": "ghostscript is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925059004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}