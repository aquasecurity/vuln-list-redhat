{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202456337",
  "Version": "636",
  "Metadata": {
    "Title": "tomcat: Incomplete fix for CVE-2024-50379 - RCE due to TOCTOU issue in JSP compilation (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-56337",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-56337"
      }
    ],
    "Description": "DOCUMENTATION: The fix for CVE-2024-50379 in Apache Tomcat was insufficient to mitigate the issue fully. A Time-of-check Time-of-use (TOCTOU) race condition occurs during JSP compilation on case-insensitive file systems when the default servlet is enabled for writing. This vulnerability allows an uploaded file to be treated as a JSP and executed, resulting in remote code execution. \n            STATEMENT: The vulnerability is marked as moderate rather than important due to the specific conditions required for exploitation. For the attack to succeed, the server must be running on a case-insensitive file system (e.g., Windows or macOS) and have the default servlet enabled with write permissions â€”a configuration that is not common in production-grade environments. Additionally, the attacker must gain the ability to upload files to a writable directory and exploit a race condition to execute them as JSP files, which introduces a level of complexity and timing dependency.\n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2025-01-15"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-56337",
          "Cvss3": "8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-367",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-56337",
          "Public": "20241220:1528"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:9",
        "cpe:/a:redhat:enterprise_linux:9::appstream",
        "cpe:/a:redhat:enterprise_linux:9::crb",
        "cpe:/a:redhat:enterprise_linux:9::highavailability",
        "cpe:/a:redhat:enterprise_linux:9::nfv",
        "cpe:/a:redhat:enterprise_linux:9::realtime",
        "cpe:/a:redhat:enterprise_linux:9::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:9::sap",
        "cpe:/a:redhat:enterprise_linux:9::sap_hana",
        "cpe:/a:redhat:enterprise_linux:9::supplementary",
        "cpe:/o:redhat:enterprise_linux:9",
        "cpe:/o:redhat:enterprise_linux:9::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 9 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat-docs-webapp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143003"
                  },
                  {
                    "Comment": "tomcat-docs-webapp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat-servlet-4.0-api is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143015"
                  },
                  {
                    "Comment": "tomcat-servlet-4.0-api is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat-el-3.0-api is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143007"
                  },
                  {
                    "Comment": "tomcat-el-3.0-api is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat-webapps is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143017"
                  },
                  {
                    "Comment": "tomcat-webapps is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "pki-servlet-engine is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202141079001"
                  },
                  {
                    "Comment": "pki-servlet-engine is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202141079002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat-lib is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143011"
                  },
                  {
                    "Comment": "tomcat-lib is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat-jsp-2.3-api is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143009"
                  },
                  {
                    "Comment": "tomcat-jsp-2.3-api is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143019"
                  },
                  {
                    "Comment": "tomcat is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "tomcat-admin-webapps is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202245143013"
                  },
                  {
                    "Comment": "tomcat-admin-webapps is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202245143014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "pki-servlet-4.0-api is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202141079003"
                  },
                  {
                    "Comment": "pki-servlet-4.0-api is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202141079004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}