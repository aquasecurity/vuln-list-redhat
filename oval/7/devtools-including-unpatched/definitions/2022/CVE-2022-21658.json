{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202221658",
  "Version": "636",
  "Metadata": {
    "Title": "rust: Race condition in remove_dir_all leading to removal of files outside of the directory being removed (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-21658",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-21658"
      }
    ],
    "Description": "DOCUMENTATION: A race condition flaw was found in Rust's std::fs::remove_dir_all function. Rust applications that use this function may be vulnerable to a race condition where an unprivileged attacker can trick the application into deleting files and directories, causing an impact on system data integrity. If the application is privileged, an attacker can possibly delete files they would not usually have access to. \n            STATEMENT: This flaw has been given a Severity of Moderate because it is not exploitable at will on every Rust program as it requires a specific scenario where a privileged program uses a specific Rust stdlib function, the attacker has some knowledge of the program's file operations,  and has the normal limitations and challenges of a \nTime-of-check to time-of-use (TOCTOU). It must also be carried out by an unprivileged attacker.\n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2022-09-26"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-21658",
          "Cvss3": "5.3/CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N",
          "Cwe": "(CWE-363|CWE-367)",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-21658",
          "Public": "20220120:1100"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:devtools:2",
        "cpe:/a:redhat:devtools:2018",
        "cpe:/a:redhat:devtools:2019",
        "cpe:/a:redhat:devtools:2020",
        "cpe:/a:redhat:devtools:2021",
        "cpe:/a:redhat:devtools:2022",
        "cpe:/a:redhat:devtools:2023",
        "cpe:/a:redhat:devtools:2023::el7",
        "cpe:/a:redhat:devtools:2::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:202015586016"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:202015586015"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust-gdb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658001"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust-gdb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rustfmt is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658003"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rustfmt is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust-std-static is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658005"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust-std-static is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust-analysis is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658007"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust-analysis is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust-doc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658009"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust-doc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-cargo-doc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658011"
                  },
                  {
                    "Comment": "rust-toolset-1.54-cargo-doc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust-debugger-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658013"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust-debugger-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658015"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust-lldb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658017"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust-lldb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rust-src is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658019"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rust-src is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-cargo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658021"
                  },
                  {
                    "Comment": "rust-toolset-1.54-cargo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-rls is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658023"
                  },
                  {
                    "Comment": "rust-toolset-1.54-rls is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rust-toolset-1.54-clippy is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202221658025"
                  },
                  {
                    "Comment": "rust-toolset-1.54-clippy is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202221658026"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}