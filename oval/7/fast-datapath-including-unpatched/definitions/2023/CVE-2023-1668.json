{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20231668",
  "Version": "636",
  "Metadata": {
    "Title": "openvswitch: ip proto 0 triggers incorrect handling (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2023-1668",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2023-1668"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in openvswitch (OVS). When processing an IP packet with protocol 0, OVS will install the datapath flow without the action modifying the IP header. This issue results (for both kernel and userspace datapath) in installing a datapath flow matching all IP protocols (nw_proto is wildcarded) for this flow, but with an incorrect action, possibly causing incorrect handling of other IP packets with a != 0 IP protocol that matches this dp flow. \n            STATEMENT: In OpenShift Container Platform (OCP) the openvswitch rpm package is consumed from the RHEL Fast Datapath repositories, hence OCP openvswitch components are marked as \"Will not fix\".\n            MITIGATION: For any version of Open vSwitch, preventing packets with network\nprotocol number '0' from reaching Open vSwitch will prevent the issue.\nThis is difficult to achieve because Open vSwitch obtains packets before\nthe iptables or nftables host firewall, so iptables or nftables on the\nOpen vSwitch host cannot ordinarily block the vulnerability.\n\nAnother method would be to add a high priority flow to the flow table\nexplicitly matching on nw protocol '0' and handling that traffic\nseparately:\n\n   table=0 priority=32768,ip,ip_proto=0 actions=drop\n\nThis would need to be similarly done for IPv6 traffic as well.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-04-20"
      },
      "Cves": [
        {
          "CveID": "CVE-2023-1668",
          "Cvss3": "8.2/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H",
          "Cwe": "CWE-670",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2023-1668",
          "Public": "20230406"
        }
      ],
      "AffectedCpeList": [
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::fastdatapath"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20158011026"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20158011025"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.10-ovn-vtep is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011003"
                  },
                  {
                    "Comment": "openvswitch2.10-ovn-vtep is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-openvswitch2.11 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076001"
                  },
                  {
                    "Comment": "python-openvswitch2.11 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch-ovn-host is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076005"
                  },
                  {
                    "Comment": "openvswitch-ovn-host is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.11-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076007"
                  },
                  {
                    "Comment": "openvswitch2.11-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.10-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011015"
                  },
                  {
                    "Comment": "openvswitch2.10-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch-ovn-central is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076011"
                  },
                  {
                    "Comment": "openvswitch-ovn-central is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.10-ovn-host is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011017"
                  },
                  {
                    "Comment": "openvswitch2.10-ovn-host is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-openvswitch2.12 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011023"
                  },
                  {
                    "Comment": "python-openvswitch2.12 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-openvswitch is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076019"
                  },
                  {
                    "Comment": "python-openvswitch is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.13-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076017"
                  },
                  {
                    "Comment": "openvswitch2.13-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.13-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076021"
                  },
                  {
                    "Comment": "openvswitch2.13-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python-openvswitch2.10 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011021"
                  },
                  {
                    "Comment": "python-openvswitch2.10 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch-ovn-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076025"
                  },
                  {
                    "Comment": "openvswitch-ovn-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.10-ovn-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011001"
                  },
                  {
                    "Comment": "openvswitch2.10-ovn-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch-ovn-docker is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076029"
                  },
                  {
                    "Comment": "openvswitch-ovn-docker is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.10 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011007"
                  },
                  {
                    "Comment": "openvswitch2.10 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076033"
                  },
                  {
                    "Comment": "openvswitch-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.12-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011009"
                  },
                  {
                    "Comment": "openvswitch2.12-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "python3-openvswitch2.13 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076037"
                  },
                  {
                    "Comment": "python3-openvswitch2.13 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076038"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076039"
                  },
                  {
                    "Comment": "openvswitch is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.13-ipsec is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076041"
                  },
                  {
                    "Comment": "openvswitch2.13-ipsec is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076043"
                  },
                  {
                    "Comment": "openvswitch-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076044"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.12 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011005"
                  },
                  {
                    "Comment": "openvswitch2.12 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.11-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076047"
                  },
                  {
                    "Comment": "openvswitch2.11-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076048"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.10-ovn-central is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011011"
                  },
                  {
                    "Comment": "openvswitch2.10-ovn-central is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.10-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011019"
                  },
                  {
                    "Comment": "openvswitch2.10-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.12-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158011013"
                  },
                  {
                    "Comment": "openvswitch2.12-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158011014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.13 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076055"
                  },
                  {
                    "Comment": "openvswitch2.13 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076056"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch-ovn-vtep is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076057"
                  },
                  {
                    "Comment": "openvswitch-ovn-vtep is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076058"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openvswitch2.11 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201925076059"
                  },
                  {
                    "Comment": "openvswitch2.11 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201925076060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}