{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20201931",
  "Version": "636",
  "Metadata": {
    "Title": "spamassassin: command injection via crafted configuration file (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-1931",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-1931"
      }
    ],
    "Description": "DOCUMENTATION: The MITRE CVE dictionary describes this issue as: A command execution issue was found in Apache SpamAssassin prior to 3.4.3. Carefully crafted nefarious Configuration (.cf) files can be configured to run system commands similar to CVE-2018-11805. This issue is less stealthy and attempts to exploit the issue will throw warnings. Thanks to Damian Lukowski at credativ for reporting the issue ethically. With this bug unpatched, exploits can be injected in a number of scenarios though doing so remotely is difficult. In addition to upgrading to SA 3.4.4, we again recommend that users should only use update channels or 3rd party .cf files from trusted places. \n            STATEMENT: The attack is triggered by malicious specially crafted .cf files which are basically configuration files for spamassasin. These files can be located at:\n1. /usr/share/spamassassin\n2. /etc/mail/spamassassin\n3. user's home directory, in a directory called .spamassassin\n\nAll of these locations can only be accessed by either the system administrator or by a user having a local shell account on the machine. In order to successfully exploit this flaw, the attacker needs to convince the user to place the malicious configuration files in one of the above locations.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2023-12-15"
      },
      "Cves": [
        {
          "CveID": "CVE-2020-1931",
          "Cvss3": "6.7/CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-78",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2020-1931",
          "Public": "20200129"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:7",
        "cpe:/a:redhat:rhel_extras_oracle_java:7",
        "cpe:/a:redhat:rhel_extras_rt:7",
        "cpe:/a:redhat:rhel_extras_sap:7",
        "cpe:/a:redhat:rhel_extras_sap_hana:7",
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::client",
        "cpe:/o:redhat:enterprise_linux:7::computenode",
        "cpe:/o:redhat:enterprise_linux:7::server",
        "cpe:/o:redhat:enterprise_linux:7::workstation"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          },
          {
            "Comment": "spamassassin is installed",
            "TestRef": "oval:com.redhat.cve:tst:201811805001"
          },
          {
            "Comment": "spamassassin is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:201811805002"
          }
        ]
      }
    ]
  }
}