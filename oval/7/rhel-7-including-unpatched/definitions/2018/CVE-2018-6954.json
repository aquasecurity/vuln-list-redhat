{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20186954",
  "Version": "636",
  "Metadata": {
    "Title": "Mishandled symlinks in systemd-tmpfiles allows local users to obtain ownership of arbitrary files (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2018-6954",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2018-6954"
      }
    ],
    "Description": "DOCUMENTATION: It has been discovered that systemd-tmpfiles mishandles symbolic links present in non-terminal path components. In some configurations a local user could use this vulnerability to get access to arbitrary files when the systemd-tmpfiles command is run. \n            STATEMENT: This flaw affects in particular those systems where custom tmpfiles files are configured (e.g. in /etc/tmpfiles.d). Indeed systemd-tmpfiles installed by system packages set privileges of a directory either to root or to a service specific user and not to interactive users. Even in case they provide one of the vulnerable tmpfiles configuration file (e.g. recursive \"Z\" type entries), an attacker would still need to perform the attack as the service specific user, which means they would first need to compromise that service.\n\nMoreover, systemd-tmpfiles service is automatically executed only when the system boots, when it is very unlikely an attacker has already a chance to perform any action at all. Otherwise, an attacker would have to wait for an administrator to manually run the `systemd-tmpfiles --create` command.\n            MITIGATION: There is no known mitigation available.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2023-10-06"
      },
      "Cves": [
        {
          "CveID": "CVE-2018-6954",
          "Cvss3": "7.0/CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-59",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2018-6954",
          "Public": "20180125"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:7",
        "cpe:/a:redhat:rhel_extras_oracle_java:7",
        "cpe:/a:redhat:rhel_extras_rt:7",
        "cpe:/a:redhat:rhel_extras_sap:7",
        "cpe:/a:redhat:rhel_extras_sap_hana:7",
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::client",
        "cpe:/o:redhat:enterprise_linux:7::computenode",
        "cpe:/o:redhat:enterprise_linux:7::server",
        "cpe:/o:redhat:enterprise_linux:7::workstation"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392019"
                  },
                  {
                    "Comment": "systemd is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392003"
                  },
                  {
                    "Comment": "systemd-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libgudev1 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392009"
                  },
                  {
                    "Comment": "libgudev1 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-networkd is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392017"
                  },
                  {
                    "Comment": "systemd-networkd is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-resolved is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392015"
                  },
                  {
                    "Comment": "systemd-resolved is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-python is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392007"
                  },
                  {
                    "Comment": "systemd-python is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libgudev1-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392011"
                  },
                  {
                    "Comment": "libgudev1-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-sysv is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392001"
                  },
                  {
                    "Comment": "systemd-sysv is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-journal-gateway is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392005"
                  },
                  {
                    "Comment": "systemd-journal-gateway is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20134392013"
                  },
                  {
                    "Comment": "systemd-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20134392014"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}