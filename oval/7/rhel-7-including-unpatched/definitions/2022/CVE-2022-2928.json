{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20222928",
  "Version": "636",
  "Metadata": {
    "Title": "option refcount overflow when leasequery is enabled leading to dhcpd abort (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2022-2928",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2022-2928"
      }
    ],
    "Description": "DOCUMENTATION: An integer overflow vulnerability was found in the DHCP server. When the \"option_code_hash_lookup()\" function is called from \"add_option()\", it increases the option's \"refcount\" field. However, there is not a corresponding call to \"option_dereference()\" to decrement the \"refcount\" field. The \"add_option()\" function is only used in server responses to lease query packets. Each lease query response calls this function for several options. Hence, a DHCP server configured with \"allow lease query,\" a remote machine with access to the server, can send lease queries for the same lease multiple times, leading to the \"add_option()\" function being called repeatedly. This issue could cause the reference counters to overflow and the server to abort or crash. \n            STATEMENT: Vulnerable servers are network accessible to an attacker and configured to allow and process lease queries.\n\nInternally, reference counters are integers and thus overflow at 2^31 references, so even at 1000 lease query responses per second, it would take more than three weeks to crash the server.\n            MITIGATION: Possible workaround - Disable lease query on the server for DHCPv4 or restart the server periodically.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2023-05-16"
      },
      "Cves": [
        {
          "CveID": "CVE-2022-2928",
          "Cvss3": "6.5/CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "Cwe": "CWE-190",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2022-2928",
          "Public": "20221005"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:7",
        "cpe:/a:redhat:rhel_extras_oracle_java:7",
        "cpe:/a:redhat:rhel_extras_rt:7",
        "cpe:/a:redhat:rhel_extras_sap:7",
        "cpe:/a:redhat:rhel_extras_sap_hana:7",
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::client",
        "cpe:/o:redhat:enterprise_linux:7::computenode",
        "cpe:/o:redhat:enterprise_linux:7::server",
        "cpe:/o:redhat:enterprise_linux:7::workstation"
      ],
      "Affected": {
        "Resolution": {
          "State": "Out of support scope"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158605007"
                  },
                  {
                    "Comment": "dhcp-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158605008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158605009"
                  },
                  {
                    "Comment": "dhcp-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158605010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158605003"
                  },
                  {
                    "Comment": "dhcp-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158605004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhclient is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158605005"
                  },
                  {
                    "Comment": "dhclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158605006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "dhcp is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20158605001"
                  },
                  {
                    "Comment": "dhcp is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20158605002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}