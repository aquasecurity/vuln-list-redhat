{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20246387",
  "Version": "636",
  "Metadata": {
    "Title": "openssh: Possible remote code execution due to a race condition in signal handling (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-6387",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-6387"
      }
    ],
    "Description": "DOCUMENTATION: A security regression (CVE-2006-5051) was discovered in OpenSSH's server (sshd). There is a race condition which can lead to sshd to handle some signals in an unsafe manner. An unauthenticated, remote attacker may be able to trigger it by failing to authenticate within a set time period. \n            STATEMENT: Red Hat rates the severity of this flaw as Important. Although there is a possibility of remote code execution, there is a high bar of complexity required. Exploitation relies on an unpredictable race condition, necessitating a huge number of attempts to overcome. If the attacker doesn't achieve such win, the most likely outcome is the sshd server will crash, only impacting availability. Defenders have significant opportunity to utilize network monitoring tools to detect and disrupt this category of exploit due to the large volume of connections required. All actively supported versions of Red Hat Enterprise Linux have ExecShield (aka ASLR) enabled by default and utilize NX technology, significantly reducing reliability of this attack.\n\nRed Hat Enterprise Linux 9 is the only version which is is affected. Red Hat Enterprise Linux 6, 7, and 8 all utilized an older version of OpenSSH which never incorporated the regression.\n\nIn OpenShift Container Platform (OCP) starting from 4.13 stream there is included affected version of OpenSSH in the RHCOS (CoreOS) system. Earlier versions of OCP are not affected.\n            MITIGATION: The below process can protect against a Remote Code Execution attack by disabling the LoginGraceTime parameter. However, the sshd server is still vulnerable to a Denial of Service as an attacker could still exhaust all the connections.\n\n1) As root user, open the /etc/ssh/sshd_config\n2) Add or edit the parameter configuration:\n~~~\nLoginGraceTime 0\n~~~\n3) Save and close the file\n4) Restart the sshd daemon:\n~~~\nsystemctl restart sshd.service\n~~~",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2024-07-05"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-6387",
          "Cvss3": "8.1/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "Cwe": "CWE-364",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-6387",
          "Public": "20240701:0800"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:openshift:4.11",
        "cpe:/a:redhat:openshift:4.11::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201714623004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201714623003"
          },
          {
            "Comment": "rhcos is installed",
            "TestRef": "oval:com.redhat.cve:tst:202426602001"
          },
          {
            "Comment": "rhcos is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:202426602002"
          }
        ]
      }
    ]
  }
}