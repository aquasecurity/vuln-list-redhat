{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202445614",
  "Version": "636",
  "Metadata": {
    "Title": "rubygem-puma: Header normalization allows for client to clobber proxy set headers (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-45614",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-45614"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in rubygem-puma. In affected versions, clients could clobber values set by intermediate proxies (such as X-Forwarded-For) by providing an underscore version of the same header (X-Forwarded_For). Any users relying on proxy set variables are affected. v6.4.3/v5.6.9 now discards any headers using underscores if the non-underscore version also exists. Effectively, allowing the proxy defined headers to always win. Users are advised to upgrade. As a mitigation, Nginx has an underscores_in_headers configuration variable to discard these headers at the proxy level. Any users that are implicitly trusting the proxy defined headers for security should immediately cease doing so until upgraded to the fixed versions. \n            STATEMENT: This issue is classified as moderate severity rather than important because, while it allows clients to manipulate proxy-set headers like `X-Forwarded-For`, its exploitability depends on specific conditions. The vulnerability only affects applications that rely on these headers for security purposes, such as IP-based access controls or logging, and is mitigated by proper server configurations (e.g., using `underscores_in_headers off` in Nginx). Furthermore, it does not directly compromise the server's integrity or enable arbitrary code execution.\n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-10-23"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-45614",
          "Cvss3": "5.4/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:N",
          "Cwe": "CWE-639",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-45614",
          "Public": "20240919:2315"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:satellite:6.10",
        "cpe:/a:redhat:satellite:6.10::el7",
        "cpe:/a:redhat:satellite_capsule:6.10",
        "cpe:/a:redhat:satellite_capsule:6.10::el7"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20134120010"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20134120009"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rubygem-puma is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202445614001"
                  },
                  {
                    "Comment": "rubygem-puma is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202445614002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "Module satellite:el8 is enabled",
                    "TestRef": "oval:com.redhat.cve:tst:202241323005"
                  }
                ],
                "Criterias": [
                  {
                    "Operator": "AND",
                    "Criterions": [
                      {
                        "Comment": "rubygem-puma is installed",
                        "TestRef": "oval:com.redhat.cve:tst:202445614001"
                      },
                      {
                        "Comment": "rubygem-puma is signed with Red Hat redhatrelease2 key",
                        "TestRef": "oval:com.redhat.cve:tst:202445614002"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}