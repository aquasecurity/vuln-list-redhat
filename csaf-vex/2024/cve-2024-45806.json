{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-45806.json"
      }
    ],
    "title": "envoy: Potential to manipulate `x-envoy` headers from external sources",
    "tracking": {
      "current_release_date": "2024-10-03T15:59:36+00:00",
      "generator": {
        "date": "2024-10-03T15:59:36+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.0.1"
        }
      },
      "id": "CVE-2024-45806",
      "initial_release_date": "2024-09-20T00:15:02.293000+00:00",
      "revision_history": [
        {
          "date": "2024-09-20T00:15:02.293000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-09-30T21:17:01+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-10-03T15:59:36+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 2",
                "product": {
                  "name": "OpenShift Service Mesh 2",
                  "product_id": "openshift_service_mesh_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 2"
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/istio-cni-rhel8",
            "product": {
              "name": "openshift-service-mesh/istio-cni-rhel8",
              "product_id": "openshift-service-mesh/istio-cni-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/istio-cni-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/pilot-rhel8",
            "product": {
              "name": "openshift-service-mesh/pilot-rhel8",
              "product_id": "openshift-service-mesh/pilot-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/pilot-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/proxyv2-rhel8",
            "product": {
              "name": "openshift-service-mesh/proxyv2-rhel8",
              "product_id": "openshift-service-mesh/proxyv2-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/proxyv2-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/proxyv2-rhel9",
            "product": {
              "name": "openshift-service-mesh/proxyv2-rhel9",
              "product_id": "openshift-service-mesh/proxyv2-rhel9",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/proxyv2-rhel9"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/istio-cni-rhel8 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8"
        },
        "product_reference": "openshift-service-mesh/istio-cni-rhel8",
        "relates_to_product_reference": "openshift_service_mesh_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/pilot-rhel8 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
        },
        "product_reference": "openshift-service-mesh/pilot-rhel8",
        "relates_to_product_reference": "openshift_service_mesh_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/proxyv2-rhel8 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8"
        },
        "product_reference": "openshift-service-mesh/proxyv2-rhel8",
        "relates_to_product_reference": "openshift_service_mesh_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/proxyv2-rhel9 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
        },
        "product_reference": "openshift-service-mesh/proxyv2-rhel9",
        "relates_to_product_reference": "openshift_service_mesh_2"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-45806",
      "cwe": {
        "id": "CWE-639",
        "name": "Authorization Bypass Through User-Controlled Key"
      },
      "discovery_date": "2024-09-20T00:40:20.976812+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2313683"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A vulnerability was found in Envoy that allows external clients to manipulate Envoy headers, potentially leading to unauthorized access or other malicious actions within the mesh. This issue arises due to Envoy's default configuration of internal trust boundaries, which considers all RFC1918 private address ranges as internal. The default behavior for handling internal addresses in Envoy has been changed. Previously, RFC1918 IP addresses were automatically considered internal, even if the internal_address_config was empty. The default configuration of Envoy will continue to trust internal addresses while in this release and it will not trust them by default in next release. If you have tooling such as probes on your private network which need to be treated as trusted such as changing arbitrary x-envoy headers, please explicitly include those addresses or CIDR ranges into `internal_address_config`. Successful exploitation could allow attackers to bypass security controls, access sensitive data, or disrupt services within the mesh, like Istio.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "envoy: Potential to manipulate `x-envoy` headers from external sources",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat's CVSS score and impact are specific to our product and may not match those of upstream. This is due to how envoy is configured and used within our OpenShift Service Mesh product.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8",
          "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
        ],
        "known_not_affected": [
          "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
          "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-45806"
        },
        {
          "category": "external",
          "summary": "RHBZ#2313683",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2313683"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-45806",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-45806"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-45806",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-45806"
        },
        {
          "category": "external",
          "summary": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-ffhv-fvxq-r6mf",
          "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-ffhv-fvxq-r6mf"
        }
      ],
      "release_date": "2024-09-20T00:15:02.293000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "This flaw can be mitigated by configuring envoy to treat all IPs as external. This is done by setting the internal_address_config range for envoy to `0.0.0.0/32`.",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.4,
            "baseSeverity": "HIGH"
          },
          "products": [
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
          ]
        }
      ],
      "title": "envoy: Potential to manipulate `x-envoy` headers from external sources"
    }
  ]
}