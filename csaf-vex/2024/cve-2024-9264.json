{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Critical"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-9264.json"
      }
    ],
    "title": "grafana: Command injection and local file inclusion via SQL Expressions",
    "tracking": {
      "current_release_date": "2024-11-01T18:38:29+00:00",
      "generator": {
        "date": "2024-11-01T18:38:29+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.1.1"
        }
      },
      "id": "CVE-2024-9264",
      "initial_release_date": "2024-10-24T05:04:52.530000+00:00",
      "revision_history": [
        {
          "date": "2024-10-24T05:04:52.530000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-11-01T18:20:06+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-01T18:38:29+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Storage 3",
                "product": {
                  "name": "Red Hat Storage 3",
                  "product_id": "red_hat_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Storage 3"
          },
          {
            "category": "product_version",
            "name": "grafana",
            "product": {
              "name": "grafana",
              "product_id": "grafana",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/grafana?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as a component of Red Hat Storage 3",
          "product_id": "red_hat_storage_3:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "red_hat_storage_3"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-9264",
      "cwe": {
        "id": "CWE-77",
        "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')"
      },
      "discovery_date": "2024-10-04T00:52:53.681000+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_8:grafana",
            "red_hat_enterprise_linux_9:grafana",
            "red_hat_storage_3:grafana"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2316409"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A vulnerability was found in Grafana. An experimental feature named SQL Expressions was recently added to Grafana to allow query output to be post-processed using SQL. These SQL queries were incompletely sanitized, leading to a command injection and local file inclusion vulnerability. Any user with the VIEWER or higher permission can execute this attack.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "grafana: Command injection and local file inclusion via SQL Expressions",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability is classified as critical instead of important because it allows for command injection and local file inclusion, potentially leading to arbitrary code execution or unauthorized access to sensitive files. The exploit can be carried out by any user with VIEWER or higher permissions, significantly increasing the attack surface. Moreover, due to an incorrect implementation of feature flags, the SQL Expressions feature is enabled by default for the API, making it more likely to be exposed in affected deployments. Although the vulnerability requires the presence of the DuckDB binary in the Grafana process's PATH, systems that meet this condition are at significant risk. \n\nIt’s important to note that this issue was introduced in a Grafana version not included in any Red Hat offerings, ensuring that Red Hat customers are not impacted.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_8:grafana",
          "red_hat_enterprise_linux_9:grafana",
          "red_hat_storage_3:grafana"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-9264"
        },
        {
          "category": "external",
          "summary": "RHBZ#2316409",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2316409"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-9264",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-9264"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-9264",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-9264"
        },
        {
          "category": "external",
          "summary": "https://grafana.com/blog/2024/10/17/grafana-security-release-critical-severity-fix-for-cve-2024-9264/",
          "url": "https://grafana.com/blog/2024/10/17/grafana-security-release-critical-severity-fix-for-cve-2024-9264/"
        }
      ],
      "release_date": "2024-10-24T05:04:52.530000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
          "product_ids": [
            "red_hat_enterprise_linux_8:grafana",
            "red_hat_enterprise_linux_9:grafana",
            "red_hat_storage_3:grafana"
          ]
        }
      ],
      "title": "grafana: Command injection and local file inclusion via SQL Expressions"
    }
  ]
}