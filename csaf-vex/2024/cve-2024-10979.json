{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-10979.json"
      }
    ],
    "title": "postgresql: PostgreSQL PL/Perl environment variable changes execute arbitrary code",
    "tracking": {
      "current_release_date": "2024-11-26T16:52:16+00:00",
      "generator": {
        "date": "2024-11-26T16:52:16+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2024-10979",
      "initial_release_date": "2024-11-14T13:00:08.586000+00:00",
      "revision_history": [
        {
          "date": "2024-11-14T13:00:08.586000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-11-26T16:31:53+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-26T16:52:16+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "category": "product_version",
            "name": "postgresql",
            "product": {
              "name": "postgresql",
              "product_id": "postgresql",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/postgresql?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "postgresql:12/postgresql",
            "product": {
              "name": "postgresql:12/postgresql",
              "product_id": "postgresql:12/postgresql",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/postgresql:12/postgresql"
              }
            }
          },
          {
            "category": "product_version",
            "name": "postgresql:13/postgresql",
            "product": {
              "name": "postgresql:13/postgresql",
              "product_id": "postgresql:13/postgresql",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/postgresql:13/postgresql"
              }
            }
          },
          {
            "category": "product_version",
            "name": "postgresql:15/postgresql",
            "product": {
              "name": "postgresql:15/postgresql",
              "product_id": "postgresql:15/postgresql",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/postgresql:15/postgresql"
              }
            }
          },
          {
            "category": "product_version",
            "name": "postgresql:16/postgresql",
            "product": {
              "name": "postgresql:16/postgresql",
              "product_id": "postgresql:16/postgresql",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/postgresql:16/postgresql"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:postgresql"
        },
        "product_reference": "postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:postgresql"
        },
        "product_reference": "postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql:12/postgresql as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:postgresql:12/postgresql"
        },
        "product_reference": "postgresql:12/postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql:13/postgresql as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:postgresql:13/postgresql"
        },
        "product_reference": "postgresql:13/postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql:15/postgresql as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:postgresql:15/postgresql"
        },
        "product_reference": "postgresql:15/postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql:16/postgresql as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:postgresql:16/postgresql"
        },
        "product_reference": "postgresql:16/postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:postgresql"
        },
        "product_reference": "postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql:15/postgresql as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:postgresql:15/postgresql"
        },
        "product_reference": "postgresql:15/postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "postgresql:16/postgresql as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:postgresql:16/postgresql"
        },
        "product_reference": "postgresql:16/postgresql",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-10979",
      "cwe": {
        "id": "CWE-15",
        "name": "External Control of System or Configuration Setting"
      },
      "discovery_date": "2024-11-14T14:01:12.059934+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2326253"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in PostgreSQL PL/Perl. This vulnerability allows an unprivileged database user to change sensitive process environment variables (e.g., PATH) via incorrect control of environment variables.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "postgresql: PostgreSQL PL/Perl environment variable changes execute arbitrary code",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability has been given a severity rating of important because the ability to modify sensitive process environment variables (ex. PATH) can lead to unauthorized code execution and privilege escalation. Depending on the privileges of the PostgreSQL user, an attacker may be able to gain higher-level access to the underlying server and create functions who modify environment variables and execute arbitrary commands.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_6:postgresql",
          "red_hat_enterprise_linux_7:postgresql",
          "red_hat_enterprise_linux_8:postgresql:12/postgresql",
          "red_hat_enterprise_linux_8:postgresql:13/postgresql",
          "red_hat_enterprise_linux_8:postgresql:15/postgresql",
          "red_hat_enterprise_linux_8:postgresql:16/postgresql",
          "red_hat_enterprise_linux_9:postgresql",
          "red_hat_enterprise_linux_9:postgresql:15/postgresql",
          "red_hat_enterprise_linux_9:postgresql:16/postgresql"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-10979"
        },
        {
          "category": "external",
          "summary": "RHBZ#2326253",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2326253"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-10979",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-10979"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-10979",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-10979"
        },
        {
          "category": "external",
          "summary": "https://www.postgresql.org/support/security/CVE-2024-10979/",
          "url": "https://www.postgresql.org/support/security/CVE-2024-10979/"
        }
      ],
      "release_date": "2024-11-14T13:00:08.586000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Currently the following options exist to help mitigate the impact of this vulnerability: \n1) Restrict Permissions: the creation of PL/Python and PL/Perl functions should be limited to trusted users only. \n2) Environment Variable Sanitization: ensure that environment variables are properly sanitized and any modifications are restricted.\n3) Upgrade PostgreSQL: if a fix is released by the PostgreSQL Global Development Group, update to the latest version.\n4) Audit Database Functions: perform regular audits on user-created functions to detect and prevent potential exploitation.",
          "product_ids": [
            "red_hat_enterprise_linux_6:postgresql",
            "red_hat_enterprise_linux_7:postgresql",
            "red_hat_enterprise_linux_8:postgresql:12/postgresql",
            "red_hat_enterprise_linux_8:postgresql:13/postgresql",
            "red_hat_enterprise_linux_8:postgresql:15/postgresql",
            "red_hat_enterprise_linux_8:postgresql:16/postgresql",
            "red_hat_enterprise_linux_9:postgresql",
            "red_hat_enterprise_linux_9:postgresql:15/postgresql",
            "red_hat_enterprise_linux_9:postgresql:16/postgresql"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "red_hat_enterprise_linux_6:postgresql"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_enterprise_linux_7:postgresql",
            "red_hat_enterprise_linux_8:postgresql:12/postgresql",
            "red_hat_enterprise_linux_8:postgresql:13/postgresql",
            "red_hat_enterprise_linux_8:postgresql:15/postgresql",
            "red_hat_enterprise_linux_8:postgresql:16/postgresql",
            "red_hat_enterprise_linux_9:postgresql",
            "red_hat_enterprise_linux_9:postgresql:15/postgresql",
            "red_hat_enterprise_linux_9:postgresql:16/postgresql"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.8,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_enterprise_linux_6:postgresql",
            "red_hat_enterprise_linux_7:postgresql",
            "red_hat_enterprise_linux_8:postgresql:12/postgresql",
            "red_hat_enterprise_linux_8:postgresql:13/postgresql",
            "red_hat_enterprise_linux_8:postgresql:15/postgresql",
            "red_hat_enterprise_linux_8:postgresql:16/postgresql",
            "red_hat_enterprise_linux_9:postgresql",
            "red_hat_enterprise_linux_9:postgresql:15/postgresql",
            "red_hat_enterprise_linux_9:postgresql:16/postgresql"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "red_hat_enterprise_linux_6:postgresql",
            "red_hat_enterprise_linux_7:postgresql",
            "red_hat_enterprise_linux_8:postgresql:12/postgresql",
            "red_hat_enterprise_linux_8:postgresql:13/postgresql",
            "red_hat_enterprise_linux_8:postgresql:15/postgresql",
            "red_hat_enterprise_linux_8:postgresql:16/postgresql",
            "red_hat_enterprise_linux_9:postgresql",
            "red_hat_enterprise_linux_9:postgresql:15/postgresql",
            "red_hat_enterprise_linux_9:postgresql:16/postgresql"
          ]
        }
      ],
      "title": "postgresql: PostgreSQL PL/Perl environment variable changes execute arbitrary code"
    }
  ]
}