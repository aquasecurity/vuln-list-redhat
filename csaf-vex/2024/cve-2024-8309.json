{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Low"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-8309.json"
      }
    ],
    "title": "langchain: SQL Injection in langchain-ai/langchain",
    "tracking": {
      "current_release_date": "2025-02-08T04:45:25+00:00",
      "generator": {
        "date": "2025-02-08T04:45:25+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2024-8309",
      "initial_release_date": "2024-10-29T12:50:13.198000+00:00",
      "revision_history": [
        {
          "date": "2024-10-29T12:50:13.198000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-11-01T19:20:06+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-08T04:45:25+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Lightspeed",
                "product": {
                  "name": "OpenShift Lightspeed",
                  "product_id": "openshift_lightspeed",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift_lightspeed"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Lightspeed"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ansible Automation Platform 2",
                "product": {
                  "name": "Red Hat Ansible Automation Platform 2",
                  "product_id": "red_hat_ansible_automation_platform_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ansible Automation Platform 2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux AI (RHEL AI)",
                "product": {
                  "name": "Red Hat Enterprise Linux AI (RHEL AI)",
                  "product_id": "red_hat_enterprise_linux_ai_(rhel_ai)",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux AI (RHEL AI)"
          },
          {
            "category": "product_version",
            "name": "openshift-lightspeed-beta/lightspeed-service-api-rhel9",
            "product": {
              "name": "openshift-lightspeed-beta/lightspeed-service-api-rhel9",
              "product_id": "openshift-lightspeed-beta/lightspeed-service-api-rhel9",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/openshift-lightspeed-beta/lightspeed-service-api-rhel9?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
            "product": {
              "name": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
              "product_id": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "aap-cloud-metrics-collector-container",
            "product": {
              "name": "aap-cloud-metrics-collector-container",
              "product_id": "aap-cloud-metrics-collector-container",
              "product_identification_helper": {
                "purl": "pkg:oci/aap-cloud-metrics-collector-container?repository_url=registry.redhat.io/aap-cloud-metrics-collector-container"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ansible-automation-platform-24/de-supported-rhel8",
            "product": {
              "name": "ansible-automation-platform-24/de-supported-rhel8",
              "product_id": "ansible-automation-platform-24/de-supported-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/de-supported-rhel8?repository_url=registry.redhat.io/ansible-automation-platform-24/de-supported-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
            "product": {
              "name": "ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
              "product_id": "ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/ee-dellemc-openmanage-rhel8?repository_url=registry.redhat.io/ansible-automation-platform-24/ee-dellemc-openmanage-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ansible-automation-platform-24/lightspeed-rhel8",
            "product": {
              "name": "ansible-automation-platform-24/lightspeed-rhel8",
              "product_id": "ansible-automation-platform-24/lightspeed-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/lightspeed-rhel8?repository_url=registry.redhat.io/ansible-automation-platform-24/lightspeed-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ansible-automation-platform-25/ansible-dev-tools-rhel8",
            "product": {
              "name": "ansible-automation-platform-25/ansible-dev-tools-rhel8",
              "product_id": "ansible-automation-platform-25/ansible-dev-tools-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/ansible-dev-tools-rhel8?repository_url=registry.redhat.io/ansible-automation-platform-25/ansible-dev-tools-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ansible-automation-platform-25/ee-minimal-rhel9",
            "product": {
              "name": "ansible-automation-platform-25/ee-minimal-rhel9",
              "product_id": "ansible-automation-platform-25/ee-minimal-rhel9",
              "product_identification_helper": {
                "purl": "pkg:oci/ee-minimal-rhel9?repository_url=registry.redhat.io/ansible-automation-platform-25/ee-minimal-rhel9"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ansible-automation-platform-25/platform-resource-runner-rhel8",
            "product": {
              "name": "ansible-automation-platform-25/platform-resource-runner-rhel8",
              "product_id": "ansible-automation-platform-25/platform-resource-runner-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/platform-resource-runner-rhel8?repository_url=registry.redhat.io/ansible-automation-platform-25/platform-resource-runner-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rhelai1/bootc-nvidia-rhel9",
            "product": {
              "name": "rhelai1/bootc-nvidia-rhel9",
              "product_id": "rhelai1/bootc-nvidia-rhel9",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rhelai1/bootc-nvidia-rhel9?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-lightspeed-beta/lightspeed-service-api-rhel9 as a component of OpenShift Lightspeed",
          "product_id": "openshift_lightspeed:openshift-lightspeed-beta/lightspeed-service-api-rhel9"
        },
        "product_reference": "openshift-lightspeed-beta/lightspeed-service-api-rhel9",
        "relates_to_product_reference": "openshift_lightspeed"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9 as a component of OpenShift Lightspeed",
          "product_id": "openshift_lightspeed:openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9"
        },
        "product_reference": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
        "relates_to_product_reference": "openshift_lightspeed"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "aap-cloud-metrics-collector-container as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:aap-cloud-metrics-collector-container"
        },
        "product_reference": "aap-cloud-metrics-collector-container",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ansible-automation-platform-24/de-supported-rhel8 as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/de-supported-rhel8"
        },
        "product_reference": "ansible-automation-platform-24/de-supported-rhel8",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ansible-automation-platform-24/ee-dellemc-openmanage-rhel8 as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/ee-dellemc-openmanage-rhel8"
        },
        "product_reference": "ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ansible-automation-platform-24/lightspeed-rhel8 as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/lightspeed-rhel8"
        },
        "product_reference": "ansible-automation-platform-24/lightspeed-rhel8",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ansible-automation-platform-25/ansible-dev-tools-rhel8 as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ansible-dev-tools-rhel8"
        },
        "product_reference": "ansible-automation-platform-25/ansible-dev-tools-rhel8",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ansible-automation-platform-25/ee-minimal-rhel9 as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ee-minimal-rhel9"
        },
        "product_reference": "ansible-automation-platform-25/ee-minimal-rhel9",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ansible-automation-platform-25/platform-resource-runner-rhel8 as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/platform-resource-runner-rhel8"
        },
        "product_reference": "ansible-automation-platform-25/platform-resource-runner-rhel8",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rhelai1/bootc-nvidia-rhel9 as a component of Red Hat Enterprise Linux AI (RHEL AI)",
          "product_id": "red_hat_enterprise_linux_ai_(rhel_ai):rhelai1/bootc-nvidia-rhel9"
        },
        "product_reference": "rhelai1/bootc-nvidia-rhel9",
        "relates_to_product_reference": "red_hat_enterprise_linux_ai_(rhel_ai)"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-8309",
      "cwe": {
        "id": "CWE-89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
      },
      "discovery_date": "2024-10-29T14:01:22.514781+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "openshift_lightspeed:openshift-lightspeed-beta/lightspeed-service-api-rhel9",
            "openshift_lightspeed:openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
            "red_hat_ansible_automation_platform_2:aap-cloud-metrics-collector-container",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/de-supported-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/lightspeed-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ansible-dev-tools-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ee-minimal-rhel9",
            "red_hat_enterprise_linux_ai_(rhel_ai):rhelai1/bootc-nvidia-rhel9"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2322452"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A vulnerability in the GraphCypherQAChain class of langchain-ai/langchain version 0.2.5 allows for SQL injection through prompt injection. This vulnerability can lead to unauthorized data manipulation, data exfiltration, denial of service (DoS) by deleting all data, breaches in multi-tenant security environments, and data integrity issues. Attackers can create, update, or delete nodes and relationships without proper authorization, extract sensitive data, disrupt services, access data across different tenants, and compromise the integrity of the database.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "langchain: SQL Injection in langchain-ai/langchain",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat rates the impact of this vulnerability as low, due to the GraphCypherQAChain class having explicit documentation requiring appropriate RBAC control and the fact that successful exploitation requires having an exposed endpoint that accepts inputs from a user.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
          "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/platform-resource-runner-rhel8"
        ],
        "known_not_affected": [
          "openshift_lightspeed:openshift-lightspeed-beta/lightspeed-service-api-rhel9",
          "openshift_lightspeed:openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
          "red_hat_ansible_automation_platform_2:aap-cloud-metrics-collector-container",
          "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/de-supported-rhel8",
          "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/lightspeed-rhel8",
          "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ansible-dev-tools-rhel8",
          "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ee-minimal-rhel9",
          "red_hat_enterprise_linux_ai_(rhel_ai):rhelai1/bootc-nvidia-rhel9"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-8309"
        },
        {
          "category": "external",
          "summary": "RHBZ#2322452",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2322452"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-8309",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-8309"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-8309",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-8309"
        },
        {
          "category": "external",
          "summary": "https://api.python.langchain.com/en/latest/chains/langchain.chains.graph_qa.cypher.GraphCypherQAChain.html",
          "url": "https://api.python.langchain.com/en/latest/chains/langchain.chains.graph_qa.cypher.GraphCypherQAChain.html"
        },
        {
          "category": "external",
          "summary": "https://github.com/langchain-ai/langchain/commit/c2a3021bb0c5f54649d380b42a0684ca5778c255",
          "url": "https://github.com/langchain-ai/langchain/commit/c2a3021bb0c5f54649d380b42a0684ca5778c255"
        },
        {
          "category": "external",
          "summary": "https://huntr.com/bounties/8f4ad910-7fdc-4089-8f0a-b5df5f32e7c5",
          "url": "https://huntr.com/bounties/8f4ad910-7fdc-4089-8f0a-b5df5f32e7c5"
        }
      ],
      "release_date": "2024-10-29T12:50:13.198000+00:00",
      "remediations": [
        {
          "category": "none_available",
          "details": "Fix deferred",
          "product_ids": [
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/platform-resource-runner-rhel8"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 4.9,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "openshift_lightspeed:openshift-lightspeed-beta/lightspeed-service-api-rhel9",
            "openshift_lightspeed:openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
            "red_hat_ansible_automation_platform_2:aap-cloud-metrics-collector-container",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/de-supported-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/lightspeed-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ansible-dev-tools-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ee-minimal-rhel9",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/platform-resource-runner-rhel8",
            "red_hat_enterprise_linux_ai_(rhel_ai):rhelai1/bootc-nvidia-rhel9"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "openshift_lightspeed:openshift-lightspeed-beta/lightspeed-service-api-rhel9",
            "openshift_lightspeed:openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
            "red_hat_ansible_automation_platform_2:aap-cloud-metrics-collector-container",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/de-supported-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-24/lightspeed-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ansible-dev-tools-rhel8",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/ee-minimal-rhel9",
            "red_hat_ansible_automation_platform_2:ansible-automation-platform-25/platform-resource-runner-rhel8",
            "red_hat_enterprise_linux_ai_(rhel_ai):rhelai1/bootc-nvidia-rhel9"
          ]
        }
      ],
      "title": "langchain: SQL Injection in langchain-ai/langchain"
    }
  ]
}