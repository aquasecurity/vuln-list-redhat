{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-3661.json"
      }
    ],
    "title": "DHCP: DHCP routing options can manipulate interface-based VPN traffic",
    "tracking": {
      "current_release_date": "2025-01-10T17:55:09+00:00",
      "generator": {
        "date": "2025-01-10T17:55:09+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.6"
        }
      },
      "id": "CVE-2024-3661",
      "initial_release_date": "2024-05-06T18:31:21.217000+00:00",
      "revision_history": [
        {
          "date": "2024-05-06T18:31:21.217000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-01-10T14:46:03+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-10T17:55:09+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "category": "product_version",
            "name": "dhcp",
            "product": {
              "name": "dhcp",
              "product_id": "dhcp",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/dhcp?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "NetworkManager",
            "product": {
              "name": "NetworkManager",
              "product_id": "NetworkManager",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/NetworkManager?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "NetworkManager as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:NetworkManager"
        },
        "product_reference": "NetworkManager",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "dhcp as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:dhcp"
        },
        "product_reference": "dhcp",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "NetworkManager as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:NetworkManager"
        },
        "product_reference": "NetworkManager",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "dhcp as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:dhcp"
        },
        "product_reference": "dhcp",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "NetworkManager as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:NetworkManager"
        },
        "product_reference": "NetworkManager",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "dhcp as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:dhcp"
        },
        "product_reference": "dhcp",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "NetworkManager as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:NetworkManager"
        },
        "product_reference": "NetworkManager",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "dhcp as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:dhcp"
        },
        "product_reference": "dhcp",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-3661",
      "cwe": {
        "id": "CWE-501",
        "name": "Trust Boundary Violation"
      },
      "discovery_date": "2024-10-21T09:53:49.333674+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_6:dhcp",
            "red_hat_enterprise_linux_7:dhcp",
            "red_hat_enterprise_linux_8:dhcp",
            "red_hat_enterprise_linux_9:dhcp"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2320141"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "DHCP can add routes to a client’s routing table via the classless static route option (121). VPN-based security solutions that rely on routes to redirect traffic can be forced to leak traffic over the physical interface. An attacker on the same local network can read, disrupt, or possibly modify network traffic expected to be protected by the VPN.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "DHCP: DHCP routing options can manipulate interface-based VPN traffic",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability is also known as TunnelVision and it describes a technique to use DHCP configuration to manipulate hosts to send traffic to an attacker's host instead of through a VPN, as expected. According to MITRE it is reported as a vulnerability against DHCP. However, the DHCP protocol works as intended and as a protocol without cryptographic protection, attackers do not break a security boundary in the DHCP protocol by using the DHCP option 121. To prevent against the attack vector, users or VPN configuration software need to configure the VPN correctly or use other techniques to avoid that a DHCP configuration manipulates routing decisions for packets intended to be contained in the VPN.\n\nThis affects only situations where hosts use DHCP in a network and attackers can control a DHCP server. It affects full-tunnel and split-tunnel based VPNs. IPSec policy-based VPNs do not send unencrypted traffic to attackers as they encrypt traffic regardless of the routing decision.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_6:NetworkManager",
          "red_hat_enterprise_linux_7:NetworkManager",
          "red_hat_enterprise_linux_8:NetworkManager",
          "red_hat_enterprise_linux_9:NetworkManager"
        ],
        "known_not_affected": [
          "red_hat_enterprise_linux_6:dhcp",
          "red_hat_enterprise_linux_7:dhcp",
          "red_hat_enterprise_linux_8:dhcp",
          "red_hat_enterprise_linux_9:dhcp"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-3661"
        },
        {
          "category": "external",
          "summary": "RHBZ#2320141",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2320141"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-3661",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-3661"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-3661",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-3661"
        },
        {
          "category": "external",
          "summary": "https://arstechnica.com/security/2024/05/novel-attack-against-virtually-all-vpn-apps-neuters-their-entire-purpose/",
          "url": "https://arstechnica.com/security/2024/05/novel-attack-against-virtually-all-vpn-apps-neuters-their-entire-purpose/"
        },
        {
          "category": "external",
          "summary": "https://bst.cisco.com/quickview/bug/CSCwk05814",
          "url": "https://bst.cisco.com/quickview/bug/CSCwk05814"
        },
        {
          "category": "external",
          "summary": "https://datatracker.ietf.org/doc/html/rfc2131#section-7",
          "url": "https://datatracker.ietf.org/doc/html/rfc2131#section-7"
        },
        {
          "category": "external",
          "summary": "https://datatracker.ietf.org/doc/html/rfc3442#section-7",
          "url": "https://datatracker.ietf.org/doc/html/rfc3442#section-7"
        },
        {
          "category": "external",
          "summary": "https://fortiguard.fortinet.com/psirt/FG-IR-24-170",
          "url": "https://fortiguard.fortinet.com/psirt/FG-IR-24-170"
        },
        {
          "category": "external",
          "summary": "https://issuetracker.google.com/issues/263721377",
          "url": "https://issuetracker.google.com/issues/263721377"
        },
        {
          "category": "external",
          "summary": "https://krebsonsecurity.com/2024/05/why-your-vpn-may-not-be-as-secure-as-it-claims/",
          "url": "https://krebsonsecurity.com/2024/05/why-your-vpn-may-not-be-as-secure-as-it-claims/"
        },
        {
          "category": "external",
          "summary": "https://lowendtalk.com/discussion/188857/a-rogue-dhcp-server-within-your-network-can-and-will-hijack-your-vpn-traffic",
          "url": "https://lowendtalk.com/discussion/188857/a-rogue-dhcp-server-within-your-network-can-and-will-hijack-your-vpn-traffic"
        },
        {
          "category": "external",
          "summary": "https://mullvad.net/en/blog/evaluating-the-impact-of-tunnelvision",
          "url": "https://mullvad.net/en/blog/evaluating-the-impact-of-tunnelvision"
        },
        {
          "category": "external",
          "summary": "https://my.f5.com/manage/s/article/K000139553",
          "url": "https://my.f5.com/manage/s/article/K000139553"
        },
        {
          "category": "external",
          "summary": "https://news.ycombinator.com/item?id=40279632",
          "url": "https://news.ycombinator.com/item?id=40279632"
        },
        {
          "category": "external",
          "summary": "https://news.ycombinator.com/item?id=40284111",
          "url": "https://news.ycombinator.com/item?id=40284111"
        },
        {
          "category": "external",
          "summary": "https://security.paloaltonetworks.com/CVE-2024-3661",
          "url": "https://security.paloaltonetworks.com/CVE-2024-3661"
        },
        {
          "category": "external",
          "summary": "https://support.citrix.com/article/CTX677069/cloud-software-group-security-advisory-for-cve20243661",
          "url": "https://support.citrix.com/article/CTX677069/cloud-software-group-security-advisory-for-cve20243661"
        },
        {
          "category": "external",
          "summary": "https://tunnelvisionbug.com/",
          "url": "https://tunnelvisionbug.com/"
        },
        {
          "category": "external",
          "summary": "https://www.agwa.name/blog/post/hardening_openvpn_for_def_con",
          "url": "https://www.agwa.name/blog/post/hardening_openvpn_for_def_con"
        },
        {
          "category": "external",
          "summary": "https://www.leviathansecurity.com/research/tunnelvision",
          "url": "https://www.leviathansecurity.com/research/tunnelvision"
        },
        {
          "category": "external",
          "summary": "https://www.theregister.com/2024/05/07/vpn_tunnelvision_dhcp/",
          "url": "https://www.theregister.com/2024/05/07/vpn_tunnelvision_dhcp/"
        },
        {
          "category": "external",
          "summary": "https://www.watchguard.com/wgrd-psirt/advisory/wgsa-2024-00009",
          "url": "https://www.watchguard.com/wgrd-psirt/advisory/wgsa-2024-00009"
        },
        {
          "category": "external",
          "summary": "https://www.zscaler.com/blogs/security-research/cve-2024-3661-k-tunnelvision-exposes-vpn-bypass-vulnerability",
          "url": "https://www.zscaler.com/blogs/security-research/cve-2024-3661-k-tunnelvision-exposes-vpn-bypass-vulnerability"
        }
      ],
      "release_date": "2024-05-06T18:31:21.217000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "The mitigation steps also ensure that the applications using the VPN cannot access local resources outside the VPN in full-tunnel mode. If access to local resources outside the VPN is needed, additional routing configuration is necessary.\n\nThe following steps demonstrate how to configure VPN profiles with NetworkManager to prioritize VPN routes over DHCP routes. This uses routing rules with a higher priority than the rule to lookup the main routing table. This means that the VPN routing table is consulted prior to the main routing table. Please note that a higher priority is configured by setting a lower priority value in the routing configuration.\n\n1. There were two bugs in NetworkManager that prevented these steps from working with profiles using VPN plugins, such as libreswan. Therefore first update NetworkManager:\n- On RHEL 8.10, use NetworkManager-1.40.16-18.el8_10 or later.\n- On RHEL 9.5 and later, use NetworkManager-1.48.10-5.el9_5 or later.\n\n2. In the next steps, you will assign the VPN routes to a dedicated routing table. By default, RHEL does not use the routing tables 1-252, and you can use one of them. If you configured the system to use some of these tables, identify a free routing table number. The following example uses the routing table 75.\n\n3. Optional: Configure a name for the routing table by adding a line, such as the following, to the /etc/iproute2/rt_tables file:\n75 vpn\n\nThis makes the output of ip commands easier to understand. Note that NetworkManager only supports using a table ID and not the table name.\n\n4. Configure the VPN connection profile to place the VPN routes in a dedicated routing table:\n# nmcli connection modify \u003cVPN_connection_profile\u003e ipv4.route-table \u003crouting_table_number\u003e\n\nFor example:\n# nmcli connection modify \"Company VPN\" ipv4.route-table 75\n\n5. Set a low priority value for the table you used in the previous command:\n# nmcli connection modify \u003cVPN_connection_profile\u003e ipv4.routing-rules \"priority \u003clow_priority_value\u003e from all table \u003crouting_table_number\u003e\"\n\nThe priority value can be any value between 1 and 32766 but, the lower the value, the higher the priority!\n\nFor example:\n# nmcli connection modify \"Company VPN\" ipv4.routing-rules \"priority 32345 from all table 75\"\n\n6. Reconnect the VPN:\n# nmcli connection down \u003cVPN_connection_profile\u003e\n# nmcli connection up \u003cVPN_connection_profile\u003e\n\nThis only prevents the TunnelVision techniques and possibly related issues regarding IPv4. For IPv6 it might be necessary to repeat the steps for IPv6.\nIf other software than NetworkManager is used to configure a VPN, it might need similar configuration changes to mitigate against TunnelVision.",
          "product_ids": [
            "red_hat_enterprise_linux_6:NetworkManager",
            "red_hat_enterprise_linux_6:dhcp",
            "red_hat_enterprise_linux_7:NetworkManager",
            "red_hat_enterprise_linux_7:dhcp",
            "red_hat_enterprise_linux_8:NetworkManager",
            "red_hat_enterprise_linux_8:dhcp",
            "red_hat_enterprise_linux_9:NetworkManager",
            "red_hat_enterprise_linux_9:dhcp"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_enterprise_linux_6:NetworkManager",
            "red_hat_enterprise_linux_7:NetworkManager"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_enterprise_linux_8:NetworkManager",
            "red_hat_enterprise_linux_9:NetworkManager"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
            "attackVector": "ADJACENT_NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 7.6,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_enterprise_linux_6:NetworkManager",
            "red_hat_enterprise_linux_6:dhcp",
            "red_hat_enterprise_linux_7:NetworkManager",
            "red_hat_enterprise_linux_7:dhcp",
            "red_hat_enterprise_linux_8:NetworkManager",
            "red_hat_enterprise_linux_8:dhcp",
            "red_hat_enterprise_linux_9:NetworkManager",
            "red_hat_enterprise_linux_9:dhcp"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_enterprise_linux_6:NetworkManager",
            "red_hat_enterprise_linux_6:dhcp",
            "red_hat_enterprise_linux_7:NetworkManager",
            "red_hat_enterprise_linux_7:dhcp",
            "red_hat_enterprise_linux_8:NetworkManager",
            "red_hat_enterprise_linux_8:dhcp",
            "red_hat_enterprise_linux_9:NetworkManager",
            "red_hat_enterprise_linux_9:dhcp"
          ]
        }
      ],
      "title": "DHCP: DHCP routing options can manipulate interface-based VPN traffic"
    }
  ]
}