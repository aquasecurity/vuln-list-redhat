{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Critical"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-12084.json"
      }
    ],
    "title": "rsync: Heap Buffer Overflow in Rsync due to Improper Checksum Length Handling",
    "tracking": {
      "current_release_date": "2025-01-16T18:31:43+00:00",
      "generator": {
        "date": "2025-01-16T18:31:43+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.6"
        }
      },
      "id": "CVE-2024-12084",
      "initial_release_date": "2024-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-01-16T18:19:54+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-16T18:31:43+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "rsync",
            "product": {
              "name": "rsync",
              "product_id": "rsync",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rsync?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rhcos",
            "product": {
              "name": "rhcos",
              "product_id": "rhcos",
              "product_identification_helper": {
                "purl": "pkg:oci/rhcos?repository_url=registry.redhat.io/rhcos"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rsync as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:rsync"
        },
        "product_reference": "rsync",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rsync as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:rsync"
        },
        "product_reference": "rsync",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rsync as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:rsync"
        },
        "product_reference": "rsync",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rsync as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:rsync"
        },
        "product_reference": "rsync",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rhcos as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:rhcos"
        },
        "product_reference": "rhcos",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-12084",
      "cwe": {
        "id": "CWE-122",
        "name": "Heap-based Buffer Overflow"
      },
      "discovery_date": "2024-12-05T09:32:44.653000+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_6:rsync",
            "red_hat_enterprise_linux_7:rsync",
            "red_hat_enterprise_linux_8:rsync",
            "red_hat_enterprise_linux_9:rsync",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2330527"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A heap-based buffer overflow flaw was found in the rsync daemon. This issue is due to improper handling of attacker-controlled checksum lengths (s2length) in the code. When MAX_DIGEST_LEN exceeds the fixed SUM_LENGTH (16 bytes), an attacker can write out of bounds in the sum2 buffer.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "rsync: Heap Buffer Overflow in Rsync due to Improper Checksum Length Handling",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability only affects a limited range of Rsync versions, rsync-3.2.7 and rsync-3.3.0.   Red Hat Enterprise Linux does not ship these versions of Rsync and is not affected.\n\nRed Hat considers the severity of this vulnerability to be Critical only in cases where anonymous read access is allowed. Depending on the configuration and implementation choices, the severity may be significantly reduced for your organization.\n\nIn all supported versions of Red Hat Enterprise Linux, Rsync is not configured to run as a service by default.\n\nThere are two different methods for utilizing Rsync from a remote system: contacting an Rsync daemon directly with TCP or using a remote-shell program as the transport (such as ssh or rsh). The risk of this vulnerability changes depending on which connection method is used.\n\nThe default configuration of an Rsync daemon (rsyncd) running as a service does not require authentication. While rsyncd can be configured to require users to provide valid credentials, anonymous read access is a common configuration used by file sharing and mirroring hosts. The capabilities of the rsyncd process may vary depending on the user configured to run the Rsync daemon. In this scenario, an attacker only requires anonymous read access to a Rsync server in order to trigger this vulnerability. \n\nRemote-shell programs provide a layer of defense because they enforce users to have valid credentials while initiating the shell connection. When Rsync is invoked via this method, it spawns as a child of the session and will not remain running indefinitely. Since the process is spawned within the security context of the user, an attacker who is able to exploit this vulnerability remains restricted to the capabilities of the user account used to initiate the session. Authentication and network restrictions significantly reduce the attack surface and restricting permissions for remote shell users is always encouraged to limit the impact of compromised credentials.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_6:rsync",
          "red_hat_enterprise_linux_7:rsync",
          "red_hat_enterprise_linux_8:rsync",
          "red_hat_enterprise_linux_9:rsync",
          "red_hat_openshift_container_platform_4:rhcos"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-12084"
        },
        {
          "category": "external",
          "summary": "RHBZ#2330527",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2330527"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-12084",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-12084"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-12084",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-12084"
        },
        {
          "category": "external",
          "summary": "https://kb.cert.org/vuls/id/952657",
          "url": "https://kb.cert.org/vuls/id/952657"
        }
      ],
      "release_date": "2025-01-14T15:06:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Red Hat recommends filtering untrusted connections to Rsync via firewall rules on the host and on network firewall appliances.\n\nAdditionally, systems which only need to provide remote Rsync access to users with known identities can enable authentication using the ```auth users``` parameter in their rsyncd configuration file (rsyncd.conf). \n\nSystems that provide anonymous read access to hosted files via Rsync, such as mirror hosts, do not have reasonable mitigation options available. We strongly urge operators using vulnerable versions of Rsync to update as soon as possible.",
          "product_ids": [
            "red_hat_enterprise_linux_6:rsync",
            "red_hat_enterprise_linux_7:rsync",
            "red_hat_enterprise_linux_8:rsync",
            "red_hat_enterprise_linux_9:rsync",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "products": [
            "red_hat_enterprise_linux_6:rsync",
            "red_hat_enterprise_linux_7:rsync",
            "red_hat_enterprise_linux_8:rsync",
            "red_hat_enterprise_linux_9:rsync",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Critical",
          "product_ids": [
            "red_hat_enterprise_linux_6:rsync",
            "red_hat_enterprise_linux_7:rsync",
            "red_hat_enterprise_linux_8:rsync",
            "red_hat_enterprise_linux_9:rsync",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        }
      ],
      "title": "rsync: Heap Buffer Overflow in Rsync due to Improper Checksum Length Handling"
    }
  ]
}