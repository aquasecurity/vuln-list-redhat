{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-11218.json"
      }
    ],
    "title": "podman: buildah: Container breakout by using --jobs=2 and a race condition when building a malicious Containerfile",
    "tracking": {
      "current_release_date": "2025-01-22T07:28:08+00:00",
      "generator": {
        "date": "2025-01-22T07:28:08+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.6"
        }
      },
      "id": "CVE-2024-11218",
      "initial_release_date": "2024-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-01-22T07:09:47+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-22T07:28:08+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "container-tools:rhel8/buildah",
            "product": {
              "name": "container-tools:rhel8/buildah",
              "product_id": "container-tools:rhel8/buildah",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/container-tools:rhel8/buildah"
              }
            }
          },
          {
            "category": "product_version",
            "name": "container-tools:rhel8/podman",
            "product": {
              "name": "container-tools:rhel8/podman",
              "product_id": "container-tools:rhel8/podman",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/container-tools:rhel8/podman"
              }
            }
          },
          {
            "category": "product_version",
            "name": "buildah",
            "product": {
              "name": "buildah",
              "product_id": "buildah",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/buildah?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "podman",
            "product": {
              "name": "podman",
              "product_id": "podman",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/podman?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rhcos",
            "product": {
              "name": "rhcos",
              "product_id": "rhcos",
              "product_identification_helper": {
                "purl": "pkg:oci/rhcos?repository_url=registry.redhat.io/rhcos"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "container-tools:rhel8/buildah as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:container-tools:rhel8/buildah"
        },
        "product_reference": "container-tools:rhel8/buildah",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "container-tools:rhel8/podman as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:container-tools:rhel8/podman"
        },
        "product_reference": "container-tools:rhel8/podman",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "buildah as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:buildah"
        },
        "product_reference": "buildah",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "podman as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:podman"
        },
        "product_reference": "podman",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "buildah as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:buildah"
        },
        "product_reference": "buildah",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "podman as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:podman"
        },
        "product_reference": "podman",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rhcos as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:rhcos"
        },
        "product_reference": "rhcos",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-11218",
      "cwe": {
        "id": "CWE-269",
        "name": "Improper Privilege Management"
      },
      "discovery_date": "2024-11-14T13:05:29.849000+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2326231"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A vulnerability was found in `podman build` and `buildah.` This issue occurs in a container breakout by using --jobs=2 and a race condition when building a malicious Containerfile. SELinux might mitigate it, but even with SELinux on, it still allows the enumeration of files and directories on the host.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "podman: buildah: Container breakout by using --jobs=2 and a race condition when building a malicious Containerfile",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability marked as important severity rather than moderate because it allows a malicious Containerfile to exploit the `--mount` flag in `RUN` instructions to directly interact with the build host's filesystem. By leveraging this, an attacker can gain unauthorized access to sensitive files or inject malicious content using the privileges of the build process. In environments where the build process is executed by a root-owned Podman system service exposed to unprivileged users, this vulnerability escalates to a high level, as it enables unauthorized read/write access to high-privilege files, such as setuid executables.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
          "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
          "red_hat_enterprise_linux_9:buildah",
          "red_hat_enterprise_linux_9:podman",
          "red_hat_openshift_container_platform_4:buildah",
          "red_hat_openshift_container_platform_4:podman",
          "red_hat_openshift_container_platform_4:rhcos"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-11218"
        },
        {
          "category": "external",
          "summary": "RHBZ#2326231",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2326231"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-11218",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-11218"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-11218",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-11218"
        }
      ],
      "release_date": "2025-01-20T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Mandatory access controls should limit the access of the process performing the build, on systems where they are enabled.\n\nSELinux enforces strict access controls by confining the build process (e.g., Podman) to specific domains like container_t. This prevents unauthorized access to sensitive host files and directories, even if a malicious Containerfile tries to exploit the --mount flag.",
          "product_ids": [
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:buildah",
            "red_hat_openshift_container_platform_4:podman",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:buildah",
            "red_hat_openshift_container_platform_4:podman",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.6,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:buildah",
            "red_hat_openshift_container_platform_4:podman",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:buildah",
            "red_hat_openshift_container_platform_4:podman",
            "red_hat_openshift_container_platform_4:rhcos"
          ]
        }
      ],
      "title": "podman: buildah: Container breakout by using --jobs=2 and a race condition when building a malicious Containerfile"
    }
  ]
}