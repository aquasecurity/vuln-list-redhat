{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-31207.json"
      }
    ],
    "title": "vitejs: \"server.fs.deny\" configuration does not deny requests that include patterns",
    "tracking": {
      "current_release_date": "2024-11-12T10:17:35+00:00",
      "generator": {
        "date": "2024-11-12T10:17:35+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.1.1"
        }
      },
      "id": "CVE-2024-31207",
      "initial_release_date": "2024-04-04T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-04-04T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-07-01T03:40:58+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-12T10:17:35+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ansible Automation Platform 2",
                "product": {
                  "name": "Red Hat Ansible Automation Platform 2",
                  "product_id": "red_hat_ansible_automation_platform_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ansible Automation Platform 2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Build of Keycloak",
                "product": {
                  "name": "Red Hat Build of Keycloak",
                  "product_id": "red_hat_build_of_keycloak",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:build_keycloak:"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Build of Keycloak"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Enterprise Application Platform 8",
                "product": {
                  "name": "Red Hat JBoss Enterprise Application Platform 8",
                  "product_id": "red_hat_jboss_enterprise_application_platform_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Enterprise Application Platform 8"
          },
          {
            "category": "product_version",
            "name": "automation-controller",
            "product": {
              "name": "automation-controller",
              "product_id": "automation-controller",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/automation-controller?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "org.keycloak-keycloak-parent",
            "product": {
              "name": "org.keycloak-keycloak-parent",
              "product_id": "org.keycloak-keycloak-parent"
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-controller as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:automation-controller"
        },
        "product_reference": "automation-controller",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "org.keycloak-keycloak-parent as a component of Red Hat Build of Keycloak",
          "product_id": "red_hat_build_of_keycloak:org.keycloak-keycloak-parent"
        },
        "product_reference": "org.keycloak-keycloak-parent",
        "relates_to_product_reference": "red_hat_build_of_keycloak"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "org.keycloak-keycloak-parent as a component of Red Hat JBoss Enterprise Application Platform 8",
          "product_id": "red_hat_jboss_enterprise_application_platform_8:org.keycloak-keycloak-parent"
        },
        "product_reference": "org.keycloak-keycloak-parent",
        "relates_to_product_reference": "red_hat_jboss_enterprise_application_platform_8"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-31207",
      "cwe": {
        "id": "CWE-284",
        "name": "Improper Access Control"
      },
      "discovery_date": "2024-04-04T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_ansible_automation_platform_2:automation-controller",
            "red_hat_build_of_keycloak:org.keycloak-keycloak-parent",
            "red_hat_jboss_enterprise_application_platform_8:org.keycloak-keycloak-parent"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2273531"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in the Node.js Vite package. When configuring the \"server.fs.deny\" server option to deny requests that include a pattern with directories such as /foo/**/*, the requests were still being allowed. This can potentially expose files or directories containing sensitive information. Only apps setting a custom \"server.fs.deny\" that includes a pattern with directories, and explicitly exposing the Vite dev server to the network using --host or server.host config option are affected.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "vitejs: \"server.fs.deny\" configuration does not deny requests that include patterns",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This issue is considered of moderate severity due to its potential to expose sensitive files or directories under specific conditions. The vulnerability arises when a custom server.fs.deny pattern including directories, such as /foo/**/*, fails to block access as intended. This flaw can only be exploited if the Vite dev server is explicitly exposed to the network via the --host or server.host options. Therefore, the issue requires both a specific server configuration and intentional network exposure, which mitigates the likelihood of widespread exploitation but still poses a significant risk in environments where these conditions are met, potentially leading to unauthorized access to sensitive data.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_ansible_automation_platform_2:automation-controller",
          "red_hat_build_of_keycloak:org.keycloak-keycloak-parent",
          "red_hat_jboss_enterprise_application_platform_8:org.keycloak-keycloak-parent"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-31207"
        },
        {
          "category": "external",
          "summary": "RHBZ#2273531",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2273531"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-31207",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-31207"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-31207",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-31207"
        }
      ],
      "release_date": "2024-04-04T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
          "product_ids": [
            "red_hat_ansible_automation_platform_2:automation-controller",
            "red_hat_build_of_keycloak:org.keycloak-keycloak-parent",
            "red_hat_jboss_enterprise_application_platform_8:org.keycloak-keycloak-parent"
          ]
        }
      ],
      "title": "vitejs: \"server.fs.deny\" configuration does not deny requests that include patterns"
    }
  ]
}