{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-45506.json"
      }
    ],
    "title": "haproxy: potential infinite loop condition in the h2_send() may trigger a DoS",
    "tracking": {
      "current_release_date": "2024-09-14T00:09:25+00:00",
      "generator": {
        "date": "2024-09-14T00:09:25+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "3.33.3"
        }
      },
      "id": "CVE-2024-45506",
      "initial_release_date": "2024-09-04T15:15:14.080000+00:00",
      "revision_history": [
        {
          "date": "2024-09-04T15:15:14.080000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-09-06T18:04:05+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-09-14T00:09:25+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 5",
                "product": {
                  "name": "Red Hat Ceph Storage 5",
                  "product_id": "red_hat_ceph_storage_5",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:5"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 5"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 3.11",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 3.11",
                  "product_id": "red_hat_openshift_container_platform_3.11",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:3.11"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 3.11"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "haproxy",
            "product": {
              "name": "haproxy",
              "product_id": "haproxy",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/haproxy?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "haproxy as a component of Red Hat Ceph Storage 5",
          "product_id": "red_hat_ceph_storage_5:haproxy"
        },
        "product_reference": "haproxy",
        "relates_to_product_reference": "red_hat_ceph_storage_5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "haproxy as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:haproxy"
        },
        "product_reference": "haproxy",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "haproxy as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:haproxy"
        },
        "product_reference": "haproxy",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "haproxy as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:haproxy"
        },
        "product_reference": "haproxy",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "haproxy as a component of Red Hat OpenShift Container Platform 3.11",
          "product_id": "red_hat_openshift_container_platform_3.11:haproxy"
        },
        "product_reference": "haproxy",
        "relates_to_product_reference": "red_hat_openshift_container_platform_3.11"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "haproxy as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:haproxy"
        },
        "product_reference": "haproxy",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-45506",
      "cwe": {
        "id": "CWE-835",
        "name": "Loop with Unreachable Exit Condition ('Infinite Loop')"
      },
      "discovery_date": "2024-09-04T15:20:26.842212+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_ceph_storage_5:haproxy",
            "red_hat_enterprise_linux_7:haproxy",
            "red_hat_enterprise_linux_8:haproxy",
            "red_hat_enterprise_linux_9:haproxy",
            "red_hat_openshift_container_platform_3.11:haproxy",
            "red_hat_openshift_container_platform_4:haproxy"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2309732"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in HAProxy. An issue in the HTTP/2 multiplexer combined with the zero-copy forwarding system allows remote attackers to trigger under very rare conditions an endless loop and cause a denial of service.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "haproxy: potential infinite loop condition in the h2_send() may trigger a DoS",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "The severity of this vulnerability has been raised to Important due to preliminary evidence from the upstream HAProxy project that it has been exploited in one case. Without this detail, the technical risk from this type of denial of service would have been rated Moderate.\n\nThis issue can only be triggered when zero-copy forwarding of data is enabled. See the mitigation section to see how this mechanism can be disabled.\n\nThe HAProxy package as shipped in Red Hat Enterprise Linux 7, 8, 9, in Red Hat Ceph Storage 5 and in Red Hat OpenShift Container Platform 3.11 and 4 is not affected by this vulnerability because these products do not ship a vulnerable version of HAProxy.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_ceph_storage_5:haproxy",
          "red_hat_enterprise_linux_7:haproxy",
          "red_hat_enterprise_linux_8:haproxy",
          "red_hat_enterprise_linux_9:haproxy",
          "red_hat_openshift_container_platform_3.11:haproxy",
          "red_hat_openshift_container_platform_4:haproxy"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-45506"
        },
        {
          "category": "external",
          "summary": "RHBZ#2309732",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2309732"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-45506",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-45506"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-45506",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-45506"
        },
        {
          "category": "external",
          "summary": "https://git.haproxy.org/?p=haproxy-3.0.git;a=commitdiff;h=c725db17e8416ffb3c1537aea756356228ce5e3c",
          "url": "https://git.haproxy.org/?p=haproxy-3.0.git;a=commitdiff;h=c725db17e8416ffb3c1537aea756356228ce5e3c"
        },
        {
          "category": "external",
          "summary": "https://git.haproxy.org/?p=haproxy-3.0.git;a=commitdiff;h=d636e515453320c6e122c313c661a8ac7d387c7f",
          "url": "https://git.haproxy.org/?p=haproxy-3.0.git;a=commitdiff;h=d636e515453320c6e122c313c661a8ac7d387c7f"
        },
        {
          "category": "external",
          "summary": "https://www.haproxy.com/blog/cve-2024-45506",
          "url": "https://www.haproxy.com/blog/cve-2024-45506"
        },
        {
          "category": "external",
          "summary": "https://www.mail-archive.com/haproxy%40formilux.org/msg45280.html",
          "url": "https://www.mail-archive.com/haproxy%40formilux.org/msg45280.html"
        },
        {
          "category": "external",
          "summary": "https://www.mail-archive.com/haproxy%40formilux.org/msg45281.html",
          "url": "https://www.mail-archive.com/haproxy%40formilux.org/msg45281.html"
        }
      ],
      "release_date": "2024-09-04T15:15:14.080000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Disable the zero-copy forwarding system to mitigate this issue. Add the following configuration directive in the global section:\n\n~~~\nglobal\n  ...\n  tune.h2.zero-copy-fwd-send off\n~~~",
          "product_ids": [
            "red_hat_ceph_storage_5:haproxy",
            "red_hat_enterprise_linux_7:haproxy",
            "red_hat_enterprise_linux_8:haproxy",
            "red_hat_enterprise_linux_9:haproxy",
            "red_hat_openshift_container_platform_3.11:haproxy",
            "red_hat_openshift_container_platform_4:haproxy"
          ]
        }
      ],
      "title": "haproxy: potential infinite loop condition in the h2_send() may trigger a DoS"
    }
  ]
}