{
  "document": {
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-27933.json"
      }
    ],
    "title": "Deno arbitrary file descriptor close via `op_node_ipc_pipe()` leading to permission prompt bypass",
    "tracking": {
      "current_release_date": "2025-02-08T20:31:13+00:00",
      "generator": {
        "date": "2025-02-08T20:31:13+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2024-27933",
      "initial_release_date": "2024-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-08-02T19:55:09.948000+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-08T20:31:13+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "category": "vendor",
        "name": "Red Hat",
        "product": {
          "name": "All currently supported Red Hat products",
          "product_id": "red_hat_products",
          "product_identification_helper": {
            "cpe": "cpe:/a:redhat"
          }
        }
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-27933",
      "flags": [
        {
          "label": "component_not_present",
          "product_ids": [
            "red_hat_products"
          ]
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "Deno arbitrary file descriptor close via `op_node_ipc_pipe()` leading to permission prompt bypass",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat Product Security has determined that this vulnerability does not affect any currently supported Red Hat product. This assessment may evolve based on further analysis and discovery. For more information about this vulnerability and the products it affects, please see the linked references.",
          "title": "Statement"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_products"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-27933"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-27933",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-27933"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-27933",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-27933"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L214",
          "url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L214"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L220",
          "url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L220"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L225",
          "url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L225"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L241",
          "url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L241"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L256",
          "url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L256"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L265",
          "url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L265"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L99",
          "url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L99"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/commit/55fac9f5ead6d30996400e8597c969b675c5a22b",
          "url": "https://github.com/denoland/deno/commit/55fac9f5ead6d30996400e8597c969b675c5a22b"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/commit/5a91a065b882215dde209baf626247e54c21a392",
          "url": "https://github.com/denoland/deno/commit/5a91a065b882215dde209baf626247e54c21a392"
        },
        {
          "category": "external",
          "summary": "https://github.com/denoland/deno/security/advisories/GHSA-6q4w-9x56-rmwq",
          "url": "https://github.com/denoland/deno/security/advisories/GHSA-6q4w-9x56-rmwq"
        }
      ],
      "title": "Deno arbitrary file descriptor close via `op_node_ipc_pipe()` leading to permission prompt bypass"
    }
  ]
}