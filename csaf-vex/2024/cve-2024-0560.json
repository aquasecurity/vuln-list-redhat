{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-0560.json"
      }
    ],
    "title": "apicast: use_3scale_oidc_issuer_endpoint of Token Introspection policy isn't compatible with RH-SSO 7.5 or later versions",
    "tracking": {
      "current_release_date": "2024-11-18T15:21:14+00:00",
      "generator": {
        "date": "2024-11-18T15:21:14+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2024-0560",
      "initial_release_date": "2024-02-28T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-02-28T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-02-28T16:36:46.142148+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-18T15:21:14+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat 3scale API Management Platform 2",
                "product": {
                  "name": "Red Hat 3scale API Management Platform 2",
                  "product_id": "red_hat_3scale_api_management_platform_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:red_hat_3scale_amp:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat 3scale API Management Platform 2"
          },
          {
            "category": "product_version",
            "name": "apicast",
            "product": {
              "name": "apicast",
              "product_id": "apicast"
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "apicast as a component of Red Hat 3scale API Management Platform 2",
          "product_id": "red_hat_3scale_api_management_platform_2:apicast"
        },
        "product_reference": "apicast",
        "relates_to_product_reference": "red_hat_3scale_api_management_platform_2"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-0560",
      "cwe": {
        "id": "CWE-280",
        "name": "Improper Handling of Insufficient Permissions or Privileges "
      },
      "discovery_date": "2024-01-15T00:00:00+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2258456"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A vulnerability was found in 3Scale, when used with Keycloak 15 (or RHSSO 7.5.0) and superiors. When the auth_type is use_3scale_oidc_issuer_endpoint, the Token Introspection policy discovers the Token Introspection endpoint from the token_introspection_endpoint field, but the field was removed on RH-SSO 7.5. As a result, the policy doesn't inspect tokens, it determines that all tokens are valid.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "apicast: use_3scale_oidc_issuer_endpoint of Token Introspection policy isn't compatible with RH-SSO 7.5 or later versions",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat considers this as a Moderate flaw, as 3Scale will allow revoked or expired tokens, however, it will not allow tokens belonging to an unauthorized client. A client cannot access the services to which it is not subscribed because the authrep request is still performed correctly and will reject the client_id extracted from the JWT. This requires the attacker to obtain a token and could jeopardize a small and uncontrolled amount of data.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_3scale_api_management_platform_2:apicast"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-0560"
        },
        {
          "category": "external",
          "summary": "RHBZ#2258456",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2258456"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-0560",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-0560"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-0560",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-0560"
        },
        {
          "category": "external",
          "summary": "https://github.com/3scale/APIcast/pull/1438",
          "url": "https://github.com/3scale/APIcast/pull/1438"
        }
      ],
      "release_date": "2024-02-28T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Use an alternate auth_type: auth_type: client_id+client_secret. Disabling the policy entirely might be a temporary solution if the alternate {{auth_type is not feasible for some reason. The only purpose the token introspection endpoint serves is for sessions that are revoked in RH SSO before the standard TTL expires via the exp claim.",
          "product_ids": [
            "red_hat_3scale_api_management_platform_2:apicast"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_3scale_api_management_platform_2:apicast"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 6.3,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_3scale_api_management_platform_2:apicast"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_3scale_api_management_platform_2:apicast"
          ]
        }
      ],
      "title": "apicast: use_3scale_oidc_issuer_endpoint of Token Introspection policy isn't compatible with RH-SSO 7.5 or later versions"
    }
  ]
}