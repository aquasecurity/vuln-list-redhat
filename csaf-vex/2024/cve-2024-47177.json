{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-47177.json"
      }
    ],
    "title": "cups-filters: foomatic: foomatic-rip in cups-filters allows arbitrary command execution via the FoomaticRIPCommandLine PPD parameter",
    "tracking": {
      "current_release_date": "2025-01-07T02:54:28+00:00",
      "generator": {
        "date": "2025-01-07T02:54:28+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.5"
        }
      },
      "id": "CVE-2024-47177",
      "initial_release_date": "2024-09-26T20:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-09-26T20:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-10-25T15:00:43+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-07T02:54:28+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "category": "product_version",
            "name": "cups-filters",
            "product": {
              "name": "cups-filters",
              "product_id": "cups-filters",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/cups-filters?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "foomatic",
            "product": {
              "name": "foomatic",
              "product_id": "foomatic",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/foomatic?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "cups-filters as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:cups-filters"
        },
        "product_reference": "cups-filters",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "foomatic as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:foomatic"
        },
        "product_reference": "foomatic",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "cups-filters as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:cups-filters"
        },
        "product_reference": "cups-filters",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "foomatic as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:foomatic"
        },
        "product_reference": "foomatic",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "cups-filters as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:cups-filters"
        },
        "product_reference": "cups-filters",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "foomatic as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:foomatic"
        },
        "product_reference": "foomatic",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-47177",
      "cwe": {
        "id": "CWE-77",
        "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')"
      },
      "discovery_date": "2024-09-23T20:05:08.362000+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_7:cups-filters",
            "red_hat_enterprise_linux_8:foomatic",
            "red_hat_enterprise_linux_9:foomatic"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2314289"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A security flaw was found in OpenPrinting CUPS. The `FoomaticRIPCommandLine` directive in a PPD file will allow arbitrary commands to be executed when a print job is sent to the affected printing device. An attacker who could provide a malicious PPD file for a new print device or modify a PPD file of an existing device could execute arbitrary commands.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "cups-filters: foomatic: foomatic-rip in cups-filters allows arbitrary command execution via the FoomaticRIPCommandLine PPD parameter",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat rates the severity of this CVE as Moderate due to the restrictions of the unprivileged ‘lp’ user which the resulting commands would be run as. Additionally, creating and modifying printer definitions is restricted to the privileged user groups sys, root, and wheel by default.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_7:foomatic",
          "red_hat_enterprise_linux_8:cups-filters",
          "red_hat_enterprise_linux_9:cups-filters"
        ],
        "known_not_affected": [
          "red_hat_enterprise_linux_7:cups-filters",
          "red_hat_enterprise_linux_8:foomatic",
          "red_hat_enterprise_linux_9:foomatic"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-47177"
        },
        {
          "category": "external",
          "summary": "RHBZ#2314289",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2314289"
        },
        {
          "category": "external",
          "summary": "RHSB-2024-002",
          "url": "https://access.redhat.com/security/vulnerabilities/RHSB-2024-002"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-47177",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-47177"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-47177",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-47177"
        },
        {
          "category": "external",
          "summary": "https://github.com/OpenPrinting/cups-filters/security/advisories/GHSA-p9rh-jxmq-gq47",
          "url": "https://github.com/OpenPrinting/cups-filters/security/advisories/GHSA-p9rh-jxmq-gq47"
        },
        {
          "category": "external",
          "summary": "https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/",
          "url": "https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/"
        }
      ],
      "release_date": "2024-09-26T20:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "See the security bulletin for a detailed mitigation procedure.",
          "product_ids": [
            "red_hat_enterprise_linux_7:cups-filters",
            "red_hat_enterprise_linux_7:foomatic",
            "red_hat_enterprise_linux_8:cups-filters",
            "red_hat_enterprise_linux_8:foomatic",
            "red_hat_enterprise_linux_9:cups-filters",
            "red_hat_enterprise_linux_9:foomatic"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_enterprise_linux_7:foomatic"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_enterprise_linux_8:cups-filters",
            "red_hat_enterprise_linux_9:cups-filters"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:L",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "HIGH",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "LOW",
            "baseScore": 6.1,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_enterprise_linux_7:cups-filters",
            "red_hat_enterprise_linux_7:foomatic",
            "red_hat_enterprise_linux_8:cups-filters",
            "red_hat_enterprise_linux_8:foomatic",
            "red_hat_enterprise_linux_9:cups-filters",
            "red_hat_enterprise_linux_9:foomatic"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_enterprise_linux_7:cups-filters",
            "red_hat_enterprise_linux_7:foomatic",
            "red_hat_enterprise_linux_8:cups-filters",
            "red_hat_enterprise_linux_8:foomatic",
            "red_hat_enterprise_linux_9:cups-filters",
            "red_hat_enterprise_linux_9:foomatic"
          ]
        }
      ],
      "title": "cups-filters: foomatic: foomatic-rip in cups-filters allows arbitrary command execution via the FoomaticRIPCommandLine PPD parameter"
    }
  ]
}