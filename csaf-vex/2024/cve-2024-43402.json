{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-43402.json"
      }
    ],
    "title": "rust: Rust standard library did not properly escape arguments when invoking batch files on Windows using the Command API",
    "tracking": {
      "current_release_date": "2025-01-07T05:41:41+00:00",
      "generator": {
        "date": "2025-01-07T05:41:41+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.5"
        }
      },
      "id": "CVE-2024-43402",
      "initial_release_date": "2024-09-04T16:15:06.640000+00:00",
      "revision_history": [
        {
          "date": "2024-09-04T16:15:06.640000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-09-17T22:49:31+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-07T05:41:41+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "category": "product_version",
            "name": "rust-toolset:rhel8/rust",
            "product": {
              "name": "rust-toolset:rhel8/rust",
              "product_id": "rust-toolset:rhel8/rust",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/rust-toolset:rhel8/rust"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rust",
            "product": {
              "name": "rust",
              "product_id": "rust",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rust?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rust-toolset:rhel8/rust as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:rust-toolset:rhel8/rust"
        },
        "product_reference": "rust-toolset:rhel8/rust",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rust as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:rust"
        },
        "product_reference": "rust",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-43402",
      "cwe": {
        "id": "CWE-88",
        "name": "Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')"
      },
      "discovery_date": "2024-09-04T16:20:19.787505+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_8:rust-toolset:rhel8/rust",
            "red_hat_enterprise_linux_9:rust"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2309748"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Rust is a programming language. The fix for CVE-2024-24576, where `std::process::Command` incorrectly escaped arguments when invoking batch files on Windows, was incomplete. Prior to Rust version 1.81.0, it was possible to bypass the fix when the batch file name had trailing whitespace or periods (which are ignored and stripped by Windows). To determine whether to apply the `cmd.exe` escaping rules, the original fix for the vulnerability checked whether the command name ended with `.bat` or `.cmd`. At the time that seemed enough, as we refuse to invoke batch scripts with no file extension. Windows removes trailing whitespace and periods when parsing file paths. For example, `.bat. .` is interpreted by Windows as `.bat`, but the original fix didn't check for that. Affected users who are using Rust 1.77.2 or greater can remove the trailing whitespace (ASCII 0x20) and trailing periods (ASCII 0x2E) from the batch file name to bypass the incomplete fix and enable the mitigations. Users are affected if their code or one of their dependencies invoke a batch script on Windows with trailing whitespace or trailing periods in the name, and pass untrusted arguments to it. Rust 1.81.0 will update the standard library to apply the CVE-2024-24576 mitigations to all batch files invocations, regardless of the trailing chars in the file name.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "rust: Rust standard library did not properly escape arguments when invoking batch files on Windows using the Command API",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This CVE is specific to invoking batch files on Windows with untrusted arguments. No other platforms, including Red Hat, are affected.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_8:rust-toolset:rhel8/rust",
          "red_hat_enterprise_linux_9:rust"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-43402"
        },
        {
          "category": "external",
          "summary": "RHBZ#2309748",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2309748"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-43402",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-43402"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-43402",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-43402"
        },
        {
          "category": "external",
          "summary": "https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html",
          "url": "https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html"
        },
        {
          "category": "external",
          "summary": "https://github.com/rust-lang/rust/security/advisories/GHSA-2xg3-7mm6-98jj",
          "url": "https://github.com/rust-lang/rust/security/advisories/GHSA-2xg3-7mm6-98jj"
        },
        {
          "category": "external",
          "summary": "https://learn.microsoft.com/en-us/troubleshoot/windows-client/shell-experience/file-folder-name-whitespace-characters",
          "url": "https://learn.microsoft.com/en-us/troubleshoot/windows-client/shell-experience/file-folder-name-whitespace-characters"
        }
      ],
      "release_date": "2024-09-04T16:15:06.640000+00:00",
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "CHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_enterprise_linux_8:rust-toolset:rhel8/rust",
            "red_hat_enterprise_linux_9:rust"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "red_hat_enterprise_linux_8:rust-toolset:rhel8/rust",
            "red_hat_enterprise_linux_9:rust"
          ]
        }
      ],
      "title": "rust: Rust standard library did not properly escape arguments when invoking batch files on Windows using the Command API"
    }
  ]
}