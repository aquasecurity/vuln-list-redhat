{
  "document": {
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-40647.json"
      }
    ],
    "title": "Unintentional exposure of environment variables to subprocesses in sentry-sdk",
    "tracking": {
      "current_release_date": "2025-03-21T22:16:23+00:00",
      "generator": {
        "date": "2025-03-21T22:16:23+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.4.1"
        }
      },
      "id": "CVE-2024-40647",
      "initial_release_date": "2024-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-08-02T04:33:11.814000+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-03-21T22:16:23+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "category": "vendor",
        "name": "Red Hat",
        "product": {
          "name": "All currently supported Red Hat products",
          "product_id": "red_hat_products",
          "product_identification_helper": {
            "cpe": "cpe:/a:redhat"
          }
        }
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-40647",
      "flags": [
        {
          "label": "component_not_present",
          "product_ids": [
            "red_hat_products"
          ]
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "sentry-sdk is the official Python SDK for Sentry.io. A bug in Sentry's Python SDK \u003c 2.8.0 allows the environment variables to be passed to subprocesses despite the `env={}` setting. In Python's `subprocess` calls, all environment variables are passed to subprocesses by default. However, if you specifically do not want them to be passed to subprocesses, you may use `env` argument in `subprocess` calls. Due to the bug in Sentry SDK, with the Stdlib integration enabled (which is enabled by default), this expectation is not fulfilled, and all environment variables are being passed to subprocesses instead. The issue has been patched in pull request #3251 and is included in sentry-sdk==2.8.0. We strongly recommend upgrading to the latest SDK version. However, if it's not possible, and if passing environment variables to child processes poses a security risk for you, you can disable all default integrations.\n",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "Unintentional exposure of environment variables to subprocesses in sentry-sdk",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat Product Security has determined that this vulnerability does not affect any currently supported Red Hat product. This assessment may evolve based on further analysis and discovery. For more information about this vulnerability and the products it affects, please see the linked references.",
          "title": "Statement"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_products"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-40647"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-40647",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-40647"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-40647",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-40647"
        },
        {
          "category": "external",
          "summary": "https://docs.python.org/3/library/subprocess.html",
          "url": "https://docs.python.org/3/library/subprocess.html"
        },
        {
          "category": "external",
          "summary": "https://docs.sentry.io/platforms/python/integrations/default-integrations",
          "url": "https://docs.sentry.io/platforms/python/integrations/default-integrations"
        },
        {
          "category": "external",
          "summary": "https://docs.sentry.io/platforms/python/integrations/default-integrations/#stdlib",
          "url": "https://docs.sentry.io/platforms/python/integrations/default-integrations/#stdlib"
        },
        {
          "category": "external",
          "summary": "https://github.com/getsentry/sentry-python/commit/763e40aa4cb57ecced467f48f78f335c87e9bdff",
          "url": "https://github.com/getsentry/sentry-python/commit/763e40aa4cb57ecced467f48f78f335c87e9bdff"
        },
        {
          "category": "external",
          "summary": "https://github.com/getsentry/sentry-python/pull/3251",
          "url": "https://github.com/getsentry/sentry-python/pull/3251"
        },
        {
          "category": "external",
          "summary": "https://github.com/getsentry/sentry-python/releases/tag/2.8.0",
          "url": "https://github.com/getsentry/sentry-python/releases/tag/2.8.0"
        },
        {
          "category": "external",
          "summary": "https://github.com/getsentry/sentry-python/security/advisories/GHSA-g92j-qhmh-64v2",
          "url": "https://github.com/getsentry/sentry-python/security/advisories/GHSA-g92j-qhmh-64v2"
        }
      ],
      "title": "Unintentional exposure of environment variables to subprocesses in sentry-sdk"
    }
  ]
}