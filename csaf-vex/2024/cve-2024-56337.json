{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-56337.json"
      }
    ],
    "title": "tomcat: Incomplete fix for CVE-2024-50379 - RCE due to TOCTOU issue in JSP compilation",
    "tracking": {
      "current_release_date": "2024-12-20T18:26:41+00:00",
      "generator": {
        "date": "2024-12-20T18:26:41+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.3"
        }
      },
      "id": "CVE-2024-56337",
      "initial_release_date": "2024-12-20T15:28:54.738000+00:00",
      "revision_history": [
        {
          "date": "2024-12-20T15:28:54.738000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-12-20T17:52:10+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-12-20T18:26:41+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Web Server 5",
                "product": {
                  "name": "Red Hat JBoss Web Server 5",
                  "product_id": "red_hat_jboss_web_server_5",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Web Server 5"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Web Server 6",
                "product": {
                  "name": "Red Hat JBoss Web Server 6",
                  "product_id": "red_hat_jboss_web_server_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Web Server 6"
          },
          {
            "category": "product_version",
            "name": "tomcat6",
            "product": {
              "name": "tomcat6",
              "product_id": "tomcat6",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/tomcat6?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "tomcat",
            "product": {
              "name": "tomcat",
              "product_id": "tomcat",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/tomcat?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "pki-deps:10.6/pki-servlet-engine",
            "product": {
              "name": "pki-deps:10.6/pki-servlet-engine",
              "product_id": "pki-deps:10.6/pki-servlet-engine",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/pki-deps:10.6/pki-servlet-engine"
              }
            }
          },
          {
            "category": "product_version",
            "name": "pki-servlet-engine",
            "product": {
              "name": "pki-servlet-engine",
              "product_id": "pki-servlet-engine",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/pki-servlet-engine?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "tomcat6 as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:tomcat6"
        },
        "product_reference": "tomcat6",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "tomcat as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:tomcat"
        },
        "product_reference": "tomcat",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "pki-deps:10.6/pki-servlet-engine as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:pki-deps:10.6/pki-servlet-engine"
        },
        "product_reference": "pki-deps:10.6/pki-servlet-engine",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "tomcat as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:tomcat"
        },
        "product_reference": "tomcat",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "pki-servlet-engine as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:pki-servlet-engine"
        },
        "product_reference": "pki-servlet-engine",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "tomcat as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:tomcat"
        },
        "product_reference": "tomcat",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "tomcat as a component of Red Hat JBoss Web Server 5",
          "product_id": "red_hat_jboss_web_server_5:tomcat"
        },
        "product_reference": "tomcat",
        "relates_to_product_reference": "red_hat_jboss_web_server_5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "tomcat as a component of Red Hat JBoss Web Server 6",
          "product_id": "red_hat_jboss_web_server_6:tomcat"
        },
        "product_reference": "tomcat",
        "relates_to_product_reference": "red_hat_jboss_web_server_6"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-56337",
      "cwe": {
        "id": "CWE-367",
        "name": "Time-of-check Time-of-use (TOCTOU) Race Condition"
      },
      "discovery_date": "2024-12-20T16:00:45.883126+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_6:tomcat6",
            "red_hat_enterprise_linux_7:tomcat"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2333521"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in Apache Tomcat.\n\nThis issue affects Apache Tomcat: from 11.0.0-M1 through 11.0.1, from 10.1.0-M1 through 10.1.33, from 9.0.0.M1 through 9.0.97.\n\nThe mitigation for CVE-2024-50379 was incomplete.\n\nUsers running Tomcat on a case insensitive file system with the default servlet write enabled (readonly initialisation \nparameter set to the non-default value of false) may need additional configuration to fully mitigate CVE-2024-50379 depending on which version of Java they are using with Tomcat:\n- running on Java 8 or Java 11: the system property sun.io.useCanonCaches must be explicitly set to false (it defaults to true)\n- running on Java 17: the system property sun.io.useCanonCaches, if set, must be set to false (it defaults to false)\n- running on Java 21 onwards: no further configuration is required (the system property and the problematic cache have been removed)\n\nTomcat 11.0.3, 10.1.35 and 9.0.99 onwards will include checks that sun.io.useCanonCaches is set appropriately before allowing the default servlet to be write enabled on a case insensitive file system. Tomcat will also set sun.io.useCanonCaches to false by default where it can.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "tomcat: Incomplete fix for CVE-2024-50379 - RCE due to TOCTOU issue in JSP compilation",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability marked as important rather than moderate due to its potential to allow Remote Code Execution (RCE) when specific conditions are met, such as running on a case-insensitive file system with a misconfigured default servlet (`readonly=false`). RCE vulnerabilities are particularly important because they allow attackers to execute arbitrary code on the server, potentially compromising the confidentiality, integrity, and availability of the system. Additionally, the dependency on file system behavior and Java runtime configurations adds complexity to mitigation, increasing the likelihood of exploitation in misconfigured environments.\n\nThe default `readonly` initialization parameter value is `true` and not vulnerable to this issue.\n\nThe Tomcat package as shipped in Red Hat Enterprise Linux 6 and 7 is not affected by this vulnerability because the vulnerable code was introduced in a newer Tomcat version.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_8:pki-deps:10.6/pki-servlet-engine",
          "red_hat_enterprise_linux_8:tomcat",
          "red_hat_enterprise_linux_9:pki-servlet-engine",
          "red_hat_enterprise_linux_9:tomcat",
          "red_hat_jboss_web_server_5:tomcat",
          "red_hat_jboss_web_server_6:tomcat"
        ],
        "known_not_affected": [
          "red_hat_enterprise_linux_6:tomcat6",
          "red_hat_enterprise_linux_7:tomcat"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-56337"
        },
        {
          "category": "external",
          "summary": "RHBZ#2333521",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2333521"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-56337",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-56337"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-56337",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-56337"
        },
        {
          "category": "external",
          "summary": "https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp",
          "url": "https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-50379",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-50379"
        }
      ],
      "release_date": "2024-12-20T15:28:54.738000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Consider setting the readonly initialization parameter value to true (the default value), if that is not possible, do not use a case insensitive file system.",
          "product_ids": [
            "red_hat_enterprise_linux_6:tomcat6",
            "red_hat_enterprise_linux_7:tomcat",
            "red_hat_enterprise_linux_8:pki-deps:10.6/pki-servlet-engine",
            "red_hat_enterprise_linux_8:tomcat",
            "red_hat_enterprise_linux_9:pki-servlet-engine",
            "red_hat_enterprise_linux_9:tomcat",
            "red_hat_jboss_web_server_5:tomcat",
            "red_hat_jboss_web_server_6:tomcat"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_enterprise_linux_8:pki-deps:10.6/pki-servlet-engine",
            "red_hat_enterprise_linux_8:tomcat",
            "red_hat_enterprise_linux_9:pki-servlet-engine",
            "red_hat_enterprise_linux_9:tomcat",
            "red_hat_jboss_web_server_5:tomcat",
            "red_hat_jboss_web_server_6:tomcat"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_enterprise_linux_6:tomcat6",
            "red_hat_enterprise_linux_7:tomcat",
            "red_hat_enterprise_linux_8:pki-deps:10.6/pki-servlet-engine",
            "red_hat_enterprise_linux_8:tomcat",
            "red_hat_enterprise_linux_9:pki-servlet-engine",
            "red_hat_enterprise_linux_9:tomcat",
            "red_hat_jboss_web_server_5:tomcat",
            "red_hat_jboss_web_server_6:tomcat"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "red_hat_enterprise_linux_6:tomcat6",
            "red_hat_enterprise_linux_7:tomcat",
            "red_hat_enterprise_linux_8:pki-deps:10.6/pki-servlet-engine",
            "red_hat_enterprise_linux_8:tomcat",
            "red_hat_enterprise_linux_9:pki-servlet-engine",
            "red_hat_enterprise_linux_9:tomcat",
            "red_hat_jboss_web_server_5:tomcat",
            "red_hat_jboss_web_server_6:tomcat"
          ]
        }
      ],
      "title": "tomcat: Incomplete fix for CVE-2024-50379 - RCE due to TOCTOU issue in JSP compilation"
    }
  ]
}