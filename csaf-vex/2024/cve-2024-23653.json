{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-23653.json"
      }
    ],
    "title": "moby/buildkit: Buildkit's interactive containers API does not validate entitlements check",
    "tracking": {
      "current_release_date": "2024-12-10T16:13:26+00:00",
      "generator": {
        "date": "2024-12-10T16:13:26+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.3"
        }
      },
      "id": "CVE-2024-23653",
      "initial_release_date": "2024-01-31T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2024-01-31T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-06-09T17:58:00+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-12-10T16:13:26+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Developer Tools and Services",
                "product": {
                  "name": "OpenShift Developer Tools and Services",
                  "product_id": "openshift_developer_tools_and_services",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ocp_tools"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Developer Tools and Services"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Serverless",
                "product": {
                  "name": "OpenShift Serverless",
                  "product_id": "openshift_serverless",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:serverless:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Serverless"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 2",
                "product": {
                  "name": "OpenShift Service Mesh 2",
                  "product_id": "openshift_service_mesh_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ansible Automation Platform 1.2",
                "product": {
                  "name": "Red Hat Ansible Automation Platform 1.2",
                  "product_id": "red_hat_ansible_automation_platform_1.2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ansible_automation_platform"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ansible Automation Platform 1.2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ansible Automation Platform 2",
                "product": {
                  "name": "Red Hat Ansible Automation Platform 2",
                  "product_id": "red_hat_ansible_automation_platform_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ansible Automation Platform 2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Dev Spaces",
                "product": {
                  "name": "Red Hat OpenShift Dev Spaces",
                  "product_id": "red_hat_openshift_dev_spaces",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift_devspaces:3:"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Dev Spaces"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Quay 3",
                "product": {
                  "name": "Red Hat Quay 3",
                  "product_id": "red_hat_quay_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:quay:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Quay 3"
          },
          {
            "category": "product_version",
            "name": "odo",
            "product": {
              "name": "odo",
              "product_id": "odo",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/odo?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-serverless-1/client-kn-rhel8",
            "product": {
              "name": "openshift-serverless-1/client-kn-rhel8",
              "product_id": "openshift-serverless-1/client-kn-rhel8"
            }
          },
          {
            "category": "product_version",
            "name": "openshift-serverless-clients",
            "product": {
              "name": "openshift-serverless-clients",
              "product_id": "openshift-serverless-clients"
            }
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/istio-cni-rhel8",
            "product": {
              "name": "openshift-service-mesh/istio-cni-rhel8",
              "product_id": "openshift-service-mesh/istio-cni-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/istio-cni-rhel8?repository_url=registry.redhat.io/openshift-service-mesh/istio-cni-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-clients",
            "product": {
              "name": "openshift-clients",
              "product_id": "openshift-clients",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/openshift-clients?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "container-tools:rhel8/buildah",
            "product": {
              "name": "container-tools:rhel8/buildah",
              "product_id": "container-tools:rhel8/buildah",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/container-tools:rhel8/buildah"
              }
            }
          },
          {
            "category": "product_version",
            "name": "container-tools:rhel8/podman",
            "product": {
              "name": "container-tools:rhel8/podman",
              "product_id": "container-tools:rhel8/podman",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/container-tools:rhel8/podman"
              }
            }
          },
          {
            "category": "product_version",
            "name": "buildah",
            "product": {
              "name": "buildah",
              "product_id": "buildah",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/buildah?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "podman",
            "product": {
              "name": "podman",
              "product_id": "podman",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/podman?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "devspaces/traefik-rhel8",
            "product": {
              "name": "devspaces/traefik-rhel8",
              "product_id": "devspaces/traefik-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/traefik-rhel8?repository_url=registry.redhat.io/devspaces/traefik-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "quay/quay-builder-rhel8",
            "product": {
              "name": "quay/quay-builder-rhel8",
              "product_id": "quay/quay-builder-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/quay-builder-rhel8?repository_url=registry.redhat.io/quay/quay-builder-rhel8"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "odo as a component of OpenShift Developer Tools and Services",
          "product_id": "openshift_developer_tools_and_services:odo"
        },
        "product_reference": "odo",
        "relates_to_product_reference": "openshift_developer_tools_and_services"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-serverless-1/client-kn-rhel8 as a component of OpenShift Serverless",
          "product_id": "openshift_serverless:openshift-serverless-1/client-kn-rhel8"
        },
        "product_reference": "openshift-serverless-1/client-kn-rhel8",
        "relates_to_product_reference": "openshift_serverless"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-serverless-clients as a component of OpenShift Serverless",
          "product_id": "openshift_serverless:openshift-serverless-clients"
        },
        "product_reference": "openshift-serverless-clients",
        "relates_to_product_reference": "openshift_serverless"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/istio-cni-rhel8 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8"
        },
        "product_reference": "openshift-service-mesh/istio-cni-rhel8",
        "relates_to_product_reference": "openshift_service_mesh_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-clients as a component of Red Hat Ansible Automation Platform 1.2",
          "product_id": "red_hat_ansible_automation_platform_1.2:openshift-clients"
        },
        "product_reference": "openshift-clients",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_1.2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-clients as a component of Red Hat Ansible Automation Platform 2",
          "product_id": "red_hat_ansible_automation_platform_2:openshift-clients"
        },
        "product_reference": "openshift-clients",
        "relates_to_product_reference": "red_hat_ansible_automation_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "container-tools:rhel8/buildah as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:container-tools:rhel8/buildah"
        },
        "product_reference": "container-tools:rhel8/buildah",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "container-tools:rhel8/podman as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:container-tools:rhel8/podman"
        },
        "product_reference": "container-tools:rhel8/podman",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "buildah as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:buildah"
        },
        "product_reference": "buildah",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "podman as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:podman"
        },
        "product_reference": "podman",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-clients as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift-clients"
        },
        "product_reference": "openshift-clients",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "devspaces/traefik-rhel8 as a component of Red Hat OpenShift Dev Spaces",
          "product_id": "red_hat_openshift_dev_spaces:devspaces/traefik-rhel8"
        },
        "product_reference": "devspaces/traefik-rhel8",
        "relates_to_product_reference": "red_hat_openshift_dev_spaces"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "quay/quay-builder-rhel8 as a component of Red Hat Quay 3",
          "product_id": "red_hat_quay_3:quay/quay-builder-rhel8"
        },
        "product_reference": "quay/quay-builder-rhel8",
        "relates_to_product_reference": "red_hat_quay_3"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-23653",
      "cwe": {
        "id": "CWE-863",
        "name": "Incorrect Authorization"
      },
      "discovery_date": "2024-02-01T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "openshift_developer_tools_and_services:odo",
            "openshift_serverless:openshift-serverless-1/client-kn-rhel8",
            "openshift_serverless:openshift-serverless-clients",
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "red_hat_ansible_automation_platform_1.2:openshift-clients",
            "red_hat_ansible_automation_platform_2:openshift-clients",
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:openshift-clients"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2262226"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A vulnerability was found in the Moby Builder Toolkit, specifically in the Interactive Containers API, where entitlement checks are not adequately validated, caused by a missing privilege check in a GRPC endpoint when called using a custom syntax format. This flaw allows the currently running privileged container to leverage its elevated privileges, such as full Linux capabilities, to break out of the container and achieve complete host root command execution. This issue may lead to container escape to the underlying host OS when building an image using a malicious Dockerfile or upstream image (for example, when using FROM).",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "moby/buildkit: Buildkit's interactive containers API does not validate entitlements check",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability can only be exploited when a container execution is part of the build steps of another container. Additionally, an attacker needs to trick a user or process into processing an malicious Buildkit frontend. For these reasons, this flaw was rated with an important severity.\nThe risk of this vulnerability is to systems which build containers. It could have significant consequences to an organization's ability to release new versions of their software.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
          "red_hat_quay_3:quay/quay-builder-rhel8"
        ],
        "known_not_affected": [
          "openshift_developer_tools_and_services:odo",
          "openshift_serverless:openshift-serverless-1/client-kn-rhel8",
          "openshift_serverless:openshift-serverless-clients",
          "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
          "red_hat_ansible_automation_platform_1.2:openshift-clients",
          "red_hat_ansible_automation_platform_2:openshift-clients",
          "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
          "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
          "red_hat_enterprise_linux_9:buildah",
          "red_hat_enterprise_linux_9:podman",
          "red_hat_openshift_container_platform_4:openshift-clients"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-23653"
        },
        {
          "category": "external",
          "summary": "RHBZ#2262226",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262226"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-23653",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-23653"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-23653",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-23653"
        },
        {
          "category": "external",
          "summary": "https://github.com/moby/buildkit/pull/4602",
          "url": "https://github.com/moby/buildkit/pull/4602"
        },
        {
          "category": "external",
          "summary": "https://github.com/moby/buildkit/security/advisories/GHSA-wr6v-9f75-vh2g",
          "url": "https://github.com/moby/buildkit/security/advisories/GHSA-wr6v-9f75-vh2g"
        },
        {
          "category": "external",
          "summary": "https://snyk.io/blog/cve-2024-23653-buildkit-grpc-securitymode-privilege-check/",
          "url": "https://snyk.io/blog/cve-2024-23653-buildkit-grpc-securitymode-privilege-check/"
        }
      ],
      "release_date": "2024-01-31T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Do not use BuildKit frontends from untrusted sources.",
          "product_ids": [
            "openshift_developer_tools_and_services:odo",
            "openshift_serverless:openshift-serverless-1/client-kn-rhel8",
            "openshift_serverless:openshift-serverless-clients",
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "red_hat_ansible_automation_platform_1.2:openshift-clients",
            "red_hat_ansible_automation_platform_2:openshift-clients",
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:openshift-clients",
            "red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
            "red_hat_quay_3:quay/quay-builder-rhel8"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
            "red_hat_quay_3:quay/quay-builder-rhel8"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7,
            "baseSeverity": "HIGH"
          },
          "products": [
            "openshift_developer_tools_and_services:odo",
            "openshift_serverless:openshift-serverless-1/client-kn-rhel8",
            "openshift_serverless:openshift-serverless-clients",
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "red_hat_ansible_automation_platform_1.2:openshift-clients",
            "red_hat_ansible_automation_platform_2:openshift-clients",
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:openshift-clients",
            "red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
            "red_hat_quay_3:quay/quay-builder-rhel8"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "openshift_developer_tools_and_services:odo",
            "openshift_serverless:openshift-serverless-1/client-kn-rhel8",
            "openshift_serverless:openshift-serverless-clients",
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "red_hat_ansible_automation_platform_1.2:openshift-clients",
            "red_hat_ansible_automation_platform_2:openshift-clients",
            "red_hat_enterprise_linux_8:container-tools:rhel8/buildah",
            "red_hat_enterprise_linux_8:container-tools:rhel8/podman",
            "red_hat_enterprise_linux_9:buildah",
            "red_hat_enterprise_linux_9:podman",
            "red_hat_openshift_container_platform_4:openshift-clients",
            "red_hat_openshift_dev_spaces:devspaces/traefik-rhel8",
            "red_hat_quay_3:quay/quay-builder-rhel8"
          ]
        }
      ],
      "title": "moby/buildkit: Buildkit's interactive containers API does not validate entitlements check"
    }
  ]
}