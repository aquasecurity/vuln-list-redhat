{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-47220.json"
      }
    ],
    "title": "WEBrick: HTTP request smuggling",
    "tracking": {
      "current_release_date": "2024-12-06T01:35:37+00:00",
      "generator": {
        "date": "2024-12-06T01:35:37+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.2"
        }
      },
      "id": "CVE-2024-47220",
      "initial_release_date": "2024-09-22T01:15:11.950000+00:00",
      "revision_history": [
        {
          "date": "2024-09-22T01:15:11.950000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-10-25T14:56:56+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-12-06T01:35:37+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Logging Subsystem for Red Hat OpenShift",
                "product": {
                  "name": "Logging Subsystem for Red Hat OpenShift",
                  "product_id": "logging_subsystem_for_red_hat_openshift",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:logging:5"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Logging Subsystem for Red Hat OpenShift"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat 3scale API Management Platform 2",
                "product": {
                  "name": "Red Hat 3scale API Management Platform 2",
                  "product_id": "red_hat_3scale_api_management_platform_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:red_hat_3scale_amp:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat 3scale API Management Platform 2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Satellite 6",
                "product": {
                  "name": "Red Hat Satellite 6",
                  "product_id": "red_hat_satellite_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:satellite:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Satellite 6"
          },
          {
            "category": "product_version",
            "name": "openshift-logging/fluentd-rhel8",
            "product": {
              "name": "openshift-logging/fluentd-rhel8",
              "product_id": "openshift-logging/fluentd-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/fluentd-rhel8?repository_url=registry.redhat.io/openshift-logging/fluentd-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "3scale-amp-backend-container",
            "product": {
              "name": "3scale-amp-backend-container",
              "product_id": "3scale-amp-backend-container"
            }
          },
          {
            "category": "product_version",
            "name": "3scale-amp-system-container",
            "product": {
              "name": "3scale-amp-system-container",
              "product_id": "3scale-amp-system-container"
            }
          },
          {
            "category": "product_version",
            "name": "3scale-amp-zync-container",
            "product": {
              "name": "3scale-amp-zync-container",
              "product_id": "3scale-amp-zync-container"
            }
          },
          {
            "category": "product_version",
            "name": "pcs",
            "product": {
              "name": "pcs",
              "product_id": "pcs",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/pcs?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rubygem-webrick",
            "product": {
              "name": "rubygem-webrick",
              "product_id": "rubygem-webrick",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rubygem-webrick?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "satellite-capsule:el8/rubygem-webrick",
            "product": {
              "name": "satellite-capsule:el8/rubygem-webrick",
              "product_id": "satellite-capsule:el8/rubygem-webrick",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/satellite-capsule:el8/rubygem-webrick"
              }
            }
          },
          {
            "category": "product_version",
            "name": "satellite:el8/rubygem-webrick",
            "product": {
              "name": "satellite:el8/rubygem-webrick",
              "product_id": "satellite:el8/rubygem-webrick",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/satellite:el8/rubygem-webrick"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/fluentd-rhel8 as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/fluentd-rhel8"
        },
        "product_reference": "openshift-logging/fluentd-rhel8",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "3scale-amp-backend-container as a component of Red Hat 3scale API Management Platform 2",
          "product_id": "red_hat_3scale_api_management_platform_2:3scale-amp-backend-container"
        },
        "product_reference": "3scale-amp-backend-container",
        "relates_to_product_reference": "red_hat_3scale_api_management_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "3scale-amp-system-container as a component of Red Hat 3scale API Management Platform 2",
          "product_id": "red_hat_3scale_api_management_platform_2:3scale-amp-system-container"
        },
        "product_reference": "3scale-amp-system-container",
        "relates_to_product_reference": "red_hat_3scale_api_management_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "3scale-amp-zync-container as a component of Red Hat 3scale API Management Platform 2",
          "product_id": "red_hat_3scale_api_management_platform_2:3scale-amp-zync-container"
        },
        "product_reference": "3scale-amp-zync-container",
        "relates_to_product_reference": "red_hat_3scale_api_management_platform_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "pcs as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:pcs"
        },
        "product_reference": "pcs",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rubygem-webrick as a component of Red Hat Satellite 6",
          "product_id": "red_hat_satellite_6:rubygem-webrick"
        },
        "product_reference": "rubygem-webrick",
        "relates_to_product_reference": "red_hat_satellite_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "satellite-capsule:el8/rubygem-webrick as a component of Red Hat Satellite 6",
          "product_id": "red_hat_satellite_6:satellite-capsule:el8/rubygem-webrick"
        },
        "product_reference": "satellite-capsule:el8/rubygem-webrick",
        "relates_to_product_reference": "red_hat_satellite_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "satellite:el8/rubygem-webrick as a component of Red Hat Satellite 6",
          "product_id": "red_hat_satellite_6:satellite:el8/rubygem-webrick"
        },
        "product_reference": "satellite:el8/rubygem-webrick",
        "relates_to_product_reference": "red_hat_satellite_6"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-47220",
      "cwe": {
        "id": "CWE-444",
        "name": "Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')"
      },
      "discovery_date": "2024-09-22T01:20:12.271450+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_9:pcs"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2314051"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in the webrick toolkit. This issue occurs because the server incorrectly handles requests with both Content-Length and Transfer-Encoding headers. This can allow an attacker to sneak in an extra request such as GET /admin after the normal request POST /user. As a result, unauthorized users can access restricted areas like /admin by POST /user.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "WEBrick: HTTP request smuggling",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This CVE is rated as having Moderate impact because Webrick should not be used in production. It is only still maintained because there are other gems relying on it, most of which do so only for testing, and only because it is a pure ruby implementation and it was shipped with Ruby in the past.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "logging_subsystem_for_red_hat_openshift:openshift-logging/fluentd-rhel8",
          "red_hat_3scale_api_management_platform_2:3scale-amp-backend-container",
          "red_hat_3scale_api_management_platform_2:3scale-amp-system-container",
          "red_hat_3scale_api_management_platform_2:3scale-amp-zync-container",
          "red_hat_satellite_6:rubygem-webrick",
          "red_hat_satellite_6:satellite-capsule:el8/rubygem-webrick",
          "red_hat_satellite_6:satellite:el8/rubygem-webrick"
        ],
        "known_not_affected": [
          "red_hat_enterprise_linux_9:pcs"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-47220"
        },
        {
          "category": "external",
          "summary": "RHBZ#2314051",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2314051"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-47220",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-47220"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-47220",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-47220"
        },
        {
          "category": "external",
          "summary": "https://github.com/ruby/webrick/issues/145",
          "url": "https://github.com/ruby/webrick/issues/145"
        },
        {
          "category": "external",
          "summary": "https://github.com/ruby/webrick/pull/146/commits/d88321da45dcd230ac2b4585cad4833d6d5e8841",
          "url": "https://github.com/ruby/webrick/pull/146/commits/d88321da45dcd230ac2b4585cad4833d6d5e8841"
        }
      ],
      "release_date": "2024-09-22T01:15:11.950000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "As a temporary workaround, avoid using WEBrick in production environments. If you must use it, ensure that your application is behind a reverse proxy that can handle request validation and filtering to mitigate the risk of HTTP request smuggling.",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/fluentd-rhel8",
            "red_hat_3scale_api_management_platform_2:3scale-amp-backend-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-system-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-zync-container",
            "red_hat_enterprise_linux_9:pcs",
            "red_hat_satellite_6:rubygem-webrick",
            "red_hat_satellite_6:satellite-capsule:el8/rubygem-webrick",
            "red_hat_satellite_6:satellite:el8/rubygem-webrick"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/fluentd-rhel8",
            "red_hat_3scale_api_management_platform_2:3scale-amp-backend-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-system-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-zync-container",
            "red_hat_satellite_6:rubygem-webrick",
            "red_hat_satellite_6:satellite-capsule:el8/rubygem-webrick",
            "red_hat_satellite_6:satellite:el8/rubygem-webrick"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "products": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/fluentd-rhel8",
            "red_hat_3scale_api_management_platform_2:3scale-amp-backend-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-system-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-zync-container",
            "red_hat_enterprise_linux_9:pcs",
            "red_hat_satellite_6:rubygem-webrick",
            "red_hat_satellite_6:satellite-capsule:el8/rubygem-webrick",
            "red_hat_satellite_6:satellite:el8/rubygem-webrick"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/fluentd-rhel8",
            "red_hat_3scale_api_management_platform_2:3scale-amp-backend-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-system-container",
            "red_hat_3scale_api_management_platform_2:3scale-amp-zync-container",
            "red_hat_enterprise_linux_9:pcs",
            "red_hat_satellite_6:rubygem-webrick",
            "red_hat_satellite_6:satellite-capsule:el8/rubygem-webrick",
            "red_hat_satellite_6:satellite:el8/rubygem-webrick"
          ]
        }
      ],
      "title": "WEBrick: HTTP request smuggling"
    }
  ]
}