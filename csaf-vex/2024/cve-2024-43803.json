{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-43803.json"
      }
    ],
    "title": "Bare Metal Operator: BMO can expose particularly named secrets from other namespaces via BMH CRD",
    "tracking": {
      "current_release_date": "2024-09-12T22:09:27+00:00",
      "generator": {
        "date": "2024-09-12T22:09:27+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "3.33.3"
        }
      },
      "id": "CVE-2024-43803",
      "initial_release_date": "2024-09-03T19:15:14.800000+00:00",
      "revision_history": [
        {
          "date": "2024-09-03T19:15:14.800000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-09-05T09:55:19+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-09-12T22:09:27+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-baremetal-rhel7-operator",
            "product": {
              "name": "openshift4/ose-baremetal-rhel7-operator",
              "product_id": "openshift4/ose-baremetal-rhel7-operator",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift4/ose-baremetal-rhel7-operator"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-image-customization-controller-rhel8",
            "product": {
              "name": "openshift4/ose-image-customization-controller-rhel8",
              "product_id": "openshift4/ose-image-customization-controller-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift4/ose-image-customization-controller-rhel8"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-baremetal-rhel7-operator as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-baremetal-rhel7-operator"
        },
        "product_reference": "openshift4/ose-baremetal-rhel7-operator",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-image-customization-controller-rhel8 as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-image-customization-controller-rhel8"
        },
        "product_reference": "openshift4/ose-image-customization-controller-rhel8",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-43803",
      "cwe": {
        "id": "CWE-653",
        "name": "Improper Isolation or Compartmentalization"
      },
      "discovery_date": "2024-09-03T19:20:14.829355+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_openshift_container_platform_4:openshift4/ose-image-customization-controller-rhel8"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2309536"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in the Bare Metal Operator (BMO). The BMO implements a Kubernetes API for managing bare metal hosts in Metal3. The BareMetalHost (BMH) CRD allows the userData, metaData, and networkData for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for the Name and Namespace of the Secret, meaning that the baremetal-operator will read a Secret from any namespace. This flaw allows a user with access to create or edit a BareMetalHost can exfiltrate a Secret from another namespace by using it as the userData for provisioning some host, for example. Note that this need not be a real host; it could be a random VM.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "Bare Metal Operator: BMO can expose particularly named secrets from other namespaces via BMH CRD",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This issue is considered moderate rather than important because it requires specific conditions to be exploited. The vulnerability relies on an attacker already having the ability to create or modify a BareMetalHost resource, which typically requires elevated permissions. Furthermore, the flaw only allows exfiltration of Secrets by referencing them in another namespace, but does not directly expose or escalate privileges across the cluster. It also doesn't impact the integrity or availability of the system but is limited to confidentiality concerns within a specific scope. Proper RBAC policies can mitigate this risk, reducing its overall severity.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_openshift_container_platform_4:openshift4/ose-baremetal-rhel7-operator"
        ],
        "known_not_affected": [
          "red_hat_openshift_container_platform_4:openshift4/ose-image-customization-controller-rhel8"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-43803"
        },
        {
          "category": "external",
          "summary": "RHBZ#2309536",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2309536"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-43803",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-43803"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-43803",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-43803"
        },
        {
          "category": "external",
          "summary": "https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74",
          "url": "https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74"
        },
        {
          "category": "external",
          "summary": "https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb",
          "url": "https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb"
        },
        {
          "category": "external",
          "summary": "https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7",
          "url": "https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7"
        },
        {
          "category": "external",
          "summary": "https://github.com/metal3-io/baremetal-operator/pull/1929",
          "url": "https://github.com/metal3-io/baremetal-operator/pull/1929"
        },
        {
          "category": "external",
          "summary": "https://github.com/metal3-io/baremetal-operator/pull/1930",
          "url": "https://github.com/metal3-io/baremetal-operator/pull/1930"
        },
        {
          "category": "external",
          "summary": "https://github.com/metal3-io/baremetal-operator/pull/1931",
          "url": "https://github.com/metal3-io/baremetal-operator/pull/1931"
        },
        {
          "category": "external",
          "summary": "https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p",
          "url": "https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p"
        }
      ],
      "release_date": "2024-09-03T19:15:14.800000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "The Operator can configure BMO RBAC to be the namespace scoped for Secrets, instead of the cluster scoped to prevent BMO from accessing Secrets from other namespaces.",
          "product_ids": [
            "red_hat_openshift_container_platform_4:openshift4/ose-baremetal-rhel7-operator",
            "red_hat_openshift_container_platform_4:openshift4/ose-image-customization-controller-rhel8"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_openshift_container_platform_4:openshift4/ose-baremetal-rhel7-operator"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.9,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_openshift_container_platform_4:openshift4/ose-baremetal-rhel7-operator"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_openshift_container_platform_4:openshift4/ose-baremetal-rhel7-operator"
          ]
        }
      ],
      "title": "Bare Metal Operator: BMO can expose particularly named secrets from other namespaces via BMH CRD"
    }
  ]
}