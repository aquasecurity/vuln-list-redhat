{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-45809.json"
      }
    ],
    "title": "envoy: JWT filter crash in the clear route cache with remote JWKs",
    "tracking": {
      "current_release_date": "2024-11-24T22:31:56+00:00",
      "generator": {
        "date": "2024-11-24T22:31:56+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2024-45809",
      "initial_release_date": "2024-09-20T00:15:02.930000+00:00",
      "revision_history": [
        {
          "date": "2024-09-20T00:15:02.930000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-10-25T14:59:56+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-24T22:31:56+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 2",
                "product": {
                  "name": "OpenShift Service Mesh 2",
                  "product_id": "openshift_service_mesh_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 2"
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/istio-cni-rhel8",
            "product": {
              "name": "openshift-service-mesh/istio-cni-rhel8",
              "product_id": "openshift-service-mesh/istio-cni-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/istio-cni-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/pilot-rhel8",
            "product": {
              "name": "openshift-service-mesh/pilot-rhel8",
              "product_id": "openshift-service-mesh/pilot-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/pilot-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/proxyv2-rhel8",
            "product": {
              "name": "openshift-service-mesh/proxyv2-rhel8",
              "product_id": "openshift-service-mesh/proxyv2-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/proxyv2-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-service-mesh/proxyv2-rhel9",
            "product": {
              "name": "openshift-service-mesh/proxyv2-rhel9",
              "product_id": "openshift-service-mesh/proxyv2-rhel9",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-service-mesh/proxyv2-rhel9"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/istio-cni-rhel8 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8"
        },
        "product_reference": "openshift-service-mesh/istio-cni-rhel8",
        "relates_to_product_reference": "openshift_service_mesh_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/pilot-rhel8 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
        },
        "product_reference": "openshift-service-mesh/pilot-rhel8",
        "relates_to_product_reference": "openshift_service_mesh_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/proxyv2-rhel8 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8"
        },
        "product_reference": "openshift-service-mesh/proxyv2-rhel8",
        "relates_to_product_reference": "openshift_service_mesh_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-service-mesh/proxyv2-rhel9 as a component of OpenShift Service Mesh 2",
          "product_id": "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
        },
        "product_reference": "openshift-service-mesh/proxyv2-rhel9",
        "relates_to_product_reference": "openshift_service_mesh_2"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2024-45809",
      "cwe": {
        "id": "CWE-119",
        "name": "Improper Restriction of Operations within the Bounds of a Memory Buffer"
      },
      "discovery_date": "2024-09-20T00:40:28.807729+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2313686"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in Envoy. JWT filter will lead to a crash in Envoy when clearing the route cache with remote JWKs in the following cases: \n1. Remote JWKs are used, which requires async header processing \n2. clear_route_cache is enabled on the provider \n3. Header operations are enabled in JWT filter, for example, header to claims feature\n4. The routing table is configured in a way that the JWT header operations modify requests to not match any route\nWhen these conditions are met, a crash is triggered in the upstream code due to nullptr reference conversion from route(). The root cause is the ordering of continueDecoding and clearRouteCache.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "envoy: JWT filter crash in the clear route cache with remote JWKs",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability in Envoy should be considered high-severity rather than moderate due to its potential to cause a complete crash of the service when handling JWT authentication with remote JWKs and asynchronous header processing. In cloud-native environments where Envoy is often used as a critical edge or service proxy, the conditions triggering this crash—such as the combination of route cache clearing, header operations, and JWT authentication—are not uncommon. The impact is significant because the crash occurs during normal request processing, leading to service disruption and downtime.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
          "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
        ],
        "known_not_affected": [
          "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8",
          "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2024-45809"
        },
        {
          "category": "external",
          "summary": "RHBZ#2313686",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2313686"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2024-45809",
          "url": "https://www.cve.org/CVERecord?id=CVE-2024-45809"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2024-45809",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-45809"
        },
        {
          "category": "external",
          "summary": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-wqr5-qmq7-3qw3",
          "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-wqr5-qmq7-3qw3"
        }
      ],
      "release_date": "2024-09-20T00:15:02.930000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/proxyv2-rhel9"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "products": [
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "openshift_service_mesh_2:openshift-service-mesh/istio-cni-rhel8",
            "openshift_service_mesh_2:openshift-service-mesh/pilot-rhel8"
          ]
        }
      ],
      "title": "envoy: JWT filter crash in the clear route cache with remote JWKs"
    }
  ]
}