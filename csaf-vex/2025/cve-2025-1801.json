{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2025/cve-2025-1801.json"
      }
    ],
    "title": "aap-gateway: aap-gateway privilege escalation",
    "tracking": {
      "current_release_date": "2025-03-03T15:03:13+00:00",
      "generator": {
        "date": "2025-03-03T15:03:13+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.1"
        }
      },
      "id": "CVE-2025-1801",
      "initial_release_date": "2025-03-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2025-03-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-03-03T14:45:02+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-03-03T15:03:13+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ansible Automation Platform 2.5 for RHEL 8",
                "product": {
                  "name": "Red Hat Ansible Automation Platform 2.5 for RHEL 8",
                  "product_id": "8Base-Ansible-Automation-Platform-2.5",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el8"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "Red Hat Ansible Automation Platform 2.5 for RHEL 9",
                "product": {
                  "name": "Red Hat Ansible Automation Platform 2.5 for RHEL 9",
                  "product_id": "9Base-Ansible-Automation-Platform-2.5",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ansible Automation Platform"
          },
          {
            "branches": [
              {
                "category": "product_version",
                "name": "automation-gateway-0:2.5.20250305-1.el8ap.src",
                "product": {
                  "name": "automation-gateway-0:2.5.20250305-1.el8ap.src",
                  "product_id": "automation-gateway-0:2.5.20250305-1.el8ap.src",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway@2.5.20250305-1.el8ap?arch=src"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "automation-gateway-0:2.5.20250305-1.el9ap.src",
                "product": {
                  "name": "automation-gateway-0:2.5.20250305-1.el9ap.src",
                  "product_id": "automation-gateway-0:2.5.20250305-1.el9ap.src",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway@2.5.20250305-1.el9ap?arch=src"
                  }
                }
              }
            ],
            "category": "architecture",
            "name": "src"
          },
          {
            "branches": [
              {
                "category": "product_version",
                "name": "automation-gateway-0:2.5.20250305-1.el8ap.noarch",
                "product": {
                  "name": "automation-gateway-0:2.5.20250305-1.el8ap.noarch",
                  "product_id": "automation-gateway-0:2.5.20250305-1.el8ap.noarch",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway@2.5.20250305-1.el8ap?arch=noarch"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
                "product": {
                  "name": "automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
                  "product_id": "automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway-config@2.5.20250305-1.el8ap?arch=noarch"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
                "product": {
                  "name": "automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
                  "product_id": "automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway-server@2.5.20250305-1.el8ap?arch=noarch"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "automation-gateway-0:2.5.20250305-1.el9ap.noarch",
                "product": {
                  "name": "automation-gateway-0:2.5.20250305-1.el9ap.noarch",
                  "product_id": "automation-gateway-0:2.5.20250305-1.el9ap.noarch",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway@2.5.20250305-1.el9ap?arch=noarch"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
                "product": {
                  "name": "automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
                  "product_id": "automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway-config@2.5.20250305-1.el9ap?arch=noarch"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "automation-gateway-server-0:2.5.20250305-1.el9ap.noarch",
                "product": {
                  "name": "automation-gateway-server-0:2.5.20250305-1.el9ap.noarch",
                  "product_id": "automation-gateway-server-0:2.5.20250305-1.el9ap.noarch",
                  "product_identification_helper": {
                    "purl": "pkg:rpm/redhat/automation-gateway-server@2.5.20250305-1.el9ap?arch=noarch"
                  }
                }
              }
            ],
            "category": "architecture",
            "name": "noarch"
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-0:2.5.20250305-1.el8ap.noarch as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 8",
          "product_id": "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.noarch"
        },
        "product_reference": "automation-gateway-0:2.5.20250305-1.el8ap.noarch",
        "relates_to_product_reference": "8Base-Ansible-Automation-Platform-2.5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-0:2.5.20250305-1.el8ap.src as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 8",
          "product_id": "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.src"
        },
        "product_reference": "automation-gateway-0:2.5.20250305-1.el8ap.src",
        "relates_to_product_reference": "8Base-Ansible-Automation-Platform-2.5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-config-0:2.5.20250305-1.el8ap.noarch as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 8",
          "product_id": "8Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el8ap.noarch"
        },
        "product_reference": "automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
        "relates_to_product_reference": "8Base-Ansible-Automation-Platform-2.5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-server-0:2.5.20250305-1.el8ap.noarch as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 8",
          "product_id": "8Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el8ap.noarch"
        },
        "product_reference": "automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
        "relates_to_product_reference": "8Base-Ansible-Automation-Platform-2.5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-0:2.5.20250305-1.el9ap.noarch as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 9",
          "product_id": "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.noarch"
        },
        "product_reference": "automation-gateway-0:2.5.20250305-1.el9ap.noarch",
        "relates_to_product_reference": "9Base-Ansible-Automation-Platform-2.5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-0:2.5.20250305-1.el9ap.src as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 9",
          "product_id": "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.src"
        },
        "product_reference": "automation-gateway-0:2.5.20250305-1.el9ap.src",
        "relates_to_product_reference": "9Base-Ansible-Automation-Platform-2.5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-config-0:2.5.20250305-1.el9ap.noarch as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 9",
          "product_id": "9Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el9ap.noarch"
        },
        "product_reference": "automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
        "relates_to_product_reference": "9Base-Ansible-Automation-Platform-2.5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "automation-gateway-server-0:2.5.20250305-1.el9ap.noarch as a component of Red Hat Ansible Automation Platform 2.5 for RHEL 9",
          "product_id": "9Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el9ap.noarch"
        },
        "product_reference": "automation-gateway-server-0:2.5.20250305-1.el9ap.noarch",
        "relates_to_product_reference": "9Base-Ansible-Automation-Platform-2.5"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2025-1801",
      "cwe": {
        "id": "CWE-362",
        "name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')"
      },
      "discovery_date": "2025-02-28T20:34:52.617000+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2349081"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in the Ansible aap-gateway. Concurrent requests handled by the gateway grpc service can result in concurrency issues due to race condition requests against the proxy. This issue potentially allows a less privileged user to obtain the JWT of a greater privileged user, enabling the server to be jeopardized. A user session or confidential data might be vulnerable.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "aap-gateway: aap-gateway privilege escalation",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat has evaluated this vulnerability. This issue only affects versions AAP 2.5 GA and onwards.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "fixed": [
          "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.noarch",
          "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.src",
          "8Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
          "8Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
          "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.noarch",
          "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.src",
          "9Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
          "9Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el9ap.noarch"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2025-1801"
        },
        {
          "category": "external",
          "summary": "RHBZ#2349081",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2349081"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2025-1801",
          "url": "https://www.cve.org/CVERecord?id=CVE-2025-1801"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2025-1801",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-1801"
        }
      ],
      "release_date": "2025-03-01T00:00:00+00:00",
      "remediations": [
        {
          "category": "vendor_fix",
          "date": "2025-03-01T13:56:53+00:00",
          "details": "Red Hat Ansible Automation Platform",
          "product_ids": [
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.src",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.src",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el9ap.noarch"
          ],
          "url": "https://access.redhat.com/errata/RHSA-2025:1954"
        },
        {
          "category": "workaround",
          "details": "Follow the mitigation steps to avoid the flaw from happening. It is recommended to update the product after the fix is available.\n\n\n1) set GRPC_SERVER_MAX_THREADS_PER_PROCESS = 1\n\nThis mitigates problems going FORWARD for the issue because there is only one thread using the ExternalAuth() object instantiated by the parent process. This eliminates the thread safety risk as the worker only processes one request at a time.\n\n2) It is possible that at any time since the install/upgrade of AAP 2.5, that long lived Oauth tokens created in the components with the endpoints could implicate long term access to a different user's identity/privileges. Requests made with these tokens will appear to be from the user for which they were created and are indistinguishable from “valid” tokens that were created by the correct user:\n\n/api/controller/v2/tokens/\n/api/controller/v2/applications/\u003cid\u003e/tokens/\n/api/galaxy/v3/auth/token/\n/api/controller/o/token/\n\nBecause it is likely not feasible to back trace every request that could have generated a token to its original request in the GRPC server, the most conservative and safe path to mitigate this risk would be to invalidate/revoke all existing oauth tokens in the components (hub, controller, eda).",
          "product_ids": [
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.src",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.src",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el9ap.noarch"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "NONE",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "products": [
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.src",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.src",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el9ap.noarch"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el8ap.src",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el8ap.noarch",
            "8Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el8ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-0:2.5.20250305-1.el9ap.src",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-config-0:2.5.20250305-1.el9ap.noarch",
            "9Base-Ansible-Automation-Platform-2.5:automation-gateway-server-0:2.5.20250305-1.el9ap.noarch"
          ]
        }
      ],
      "title": "aap-gateway: aap-gateway privilege escalation"
    }
  ]
}