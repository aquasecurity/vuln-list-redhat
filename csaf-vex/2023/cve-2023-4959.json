{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2023/cve-2023-4959.json"
      }
    ],
    "title": "quay: Cross-Site Request Forgery (CSRF) on config-editor page",
    "tracking": {
      "current_release_date": "2024-11-18T20:13:39+00:00",
      "generator": {
        "date": "2024-11-18T20:13:39+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2023-4959",
      "initial_release_date": "2023-09-15T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2023-09-15T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-09-15T09:51:26.325071+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-18T20:13:39+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Quay 3",
                "product": {
                  "name": "Red Hat Quay 3",
                  "product_id": "red_hat_quay_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:quay:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Quay 3"
          },
          {
            "category": "product_version",
            "name": "Quay",
            "product": {
              "name": "Quay",
              "product_id": "Quay",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/Quay?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "Quay as a component of Red Hat Quay 3",
          "product_id": "red_hat_quay_3:Quay"
        },
        "product_reference": "Quay",
        "relates_to_product_reference": "red_hat_quay_3"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2023-4959",
      "cwe": {
        "id": "CWE-352",
        "name": "Cross-Site Request Forgery (CSRF)"
      },
      "discovery_date": "2023-09-14T00:00:00+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2238908"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in Quay. Cross-site request forgery (CSRF) attacks force a user to perform unwanted actions in an application. During the pentest, it was detected that the config-editor page is vulnerable to CSRF. The config-editor page is used to configure the Quay instance. By coercing the victim’s browser into sending an attacker-controlled request from another domain, it is possible to reconfigure the Quay instance (including adding users with admin privileges).",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "quay: Cross-Site Request Forgery (CSRF) on config-editor page",
          "title": "Vulnerability summary"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_quay_3:Quay"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2023-4959"
        },
        {
          "category": "external",
          "summary": "RHBZ#2238908",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2238908"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2023-4959",
          "url": "https://www.cve.org/CVERecord?id=CVE-2023-4959"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2023-4959",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-4959"
        }
      ],
      "release_date": "2023-09-15T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "To avoid the risk associated with this vulnerability, it is recommended to include a secret in all requests that may generate a change in the application's data. A secret is understood, for example, as an extra parameter, generated and sent to the client when accessing the web resource from which the request to be protected is launched. This secret must be generated randomly and be different for each request to be made. On the server side, the application must check that these requests, which cause significant modifications to the data, include the previously generated secrets. If this is not included or is erroneous, the application should not perform the corresponding action.\n\nIn addition to this secret, it is recommended to set the \"SameSite\" attribute in the session cookie with the following values:\n- SameSite=Strict: this value prevents the cookie from being sent in any cross-origin request.\n- SameSite=Lax: this is the value that is recommended in this case as any action carried out via POST or via a script from a cross-origin will be rejected by the browser.",
          "product_ids": [
            "red_hat_quay_3:Quay"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_quay_3:Quay"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_quay_3:Quay"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_quay_3:Quay"
          ]
        }
      ],
      "title": "quay: Cross-Site Request Forgery (CSRF) on config-editor page"
    }
  ]
}