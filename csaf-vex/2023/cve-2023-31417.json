{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2023/cve-2023-31417.json"
      }
    ],
    "title": "elasticsearch: Sensitive information in audit logs",
    "tracking": {
      "current_release_date": "2024-12-05T22:28:12+00:00",
      "generator": {
        "date": "2024-12-05T22:28:12+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.2"
        }
      },
      "id": "CVE-2023-31417",
      "initial_release_date": "2023-09-06T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2023-09-06T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-01-02T20:44:24+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-12-05T22:28:12+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Logging Subsystem for Red Hat OpenShift",
                "product": {
                  "name": "Logging Subsystem for Red Hat OpenShift",
                  "product_id": "logging_subsystem_for_red_hat_openshift",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:logging:5"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Logging Subsystem for Red Hat OpenShift"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 3.11",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 3.11",
                  "product_id": "red_hat_openshift_container_platform_3.11",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:3.11"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 3.11"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "openshift-logging/elasticsearch6-rhel8",
            "product": {
              "name": "openshift-logging/elasticsearch6-rhel8",
              "product_id": "openshift-logging/elasticsearch6-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/elasticsearch6-rhel8?repository_url=registry.redhat.io/openshift-logging/elasticsearch6-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift3/ose-logging-elasticsearch5",
            "product": {
              "name": "openshift3/ose-logging-elasticsearch5",
              "product_id": "openshift3/ose-logging-elasticsearch5",
              "product_identification_helper": {
                "purl": "pkg:oci/ose-logging-elasticsearch5?repository_url=registry.redhat.io/openshift3/ose-logging-elasticsearch5"
              }
            }
          },
          {
            "category": "product_version",
            "name": "elasticsearch",
            "product": {
              "name": "elasticsearch",
              "product_id": "elasticsearch",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/elasticsearch?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/elasticsearch6-rhel8 as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel8"
        },
        "product_reference": "openshift-logging/elasticsearch6-rhel8",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift3/ose-logging-elasticsearch5 as a component of Red Hat OpenShift Container Platform 3.11",
          "product_id": "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5"
        },
        "product_reference": "openshift3/ose-logging-elasticsearch5",
        "relates_to_product_reference": "red_hat_openshift_container_platform_3.11"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "elasticsearch as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:elasticsearch"
        },
        "product_reference": "elasticsearch",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2023-31417",
      "cwe": {
        "id": "CWE-532",
        "name": "Insertion of Sensitive Information into Log File"
      },
      "discovery_date": "2023-09-07T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel8"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2237927"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in the Elasticsearch package. Elasticsearch filters out sensitive information and credentials before logging into the audit log. It was found that this filtering was not applied when requests to Elasticsearch use certain deprecated URIs for APIs. As a result, sensitive information such as passwords and tokens might be printed in cleartext in Elasticsearch audit logs.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "elasticsearch: Sensitive information in audit logs",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "The audit logging is disabled by default and needs to be explicitly enabled and even when audit logging is enabled, request bodies that could contain sensitive information are not printed to the audit log unless explicitly configured. Hence, the impact is set to Moderate.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5",
          "red_hat_openshift_container_platform_4:elasticsearch"
        ],
        "known_not_affected": [
          "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel8"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2023-31417"
        },
        {
          "category": "external",
          "summary": "RHBZ#2237927",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2237927"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2023-31417",
          "url": "https://www.cve.org/CVERecord?id=CVE-2023-31417"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2023-31417",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-31417"
        },
        {
          "category": "external",
          "summary": "https://discuss.elastic.co/t/elasticsearch-8-9-2-and-7-17-13-security-update/342479",
          "url": "https://discuss.elastic.co/t/elasticsearch-8-9-2-and-7-17-13-security-update/342479"
        }
      ],
      "release_date": "2023-09-06T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base, or stability. Please update the affected package as soon as possible.",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel8",
            "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5",
            "red_hat_openshift_container_platform_4:elasticsearch"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_openshift_container_platform_4:elasticsearch"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "HIGH",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.1,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel8",
            "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5",
            "red_hat_openshift_container_platform_4:elasticsearch"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel8",
            "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5",
            "red_hat_openshift_container_platform_4:elasticsearch"
          ]
        }
      ],
      "title": "elasticsearch: Sensitive information in audit logs"
    }
  ]
}