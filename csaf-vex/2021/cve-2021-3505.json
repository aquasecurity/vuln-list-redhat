{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Low"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2021/cve-2021-3505.json"
      }
    ],
    "title": "libtpms: RSA keys weaker than expected",
    "tracking": {
      "current_release_date": "2025-01-07T23:25:53+00:00",
      "generator": {
        "date": "2025-01-07T23:25:53+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.5"
        }
      },
      "id": "CVE-2021-3505",
      "initial_release_date": "2021-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2021-10-29T08:57:48+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-07T23:25:53+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8 Advanced Virtualization",
                "product": {
                  "name": "Red Hat Enterprise Linux 8 Advanced Virtualization",
                  "product_id": "red_hat_enterprise_linux_8_advanced_virtualization",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:advanced_virtualization:8::el8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8 Advanced Virtualization"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "category": "product_version",
            "name": "virt:8.2/libtpms",
            "product": {
              "name": "virt:8.2/libtpms",
              "product_id": "virt:8.2/libtpms",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/virt:8.2/libtpms"
              }
            }
          },
          {
            "category": "product_version",
            "name": "virt:8.3/libtpms",
            "product": {
              "name": "virt:8.3/libtpms",
              "product_id": "virt:8.3/libtpms",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/virt:8.3/libtpms"
              }
            }
          },
          {
            "category": "product_version",
            "name": "virt:av/libtpms",
            "product": {
              "name": "virt:av/libtpms",
              "product_id": "virt:av/libtpms",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/virt:av/libtpms"
              }
            }
          },
          {
            "category": "product_version",
            "name": "libtpms",
            "product": {
              "name": "libtpms",
              "product_id": "libtpms",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/libtpms?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "virt:8.2/libtpms as a component of Red Hat Enterprise Linux 8 Advanced Virtualization",
          "product_id": "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.2/libtpms"
        },
        "product_reference": "virt:8.2/libtpms",
        "relates_to_product_reference": "red_hat_enterprise_linux_8_advanced_virtualization"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "virt:8.3/libtpms as a component of Red Hat Enterprise Linux 8 Advanced Virtualization",
          "product_id": "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.3/libtpms"
        },
        "product_reference": "virt:8.3/libtpms",
        "relates_to_product_reference": "red_hat_enterprise_linux_8_advanced_virtualization"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "virt:av/libtpms as a component of Red Hat Enterprise Linux 8 Advanced Virtualization",
          "product_id": "red_hat_enterprise_linux_8_advanced_virtualization:virt:av/libtpms"
        },
        "product_reference": "virt:av/libtpms",
        "relates_to_product_reference": "red_hat_enterprise_linux_8_advanced_virtualization"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "libtpms as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:libtpms"
        },
        "product_reference": "libtpms",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-3505",
      "cwe": {
        "id": "CWE-331",
        "name": "Insufficient Entropy"
      },
      "discovery_date": "2021-02-24T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_9:libtpms"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1950046"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in libtpms. The TPM 2 implementation returns 2048 bit keys with ~1984 bit strength due to a bug in the TCG specification. The bug is in the key creation algorithm in RsaAdjustPrimeCandidate(), which is called before the prime number check. The highest threat from this vulnerability is to data confidentiality.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "libtpms: RSA keys weaker than expected",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Versions of `libtpms` prior to 0.8.0 generate weaker than expected TPM 2 RSA keys due to the flawed key creation algorithm. Red Hat Enterprise Linux 8 Advanced Virtualization is therefore affected by this flaw, as it ships an older version of the package (0.7.x).",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.2/libtpms",
          "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.3/libtpms",
          "red_hat_enterprise_linux_8_advanced_virtualization:virt:av/libtpms"
        ],
        "known_not_affected": [
          "red_hat_enterprise_linux_9:libtpms"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-3505"
        },
        {
          "category": "external",
          "summary": "RHBZ#1950046",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1950046"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-3505",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-3505"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-3505",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-3505"
        }
      ],
      "release_date": "2020-04-14T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "There is no mitigation for this issue. Upgrading to a fixed release (0.8.0+) is necessary but not sufficient. The only way to fix it is to unseal all data, delete the old TPM state file, generate a new one with the fixed key generation algorithm, then reseal the data.",
          "product_ids": [
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.2/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.3/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:av/libtpms",
            "red_hat_enterprise_linux_9:libtpms"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.2/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.3/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:av/libtpms"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.2/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.3/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:av/libtpms",
            "red_hat_enterprise_linux_9:libtpms"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.2/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:8.3/libtpms",
            "red_hat_enterprise_linux_8_advanced_virtualization:virt:av/libtpms",
            "red_hat_enterprise_linux_9:libtpms"
          ]
        }
      ],
      "title": "libtpms: RSA keys weaker than expected"
    }
  ]
}