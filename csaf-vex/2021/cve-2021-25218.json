{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://access.redhat.com/security/data/csaf/v2/vex/2021/cve-2021-25218.json"
      }
    ],
    "title": "bind: Too strict assertion check could be triggered when responses require UDP fragmentation if RRL is in use",
    "tracking": {
      "current_release_date": "2024-08-20T01:31:30+00:00",
      "generator": {
        "date": "2024-08-20T01:31:30+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "3.32.1"
        }
      },
      "id": "CVE-2021-25218",
      "initial_release_date": "2021-08-18T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-08-18T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2022-04-17T21:34:27+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-08-20T01:31:30+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Virtualization 4",
                "product": {
                  "name": "Red Hat Virtualization 4",
                  "product_id": "red_hat_virtualization_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:rhev_hypervisor:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Virtualization 4"
          },
          {
            "category": "product_version",
            "name": "bind",
            "product": {
              "name": "bind",
              "product_id": "bind",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/bind?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "redhat-virtualization-host",
            "product": {
              "name": "redhat-virtualization-host",
              "product_id": "redhat-virtualization-host",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/redhat-virtualization-host?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "bind as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:bind"
        },
        "product_reference": "bind",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "bind as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:bind"
        },
        "product_reference": "bind",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "bind as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:bind"
        },
        "product_reference": "bind",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "bind as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:bind"
        },
        "product_reference": "bind",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "redhat-virtualization-host as a component of Red Hat Virtualization 4",
          "product_id": "red_hat_virtualization_4:redhat-virtualization-host"
        },
        "product_reference": "redhat-virtualization-host",
        "relates_to_product_reference": "red_hat_virtualization_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-25218",
      "cwe": {
        "id": "CWE-617",
        "name": "Reachable Assertion"
      },
      "discovery_date": "2021-08-18T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_6:bind",
            "red_hat_enterprise_linux_7:bind",
            "red_hat_enterprise_linux_8:bind",
            "red_hat_enterprise_linux_9:bind",
            "red_hat_virtualization_4:redhat-virtualization-host"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1995312"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in bind. An assertion failure is triggered, resulting in termination of the named server process, if named attempts to respond over UDP with a response that is larger than the current effective interface maximum transmission unit (MTU), and if response-rate limiting (RRL) is active. The highest threat from this vulnerability is to system availability.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "bind: Too strict assertion check could be triggered when responses require UDP fragmentation if RRL is in use",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "An attacker may abuse the Path MTU discovery (PMTUD) protocol to trick bind into exceeding the interface MTU. Response Rate Limiting (RRL) is not enabled by default for user defined views nor the builtin one, but it is enabled by default for the default builtin CHAOS class view, which bind uses to provide various information.\n\nThis issue did not affect the versions of bind as shipped with Red Hat Enterprise Linux 6, 7, and 8 as they provide an older version of the code which does not allow to trigger the assertion.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_6:bind",
          "red_hat_enterprise_linux_7:bind",
          "red_hat_enterprise_linux_8:bind",
          "red_hat_enterprise_linux_9:bind",
          "red_hat_virtualization_4:redhat-virtualization-host"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-25218"
        },
        {
          "category": "external",
          "summary": "RHBZ#1995312",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1995312"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-25218",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-25218"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-25218",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-25218"
        },
        {
          "category": "external",
          "summary": "https://kb.isc.org/docs/cve-2021-25218",
          "url": "https://kb.isc.org/docs/cve-2021-25218"
        }
      ],
      "release_date": "2021-08-18T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Disabling RRL in all views, including the builtin CHAOS class view, prevents the faulty assertion from being reached in the vulnerable versions of bind. To do that you can remove `rate-limit` from your named.conf files and provide a replacement for the builtin CHAOS view, like the one below:\n```\nview override_bind chaos {\n        recursion no;\n        notify no;\n        allow-new-zones no;\n        max-cache-size 2M;\n\n        zone \"version.bind\" chaos {\n                type primary;\n                database \"_builtin version\";\n        };\n        zone \"hostname.bind\" chaos {\n                type primary;\n                database \"_builtin hostname\";\n        };\n        zone \"authors.bind\" chaos {\n                type primary;\n                database \"_builtin authors\";\n        };\n        zone \"id.server\" chaos {\n                type primary;\n                database \"_builtin id\";\n        };\n};\n```",
          "product_ids": [
            "red_hat_enterprise_linux_6:bind",
            "red_hat_enterprise_linux_7:bind",
            "red_hat_enterprise_linux_8:bind",
            "red_hat_enterprise_linux_9:bind",
            "red_hat_virtualization_4:redhat-virtualization-host"
          ]
        }
      ],
      "title": "bind: Too strict assertion check could be triggered when responses require UDP fragmentation if RRL is in use"
    }
  ]
}