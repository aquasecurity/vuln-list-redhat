{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Low"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2021/cve-2021-24032.json"
      }
    ],
    "title": "zstd: Race condition allows attacker to access world-readable destination file",
    "tracking": {
      "current_release_date": "2025-02-07T20:39:04+00:00",
      "generator": {
        "date": "2025-02-07T20:39:04+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2021-24032",
      "initial_release_date": "2021-02-11T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-02-11T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-02-04T17:30:27+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-07T20:39:04+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Advanced Cluster Security 3",
                "product": {
                  "name": "Red Hat Advanced Cluster Security 3",
                  "product_id": "red_hat_advanced_cluster_security_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:advanced_cluster_security:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Advanced Cluster Security 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 3",
                "product": {
                  "name": "Red Hat Ceph Storage 3",
                  "product_id": "red_hat_ceph_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 7",
                "product": {
                  "name": "Red Hat Ceph Storage 7",
                  "product_id": "red_hat_ceph_storage_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenStack Platform 16.1",
                "product": {
                  "name": "Red Hat OpenStack Platform 16.1",
                  "product_id": "red_hat_openstack_platform_16.1",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openstack:16.1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenStack Platform 16.1"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat AMQ Streams 2.7.0",
                "product": {
                  "name": "Red Hat AMQ Streams 2.7.0",
                  "product_id": "Red Hat AMQ Streams 2.7.0",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:amq_streams:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Streams for Apache Kafka"
          },
          {
            "category": "product_version",
            "name": "rox",
            "product": {
              "name": "rox",
              "product_id": "rox",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rox?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ceph",
            "product": {
              "name": "ceph",
              "product_id": "ceph",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/ceph?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "libzstd",
            "product": {
              "name": "libzstd",
              "product_id": "libzstd",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/libzstd?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "zstd",
            "product": {
              "name": "zstd",
              "product_id": "zstd",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/zstd?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rox as a component of Red Hat Advanced Cluster Security 3",
          "product_id": "red_hat_advanced_cluster_security_3:rox"
        },
        "product_reference": "rox",
        "relates_to_product_reference": "red_hat_advanced_cluster_security_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat Ceph Storage 3",
          "product_id": "red_hat_ceph_storage_3:ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_ceph_storage_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "libzstd as a component of Red Hat Ceph Storage 7",
          "product_id": "red_hat_ceph_storage_7:libzstd"
        },
        "product_reference": "libzstd",
        "relates_to_product_reference": "red_hat_ceph_storage_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "zstd as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:zstd"
        },
        "product_reference": "zstd",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "zstd as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:zstd"
        },
        "product_reference": "zstd",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "zstd as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:zstd"
        },
        "product_reference": "zstd",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "zstd as a component of Red Hat OpenStack Platform 16.1",
          "product_id": "red_hat_openstack_platform_16.1:zstd"
        },
        "product_reference": "zstd",
        "relates_to_product_reference": "red_hat_openstack_platform_16.1"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-24032",
      "cwe": {
        "id": "CWE-281",
        "name": "Improper Preservation of Permissions"
      },
      "discovery_date": "2021-02-12T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_9:zstd",
            "red_hat_openstack_platform_16.1:zstd"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1928090"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in zstd. While the final file mode is reflective of the input file, when compressing or uncompressing, the file can temporarily gain greater permissions than the input and potentially leading to security issues (especially if large files are being handled).",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "zstd: Race condition allows attacker to access world-readable destination file",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "In OpenShift Container Platform (OCP) the zstd package was delivered in OCP 4.3 which is already end of life.\n\nThis vulnerability can be considered low severity rather than moderate due to the fact that the elevated file permissions are only temporary and only exist during the compression or decompression process. Once the operation completes, the file permissions revert to their intended state, mirroring those of the input file. The risk is further minimized by the fact that the exposure window is brief, and the elevated permissions are not persistent. Additionally, the issue only arises during the processing of files, and only those with larger sizes or more involved operations would be at risk.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "fixed": [
          "Red Hat AMQ Streams 2.7.0"
        ],
        "known_affected": [
          "red_hat_advanced_cluster_security_3:rox",
          "red_hat_ceph_storage_3:ceph",
          "red_hat_ceph_storage_7:libzstd",
          "red_hat_enterprise_linux_8:zstd",
          "red_hat_openshift_container_platform_4:zstd"
        ],
        "known_not_affected": [
          "red_hat_enterprise_linux_9:zstd",
          "red_hat_openstack_platform_16.1:zstd"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-24032"
        },
        {
          "category": "external",
          "summary": "RHBZ#1928090",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1928090"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-24032",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-24032"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-24032",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-24032"
        }
      ],
      "release_date": "2021-02-11T00:00:00+00:00",
      "remediations": [
        {
          "category": "vendor_fix",
          "date": "2024-05-30T20:24:46+00:00",
          "details": "Before applying this update, make sure all previously released errata\nrelevant to your system have been applied.\n\nFor details on how to apply this update, refer to:\n\nhttps://access.redhat.com/articles/11258",
          "product_ids": [
            "Red Hat AMQ Streams 2.7.0"
          ],
          "url": "https://access.redhat.com/errata/RHSA-2024:3527"
        },
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "red_hat_openshift_container_platform_4:zstd"
          ]
        },
        {
          "category": "none_available",
          "details": "Fix deferred",
          "product_ids": [
            "red_hat_enterprise_linux_8:zstd"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_advanced_cluster_security_3:rox",
            "red_hat_ceph_storage_3:ceph",
            "red_hat_ceph_storage_7:libzstd"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.5,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "Red Hat AMQ Streams 2.7.0",
            "red_hat_advanced_cluster_security_3:rox",
            "red_hat_ceph_storage_3:ceph",
            "red_hat_ceph_storage_7:libzstd",
            "red_hat_enterprise_linux_8:zstd",
            "red_hat_enterprise_linux_9:zstd",
            "red_hat_openshift_container_platform_4:zstd",
            "red_hat_openstack_platform_16.1:zstd"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "Red Hat AMQ Streams 2.7.0",
            "red_hat_advanced_cluster_security_3:rox",
            "red_hat_ceph_storage_3:ceph",
            "red_hat_ceph_storage_7:libzstd",
            "red_hat_enterprise_linux_8:zstd",
            "red_hat_enterprise_linux_9:zstd",
            "red_hat_openshift_container_platform_4:zstd",
            "red_hat_openstack_platform_16.1:zstd"
          ]
        }
      ],
      "title": "zstd: Race condition allows attacker to access world-readable destination file"
    }
  ]
}