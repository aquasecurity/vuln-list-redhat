{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2021/cve-2021-31805.json"
      }
    ],
    "title": "Struts: Forced OGNL evaluation, when evaluated on raw not validated user input in tag attributes, may lead to RCE.",
    "tracking": {
      "current_release_date": "2025-02-06T07:34:07+00:00",
      "generator": {
        "date": "2025-02-06T07:34:07+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2021-31805",
      "initial_release_date": "2021-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-02-27T13:56:45+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-06T07:34:07+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Fuse 6",
                "product": {
                  "name": "Red Hat JBoss Fuse 6",
                  "product_id": "red_hat_jboss_fuse_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_fuse:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Fuse 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Fuse Service Works 6",
                "product": {
                  "name": "Red Hat JBoss Fuse Service Works 6",
                  "product_id": "red_hat_jboss_fuse_service_works_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Fuse Service Works 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Operations Network 3",
                "product": {
                  "name": "Red Hat JBoss Operations Network 3",
                  "product_id": "red_hat_jboss_operations_network_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_operations_network:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Operations Network 3"
          },
          {
            "category": "product_version",
            "name": "struts",
            "product": {
              "name": "struts",
              "product_id": "struts"
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "struts as a component of Red Hat JBoss Fuse 6",
          "product_id": "red_hat_jboss_fuse_6:struts"
        },
        "product_reference": "struts",
        "relates_to_product_reference": "red_hat_jboss_fuse_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "struts as a component of Red Hat JBoss Fuse Service Works 6",
          "product_id": "red_hat_jboss_fuse_service_works_6:struts"
        },
        "product_reference": "struts",
        "relates_to_product_reference": "red_hat_jboss_fuse_service_works_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "struts as a component of Red Hat JBoss Operations Network 3",
          "product_id": "red_hat_jboss_operations_network_3:struts"
        },
        "product_reference": "struts",
        "relates_to_product_reference": "red_hat_jboss_operations_network_3"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-31805",
      "cwe": {
        "id": "CWE-917",
        "name": "Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')"
      },
      "discovery_date": "2022-04-13T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_jboss_fuse_6:struts",
            "red_hat_jboss_fuse_service_works_6:struts",
            "red_hat_jboss_operations_network_3:struts"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2074788"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "The fix issued for CVE-2020-17530 was incomplete. So from Apache Struts 2.0.0 to 2.5.29, still some of the tag’s attributes could perform a double evaluation if a developer applied forced OGNL evaluation by using the %{...} syntax. Using forced OGNL evaluation on untrusted user input can lead to a Remote Code Execution and security degradation.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "Struts: Forced OGNL evaluation, when evaluated on raw not validated user input in tag attributes, may lead to RCE.",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Apache Struts2 is not compiled, shipped, used, or enabled in Red Hat products. As such, any CVE against Apache Struts2 does not impact currently supported Red Hat products.\n\nThis statement was last revised on 1 Sept 2020.\n\nPrevious statement example: https://bugzilla.redhat.com/show_bug.cgi?id=1469265",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_jboss_fuse_6:struts",
          "red_hat_jboss_fuse_service_works_6:struts",
          "red_hat_jboss_operations_network_3:struts"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-31805"
        },
        {
          "category": "external",
          "summary": "RHBZ#2074788",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2074788"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-31805",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-31805"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-31805",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-31805"
        }
      ],
      "release_date": "2022-04-12T00:00:00+00:00",
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.1,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_jboss_fuse_6:struts",
            "red_hat_jboss_fuse_service_works_6:struts",
            "red_hat_jboss_operations_network_3:struts"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "red_hat_jboss_fuse_6:struts",
            "red_hat_jboss_fuse_service_works_6:struts",
            "red_hat_jboss_operations_network_3:struts"
          ]
        }
      ],
      "title": "Struts: Forced OGNL evaluation, when evaluated on raw not validated user input in tag attributes, may lead to RCE."
    }
  ]
}