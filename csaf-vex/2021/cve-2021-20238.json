{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2021/cve-2021-20238.json"
      }
    ],
    "title": "openshift/machine-config-operator: unauthenticated access to Machine Config Server ignition config",
    "tracking": {
      "current_release_date": "2024-12-05T17:38:00+00:00",
      "generator": {
        "date": "2024-12-05T17:38:00+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.2"
        }
      },
      "id": "CVE-2021-20238",
      "initial_release_date": "2021-02-05T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-02-05T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-08-28T17:22:28+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-12-05T17:38:00+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 3.11",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 3.11",
                  "product_id": "red_hat_openshift_container_platform_3.11",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:3.11"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 3.11"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "atomic-openshift",
            "product": {
              "name": "atomic-openshift",
              "product_id": "atomic-openshift",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/atomic-openshift?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-machine-config-operator",
            "product": {
              "name": "openshift4/ose-machine-config-operator",
              "product_id": "openshift4/ose-machine-config-operator",
              "product_identification_helper": {
                "purl": "pkg:oci/ose-machine-config-operator?repository_url=registry.redhat.io/openshift4/ose-machine-config-operator"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "atomic-openshift as a component of Red Hat OpenShift Container Platform 3.11",
          "product_id": "red_hat_openshift_container_platform_3.11:atomic-openshift"
        },
        "product_reference": "atomic-openshift",
        "relates_to_product_reference": "red_hat_openshift_container_platform_3.11"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-machine-config-operator as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-machine-config-operator"
        },
        "product_reference": "openshift4/ose-machine-config-operator",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-20238",
      "cwe": {
        "id": "CWE-306",
        "name": "Missing Authentication for Critical Function"
      },
      "discovery_date": "2020-02-07T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_openshift_container_platform_3.11:atomic-openshift"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1926568"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "It was found in OpenShift Container Platform 4 that ignition config, served by the Machine Config Server, can be accessed externally from clusters without authentication. The MCS endpoint (port 22623) provides ignition configuration used for bootstrapping Nodes and can include some sensitive data, e.g. registry pull secrets.\r\n\r\nThere are two scenarios where this data can be accessed. The first is on Baremetal, OpenStack, Ovirt, Vsphere and KubeVirt deployments which do not have a separate internal API endpoint and allow access from outside the cluster to port 22623 from the standard OpenShift API Virtual IP address.\r\n\r\nThe second is on cloud deployments when using unsupported network plugins, which do not create iptables rules that prevent to port 22623. In this scenario, the ignition config is exposed to all pods within the cluster and cannot be accessed externally.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "openshift/machine-config-operator: unauthenticated access to Machine Config Server ignition config",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Currently, there is no supported way to block or restrict the machine config server endpoint. The machine config server must be exposed to the network so that newly-provisioned machines, which have no existing configuration or state, are able to fetch their configuration. In this model, the root of trust is the certificate signing requests (CSR) endpoint, which is where the kubelet sends its certificate signing request for approval to join the cluster. Because of this, machine configs should not be used to distribute sensitive information, such as secrets and certificates.\n\nTo ensure that the machine config server endpoints, ports 22623 and 22624, are secured in bare metal scenarios, customers must configure proper network policies.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_openshift_container_platform_4:openshift4/ose-machine-config-operator"
        ],
        "known_not_affected": [
          "red_hat_openshift_container_platform_3.11:atomic-openshift"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-20238"
        },
        {
          "category": "external",
          "summary": "RHBZ#1926568",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1926568"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-20238",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-20238"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-20238",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-20238"
        }
      ],
      "release_date": "2021-02-05T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "- If deployed on Baremetal, OpenStack, Ovirt, Vsphere or KubeVirt, check if the ignition config is accessible from outside the cluster, e.g.\n   \nhttps://api.$cluster_name.$base_domain:22623/config/worker\n  \nPrevent access to this endpoint with an external firewall or load balancer.\n\n- To protect the MCS endpoint within clusters, use a supported network plugin with OpenShift, namely: OpenShift SDN, OVN Kubernetes or kuryr.\n\n- Ensure untrusted workloads are not run with hostNetwork access.",
          "product_ids": [
            "red_hat_openshift_container_platform_3.11:atomic-openshift",
            "red_hat_openshift_container_platform_4:openshift4/ose-machine-config-operator"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_openshift_container_platform_4:openshift4/ose-machine-config-operator"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "LOW",
            "baseScore": 5.6,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_openshift_container_platform_3.11:atomic-openshift",
            "red_hat_openshift_container_platform_4:openshift4/ose-machine-config-operator"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_openshift_container_platform_3.11:atomic-openshift",
            "red_hat_openshift_container_platform_4:openshift4/ose-machine-config-operator"
          ]
        }
      ],
      "title": "openshift/machine-config-operator: unauthenticated access to Machine Config Server ignition config"
    }
  ]
}