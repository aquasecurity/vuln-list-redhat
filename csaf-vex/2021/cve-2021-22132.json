{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2021/cve-2021-22132.json"
      }
    ],
    "title": "elasticsearch: executing async search improperly stores HTTP headers leading to information disclosure",
    "tracking": {
      "current_release_date": "2024-11-22T19:49:31+00:00",
      "generator": {
        "date": "2024-11-22T19:49:31+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2021-22132",
      "initial_release_date": "2021-01-14T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-01-14T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2022-09-09T07:12:16+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-22T19:49:31+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Decision Manager 7",
                "product": {
                  "name": "Red Hat Decision Manager 7",
                  "product_id": "red_hat_decision_manager_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Decision Manager 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Fuse 7",
                "product": {
                  "name": "Red Hat Fuse 7",
                  "product_id": "red_hat_fuse_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_fuse:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Fuse 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Fuse 6",
                "product": {
                  "name": "Red Hat JBoss Fuse 6",
                  "product_id": "red_hat_jboss_fuse_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_fuse:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Fuse 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 3.11",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 3.11",
                  "product_id": "red_hat_openshift_container_platform_3.11",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:3.11"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 3.11"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Process Automation 7",
                "product": {
                  "name": "Red Hat Process Automation 7",
                  "product_id": "red_hat_process_automation_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Process Automation 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "RHAF Camel-K 1.8",
                "product": {
                  "name": "RHAF Camel-K 1.8",
                  "product_id": "RHAF Camel-K 1.8",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:integration:1"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "RHINT Camel-Q 2.7",
                "product": {
                  "name": "RHINT Camel-Q 2.7",
                  "product_id": "RHINT Camel-Q 2.7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:camel_quarkus:2.7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Integration"
          },
          {
            "category": "product_version",
            "name": "elasticsearch",
            "product": {
              "name": "elasticsearch",
              "product_id": "elasticsearch"
            }
          },
          {
            "category": "product_version",
            "name": "openshift3/ose-logging-elasticsearch5",
            "product": {
              "name": "openshift3/ose-logging-elasticsearch5",
              "product_id": "openshift3/ose-logging-elasticsearch5",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift3/ose-logging-elasticsearch5"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-logging-elasticsearch5",
            "product": {
              "name": "openshift4/ose-logging-elasticsearch5",
              "product_id": "openshift4/ose-logging-elasticsearch5",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift4/ose-logging-elasticsearch5"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-logging-elasticsearch6",
            "product": {
              "name": "openshift4/ose-logging-elasticsearch6",
              "product_id": "openshift4/ose-logging-elasticsearch6",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift4/ose-logging-elasticsearch6"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "elasticsearch as a component of Red Hat Decision Manager 7",
          "product_id": "red_hat_decision_manager_7:elasticsearch"
        },
        "product_reference": "elasticsearch",
        "relates_to_product_reference": "red_hat_decision_manager_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "elasticsearch as a component of Red Hat Fuse 7",
          "product_id": "red_hat_fuse_7:elasticsearch"
        },
        "product_reference": "elasticsearch",
        "relates_to_product_reference": "red_hat_fuse_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "elasticsearch as a component of Red Hat JBoss Fuse 6",
          "product_id": "red_hat_jboss_fuse_6:elasticsearch"
        },
        "product_reference": "elasticsearch",
        "relates_to_product_reference": "red_hat_jboss_fuse_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift3/ose-logging-elasticsearch5 as a component of Red Hat OpenShift Container Platform 3.11",
          "product_id": "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5"
        },
        "product_reference": "openshift3/ose-logging-elasticsearch5",
        "relates_to_product_reference": "red_hat_openshift_container_platform_3.11"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-logging-elasticsearch5 as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-logging-elasticsearch5"
        },
        "product_reference": "openshift4/ose-logging-elasticsearch5",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-logging-elasticsearch6 as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-logging-elasticsearch6"
        },
        "product_reference": "openshift4/ose-logging-elasticsearch6",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "elasticsearch as a component of Red Hat Process Automation 7",
          "product_id": "red_hat_process_automation_7:elasticsearch"
        },
        "product_reference": "elasticsearch",
        "relates_to_product_reference": "red_hat_process_automation_7"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-22132",
      "cwe": {
        "id": "CWE-522",
        "name": "Insufficiently Protected Credentials"
      },
      "discovery_date": "2021-02-01T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5",
            "red_hat_openshift_container_platform_4:openshift4/ose-logging-elasticsearch5",
            "red_hat_openshift_container_platform_4:openshift4/ose-logging-elasticsearch6"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1923181"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Elasticsearch versions 7.7.0 to 7.10.1 contain an information disclosure flaw in the async search API. Users who execute an async search will improperly store the HTTP headers. An Elasticsearch user with the ability to read the .tasks index could obtain sensitive request headers of other users in the cluster. This issue is fixed in Elasticsearch 7.10.2",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "elasticsearch: executing async search improperly stores HTTP headers leading to information disclosure",
          "title": "Vulnerability summary"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "fixed": [
          "RHAF Camel-K 1.8",
          "RHINT Camel-Q 2.7"
        ],
        "known_affected": [
          "red_hat_decision_manager_7:elasticsearch",
          "red_hat_fuse_7:elasticsearch",
          "red_hat_jboss_fuse_6:elasticsearch",
          "red_hat_process_automation_7:elasticsearch"
        ],
        "known_not_affected": [
          "red_hat_openshift_container_platform_3.11:openshift3/ose-logging-elasticsearch5",
          "red_hat_openshift_container_platform_4:openshift4/ose-logging-elasticsearch5",
          "red_hat_openshift_container_platform_4:openshift4/ose-logging-elasticsearch6"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-22132"
        },
        {
          "category": "external",
          "summary": "RHBZ#1923181",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1923181"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-22132",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-22132"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-22132",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-22132"
        },
        {
          "category": "external",
          "summary": "https://discuss.elastic.co/t/elasticsearch-7-10-2-security-update/261164",
          "url": "https://discuss.elastic.co/t/elasticsearch-7-10-2-security-update/261164"
        }
      ],
      "release_date": "2021-01-14T00:00:00+00:00",
      "remediations": [
        {
          "category": "vendor_fix",
          "date": "2022-09-09T07:12:07+00:00",
          "details": "Before applying this update, make sure all previously released errata relevant to your system have been applied.\n\nFor details on how to apply this update, refer to:\n\nhttps://access.redhat.com/articles/11258",
          "product_ids": [
            "RHAF Camel-K 1.8"
          ],
          "url": "https://access.redhat.com/errata/RHSA-2022:6407"
        },
        {
          "category": "vendor_fix",
          "date": "2022-07-19T13:40:02+00:00",
          "details": "For details on how to apply this update, which includes the changes described in this advisory, refer to:\n\nhttps://access.redhat.com/articles/11258",
          "product_ids": [
            "RHINT Camel-Q 2.7"
          ],
          "url": "https://access.redhat.com/errata/RHSA-2022:5606"
        },
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "red_hat_jboss_fuse_6:elasticsearch"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_decision_manager_7:elasticsearch",
            "red_hat_fuse_7:elasticsearch",
            "red_hat_process_automation_7:elasticsearch"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.8,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "RHAF Camel-K 1.8",
            "RHINT Camel-Q 2.7",
            "red_hat_decision_manager_7:elasticsearch",
            "red_hat_fuse_7:elasticsearch",
            "red_hat_jboss_fuse_6:elasticsearch",
            "red_hat_process_automation_7:elasticsearch"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_decision_manager_7:elasticsearch",
            "red_hat_jboss_fuse_6:elasticsearch",
            "red_hat_process_automation_7:elasticsearch"
          ]
        },
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "RHAF Camel-K 1.8",
            "RHINT Camel-Q 2.7",
            "red_hat_fuse_7:elasticsearch"
          ]
        }
      ],
      "title": "elasticsearch: executing async search improperly stores HTTP headers leading to information disclosure"
    }
  ]
}