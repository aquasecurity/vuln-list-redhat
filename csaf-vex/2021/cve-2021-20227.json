{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2021/cve-2021-20227.json"
      }
    ],
    "title": "sqlite: potential use-after-free bug when processing  a subquery with both a correlated WHERE clause and a \"HAVING 0\" clause and where the parent query is an aggregate",
    "tracking": {
      "current_release_date": "2025-01-08T02:35:15+00:00",
      "generator": {
        "date": "2025-01-08T02:35:15+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.5"
        }
      },
      "id": "CVE-2021-20227",
      "initial_release_date": "2021-01-21T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-01-21T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2021-05-27T17:32:03+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-08T02:35:15+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "category": "product_version",
            "name": "sqlite",
            "product": {
              "name": "sqlite",
              "product_id": "sqlite",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/sqlite?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "sqlite as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:sqlite"
        },
        "product_reference": "sqlite",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "sqlite as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:sqlite"
        },
        "product_reference": "sqlite",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "sqlite as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:sqlite"
        },
        "product_reference": "sqlite",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "sqlite as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:sqlite"
        },
        "product_reference": "sqlite",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-20227",
      "cwe": {
        "id": "CWE-416",
        "name": "Use After Free"
      },
      "discovery_date": "2021-02-03T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_6:sqlite",
            "red_hat_enterprise_linux_7:sqlite",
            "red_hat_enterprise_linux_8:sqlite",
            "red_hat_enterprise_linux_9:sqlite"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1924886"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in SQLite's SELECT query functionality (src/select.c). This flaw allows an attacker who is capable of running SQL queries locally on the SQLite database to cause a denial of service or possible code execution by triggering a use-after-free. The highest threat from this vulnerability is to system availability.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "sqlite: potential use-after-free bug when processing  a subquery with both a correlated WHERE clause and a \"HAVING 0\" clause and where the parent query is an aggregate",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "SQLite as shipped in Red Hat Enterprise Linux 6, 7 and 8 is not affected by this flaw as the code was introduced in a newer version of SQLite than that shipped. This flaw has been marked Moderate because in order to run such a query, a user would need to already have access to query the data in the database.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_6:sqlite",
          "red_hat_enterprise_linux_7:sqlite",
          "red_hat_enterprise_linux_8:sqlite",
          "red_hat_enterprise_linux_9:sqlite"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-20227"
        },
        {
          "category": "external",
          "summary": "RHBZ#1924886",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1924886"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-20227",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-20227"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-20227",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-20227"
        },
        {
          "category": "external",
          "summary": "https://www.sqlite.org/releaselog/3_34_1.html",
          "url": "https://www.sqlite.org/releaselog/3_34_1.html"
        }
      ],
      "release_date": "2021-01-21T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
          "product_ids": [
            "red_hat_enterprise_linux_6:sqlite",
            "red_hat_enterprise_linux_7:sqlite",
            "red_hat_enterprise_linux_8:sqlite",
            "red_hat_enterprise_linux_9:sqlite"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "LOW",
            "availabilityImpact": "HIGH",
            "baseScore": 6.1,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_enterprise_linux_6:sqlite",
            "red_hat_enterprise_linux_7:sqlite",
            "red_hat_enterprise_linux_8:sqlite",
            "red_hat_enterprise_linux_9:sqlite"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_enterprise_linux_6:sqlite",
            "red_hat_enterprise_linux_7:sqlite",
            "red_hat_enterprise_linux_8:sqlite",
            "red_hat_enterprise_linux_9:sqlite"
          ]
        }
      ],
      "title": "sqlite: potential use-after-free bug when processing  a subquery with both a correlated WHERE clause and a \"HAVING 0\" clause and where the parent query is an aggregate"
    }
  ]
}