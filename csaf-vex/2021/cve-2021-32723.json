{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2021/cve-2021-32723.json"
      }
    ],
    "title": "npm-prismjs: a malicious (long) string will take a long time to highlight may result in ReDoS",
    "tracking": {
      "current_release_date": "2025-02-06T23:59:36+00:00",
      "generator": {
        "date": "2025-02-06T23:59:36+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2021-32723",
      "initial_release_date": "2021-06-28T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2021-06-28T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-09-01T00:37:40+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-06T23:59:36+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 1",
                "product": {
                  "name": "OpenShift Service Mesh 1",
                  "product_id": "openshift_service_mesh_1",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 1"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 2.0",
                "product": {
                  "name": "OpenShift Service Mesh 2.0",
                  "product_id": "openshift_service_mesh_2.0",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:2.0"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 2.0"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Advanced Cluster Security 3",
                "product": {
                  "name": "Red Hat Advanced Cluster Security 3",
                  "product_id": "red_hat_advanced_cluster_security_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:advanced_cluster_security:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Advanced Cluster Security 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 3",
                "product": {
                  "name": "Red Hat Ceph Storage 3",
                  "product_id": "red_hat_ceph_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 4",
                "product": {
                  "name": "Red Hat Ceph Storage 4",
                  "product_id": "red_hat_ceph_storage_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 4"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 3.11",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 3.11",
                  "product_id": "red_hat_openshift_container_platform_3.11",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:3.11"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 3.11"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "servicemesh-grafana",
            "product": {
              "name": "servicemesh-grafana",
              "product_id": "servicemesh-grafana",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/servicemesh-grafana?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rox",
            "product": {
              "name": "rox",
              "product_id": "rox",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rox?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "grafana",
            "product": {
              "name": "grafana",
              "product_id": "grafana",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/grafana?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rhceph/rhceph-4-dashboard-rhel8",
            "product": {
              "name": "rhceph/rhceph-4-dashboard-rhel8",
              "product_id": "rhceph/rhceph-4-dashboard-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/rhceph-4-dashboard-rhel8?repository_url=registry.redhat.io/rhceph/rhceph-4-dashboard-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift3/grafana",
            "product": {
              "name": "openshift3/grafana",
              "product_id": "openshift3/grafana",
              "product_identification_helper": {
                "purl": "pkg:oci/grafana?repository_url=registry.redhat.io/openshift3/grafana"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-grafana",
            "product": {
              "name": "openshift4/ose-grafana",
              "product_id": "openshift4/ose-grafana",
              "product_identification_helper": {
                "purl": "pkg:oci/ose-grafana?repository_url=registry.redhat.io/openshift4/ose-grafana"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "servicemesh-grafana as a component of OpenShift Service Mesh 1",
          "product_id": "openshift_service_mesh_1:servicemesh-grafana"
        },
        "product_reference": "servicemesh-grafana",
        "relates_to_product_reference": "openshift_service_mesh_1"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "servicemesh-grafana as a component of OpenShift Service Mesh 2.0",
          "product_id": "openshift_service_mesh_2.0:servicemesh-grafana"
        },
        "product_reference": "servicemesh-grafana",
        "relates_to_product_reference": "openshift_service_mesh_2.0"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rox as a component of Red Hat Advanced Cluster Security 3",
          "product_id": "red_hat_advanced_cluster_security_3:rox"
        },
        "product_reference": "rox",
        "relates_to_product_reference": "red_hat_advanced_cluster_security_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as a component of Red Hat Ceph Storage 3",
          "product_id": "red_hat_ceph_storage_3:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "red_hat_ceph_storage_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rhceph/rhceph-4-dashboard-rhel8 as a component of Red Hat Ceph Storage 4",
          "product_id": "red_hat_ceph_storage_4:rhceph/rhceph-4-dashboard-rhel8"
        },
        "product_reference": "rhceph/rhceph-4-dashboard-rhel8",
        "relates_to_product_reference": "red_hat_ceph_storage_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift3/grafana as a component of Red Hat OpenShift Container Platform 3.11",
          "product_id": "red_hat_openshift_container_platform_3.11:openshift3/grafana"
        },
        "product_reference": "openshift3/grafana",
        "relates_to_product_reference": "red_hat_openshift_container_platform_3.11"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-grafana as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-grafana"
        },
        "product_reference": "openshift4/ose-grafana",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2021-32723",
      "cwe": {
        "id": "CWE-400",
        "name": "Uncontrolled Resource Consumption"
      },
      "discovery_date": "2021-06-29T00:00:00+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1980286"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in npm-prismjs. An attacker can craft a string that will take a  very long time to highlight when used to work with un-trusted text resulting in ReDoS.\r\n\r\nThis can affect the system availability. There is no known risk of privilege escalation on data compromise.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "npm-prismjs: a malicious (long) string will take a long time to highlight may result in ReDoS",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "In OpenShift Container Platform (OCP) the affected grafana container is behind OpenShift OAuth authentication. This restricts access to the vulnerable nodejs-prismjs library to authenticated users only, therefore the impact is low.\n\nAdditionally, OCP 3.11 and OpenShift Service Mesh 1.1.x are in maintenance support for low and moderate impact vulnerabilities, hence the OCP 3.11 and OSSM 1.1 grafana containers have been set OOSS.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "openshift_service_mesh_1:servicemesh-grafana",
          "openshift_service_mesh_2.0:servicemesh-grafana",
          "red_hat_advanced_cluster_security_3:rox",
          "red_hat_ceph_storage_3:grafana",
          "red_hat_ceph_storage_4:rhceph/rhceph-4-dashboard-rhel8",
          "red_hat_openshift_container_platform_3.11:openshift3/grafana",
          "red_hat_openshift_container_platform_4:openshift4/ose-grafana"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2021-32723"
        },
        {
          "category": "external",
          "summary": "RHBZ#1980286",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1980286"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2021-32723",
          "url": "https://www.cve.org/CVERecord?id=CVE-2021-32723"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2021-32723",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-32723"
        },
        {
          "category": "external",
          "summary": "https://github.com/PrismJS/prism/security/advisories/GHSA-gj77-59wh-66hg",
          "url": "https://github.com/PrismJS/prism/security/advisories/GHSA-gj77-59wh-66hg"
        }
      ],
      "release_date": "2021-06-28T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "As a workaround, do not use ASCIIDoc or ERB to highlight untrusted text.",
          "product_ids": [
            "openshift_service_mesh_1:servicemesh-grafana",
            "openshift_service_mesh_2.0:servicemesh-grafana",
            "red_hat_advanced_cluster_security_3:rox",
            "red_hat_ceph_storage_3:grafana",
            "red_hat_ceph_storage_4:rhceph/rhceph-4-dashboard-rhel8",
            "red_hat_openshift_container_platform_3.11:openshift3/grafana",
            "red_hat_openshift_container_platform_4:openshift4/ose-grafana"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "openshift_service_mesh_1:servicemesh-grafana",
            "red_hat_ceph_storage_3:grafana",
            "red_hat_openshift_container_platform_3.11:openshift3/grafana"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "openshift_service_mesh_2.0:servicemesh-grafana",
            "red_hat_openshift_container_platform_4:openshift4/ose-grafana"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_advanced_cluster_security_3:rox",
            "red_hat_ceph_storage_4:rhceph/rhceph-4-dashboard-rhel8"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "openshift_service_mesh_1:servicemesh-grafana",
            "openshift_service_mesh_2.0:servicemesh-grafana",
            "red_hat_advanced_cluster_security_3:rox",
            "red_hat_ceph_storage_3:grafana",
            "red_hat_ceph_storage_4:rhceph/rhceph-4-dashboard-rhel8",
            "red_hat_openshift_container_platform_3.11:openshift3/grafana",
            "red_hat_openshift_container_platform_4:openshift4/ose-grafana"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "openshift_service_mesh_1:servicemesh-grafana",
            "openshift_service_mesh_2.0:servicemesh-grafana",
            "red_hat_advanced_cluster_security_3:rox",
            "red_hat_ceph_storage_3:grafana",
            "red_hat_ceph_storage_4:rhceph/rhceph-4-dashboard-rhel8"
          ]
        },
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "red_hat_openshift_container_platform_3.11:openshift3/grafana",
            "red_hat_openshift_container_platform_4:openshift4/ose-grafana"
          ]
        }
      ],
      "title": "npm-prismjs: a malicious (long) string will take a long time to highlight may result in ReDoS"
    }
  ]
}