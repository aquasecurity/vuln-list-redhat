{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-39135.json"
      }
    ],
    "title": "calcite: XXE via SQL operators",
    "tracking": {
      "current_release_date": "2025-03-16T07:24:15+00:00",
      "generator": {
        "date": "2025-03-16T07:24:15+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.4.1"
        }
      },
      "id": "CVE-2022-39135",
      "initial_release_date": "2022-09-11T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-09-11T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-02-01T03:42:13+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-03-16T07:24:15+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Data Grid 8",
                "product": {
                  "name": "Red Hat Data Grid 8",
                  "product_id": "red_hat_data_grid_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_data_grid:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Data Grid 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Fuse 7",
                "product": {
                  "name": "Red Hat Fuse 7",
                  "product_id": "red_hat_fuse_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_fuse:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Fuse 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Integration Camel K 1",
                "product": {
                  "name": "Red Hat Integration Camel K 1",
                  "product_id": "red_hat_integration_camel_k_1",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:integration:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Integration Camel K 1"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Data Grid 7",
                "product": {
                  "name": "Red Hat JBoss Data Grid 7",
                  "product_id": "red_hat_jboss_data_grid_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_data_grid:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Data Grid 7"
          },
          {
            "category": "product_version",
            "name": "calcite",
            "product": {
              "name": "calcite",
              "product_id": "calcite"
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "calcite as a component of Red Hat Data Grid 8",
          "product_id": "red_hat_data_grid_8:calcite"
        },
        "product_reference": "calcite",
        "relates_to_product_reference": "red_hat_data_grid_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "calcite as a component of Red Hat Fuse 7",
          "product_id": "red_hat_fuse_7:calcite"
        },
        "product_reference": "calcite",
        "relates_to_product_reference": "red_hat_fuse_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "calcite as a component of Red Hat Integration Camel K 1",
          "product_id": "red_hat_integration_camel_k_1:calcite"
        },
        "product_reference": "calcite",
        "relates_to_product_reference": "red_hat_integration_camel_k_1"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "calcite as a component of Red Hat JBoss Data Grid 7",
          "product_id": "red_hat_jboss_data_grid_7:calcite"
        },
        "product_reference": "calcite",
        "relates_to_product_reference": "red_hat_jboss_data_grid_7"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-39135",
      "cwe": {
        "id": "CWE-611",
        "name": "Improper Restriction of XML External Entity Reference"
      },
      "discovery_date": "2022-09-13T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_data_grid_8:calcite",
            "red_hat_integration_camel_k_1:calcite",
            "red_hat_jboss_data_grid_7:calcite"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2126543"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Apache Calcite 1.22.0 introduced the SQL operators EXISTS_NODE, EXTRACT_XML, XML_TRANSFORM and EXTRACT_VALUE do not restrict XML External Entity references in their configuration, making them vulnerable to a potential XML External Entity (XXE) attack. Therefore any client exposing these operators, typically by using Oracle dialect (the first three) or MySQL dialect (the last one), is affected by this vulnerability (the extent of it will depend on the user under which the application is running). From Apache Calcite 1.32.0 onwards, Document Type Declarations and XML External Entity resolution are disabled on the impacted operators.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "calcite: XXE via SQL operators",
          "title": "Vulnerability summary"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_fuse_7:calcite"
        ],
        "known_not_affected": [
          "red_hat_data_grid_8:calcite",
          "red_hat_integration_camel_k_1:calcite",
          "red_hat_jboss_data_grid_7:calcite"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-39135"
        },
        {
          "category": "external",
          "summary": "RHBZ#2126543",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2126543"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-39135",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-39135"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-39135",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-39135"
        },
        {
          "category": "external",
          "summary": "https://lists.apache.org/thread/ohdnhlgm6jvt3srw8l7spkm2d5vwm082",
          "url": "https://lists.apache.org/thread/ohdnhlgm6jvt3srw8l7spkm2d5vwm082"
        }
      ],
      "release_date": "2022-09-11T00:00:00+00:00",
      "remediations": [
        {
          "category": "none_available",
          "details": "Fix deferred",
          "product_ids": [
            "red_hat_fuse_7:calcite"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_data_grid_8:calcite",
            "red_hat_fuse_7:calcite",
            "red_hat_integration_camel_k_1:calcite",
            "red_hat_jboss_data_grid_7:calcite"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_data_grid_8:calcite",
            "red_hat_integration_camel_k_1:calcite",
            "red_hat_jboss_data_grid_7:calcite"
          ]
        },
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "red_hat_fuse_7:calcite"
          ]
        }
      ],
      "title": "calcite: XXE via SQL operators"
    }
  ]
}