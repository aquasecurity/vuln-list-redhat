{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-38150.json"
      }
    ],
    "title": "varnish: denial of service via colon-starting reason phrase",
    "tracking": {
      "current_release_date": "2025-02-07T01:01:12+00:00",
      "generator": {
        "date": "2025-02-07T01:01:12+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2022-38150",
      "initial_release_date": "2022-08-09T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-08-09T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2022-09-01T23:55:55+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-07T01:01:12+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Software Collections",
                "product": {
                  "name": "Red Hat Software Collections",
                  "product_id": "red_hat_software_collections",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:rhel_software_collections:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Software Collections"
          },
          {
            "category": "product_version",
            "name": "varnish:6/varnish",
            "product": {
              "name": "varnish:6/varnish",
              "product_id": "varnish:6/varnish",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/varnish@6"
              }
            }
          },
          {
            "category": "product_version",
            "name": "varnish:6/varnish-modules",
            "product": {
              "name": "varnish:6/varnish-modules",
              "product_id": "varnish:6/varnish-modules",
              "product_identification_helper": {
                "purl": "pkg:rpmmod/redhat/varnish@6"
              }
            }
          },
          {
            "category": "product_version",
            "name": "varnish-modules",
            "product": {
              "name": "varnish-modules",
              "product_id": "varnish-modules",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/varnish-modules?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "varnish",
            "product": {
              "name": "varnish",
              "product_id": "varnish",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/varnish?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rh-varnish6-jemalloc",
            "product": {
              "name": "rh-varnish6-jemalloc",
              "product_id": "rh-varnish6-jemalloc",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rh-varnish6-jemalloc?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rh-varnish6-varnish",
            "product": {
              "name": "rh-varnish6-varnish",
              "product_id": "rh-varnish6-varnish",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rh-varnish6-varnish?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "rh-varnish6-varnish-modules",
            "product": {
              "name": "rh-varnish6-varnish-modules",
              "product_id": "rh-varnish6-varnish-modules",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/rh-varnish6-varnish-modules?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "varnish-modules as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:varnish-modules"
        },
        "product_reference": "varnish-modules",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "varnish:6/varnish as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:varnish:6/varnish"
        },
        "product_reference": "varnish:6/varnish",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "varnish:6/varnish-modules as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:varnish:6/varnish-modules"
        },
        "product_reference": "varnish:6/varnish-modules",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "varnish as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:varnish"
        },
        "product_reference": "varnish",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "varnish-modules as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:varnish-modules"
        },
        "product_reference": "varnish-modules",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rh-varnish6-jemalloc as a component of Red Hat Software Collections",
          "product_id": "red_hat_software_collections:rh-varnish6-jemalloc"
        },
        "product_reference": "rh-varnish6-jemalloc",
        "relates_to_product_reference": "red_hat_software_collections"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rh-varnish6-varnish as a component of Red Hat Software Collections",
          "product_id": "red_hat_software_collections:rh-varnish6-varnish"
        },
        "product_reference": "rh-varnish6-varnish",
        "relates_to_product_reference": "red_hat_software_collections"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "rh-varnish6-varnish-modules as a component of Red Hat Software Collections",
          "product_id": "red_hat_software_collections:rh-varnish6-varnish-modules"
        },
        "product_reference": "rh-varnish6-varnish-modules",
        "relates_to_product_reference": "red_hat_software_collections"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-38150",
      "cwe": {
        "id": "CWE-20",
        "name": "Improper Input Validation"
      },
      "discovery_date": "2022-08-09T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_8:varnish-modules",
            "red_hat_enterprise_linux_8:varnish:6/varnish",
            "red_hat_enterprise_linux_8:varnish:6/varnish-modules",
            "red_hat_enterprise_linux_9:varnish",
            "red_hat_enterprise_linux_9:varnish-modules",
            "red_hat_software_collections:rh-varnish6-jemalloc",
            "red_hat_software_collections:rh-varnish6-varnish",
            "red_hat_software_collections:rh-varnish6-varnish-modules"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2117692"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in Varnish where a denial of service attack can be performed against Varnish Cache servers by specially formatting the reason phrase of the backend response status line. To execute an attack, the attacker needs the ability to influence the HTTP/1 responses that the Varnish Server receives from its configured backends, causing the Varnish Server to assert and automatically restart.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "varnish: denial of service via colon-starting reason phrase",
          "title": "Vulnerability summary"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_8:varnish-modules",
          "red_hat_enterprise_linux_8:varnish:6/varnish",
          "red_hat_enterprise_linux_8:varnish:6/varnish-modules",
          "red_hat_enterprise_linux_9:varnish",
          "red_hat_enterprise_linux_9:varnish-modules",
          "red_hat_software_collections:rh-varnish6-jemalloc",
          "red_hat_software_collections:rh-varnish6-varnish",
          "red_hat_software_collections:rh-varnish6-varnish-modules"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-38150"
        },
        {
          "category": "external",
          "summary": "RHBZ#2117692",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2117692"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-38150",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-38150"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-38150",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-38150"
        }
      ],
      "release_date": "2022-08-09T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "As mentioned in the upstream security advisory, If upgrading Varnish is not possible, it is possible to mitigate the problem by adding the following snippet at the beginning of the vcl_backend_response VCL function:\n\n```\nsub vcl_backend_response {\n      set beresp.status = beresp.status;\n}\n```\n\nBy setting the status code to itself as described above, the reason field will automatically be reset to the standard value for the given status code, or “Unknown HTTP Status” if no standard value exists for that code. This would overwrite any existing attack content in the reason field.",
          "product_ids": [
            "red_hat_enterprise_linux_8:varnish-modules",
            "red_hat_enterprise_linux_8:varnish:6/varnish",
            "red_hat_enterprise_linux_8:varnish:6/varnish-modules",
            "red_hat_enterprise_linux_9:varnish",
            "red_hat_enterprise_linux_9:varnish-modules",
            "red_hat_software_collections:rh-varnish6-jemalloc",
            "red_hat_software_collections:rh-varnish6-varnish",
            "red_hat_software_collections:rh-varnish6-varnish-modules"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 7.5,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_enterprise_linux_8:varnish-modules",
            "red_hat_enterprise_linux_8:varnish:6/varnish",
            "red_hat_enterprise_linux_8:varnish:6/varnish-modules",
            "red_hat_enterprise_linux_9:varnish",
            "red_hat_enterprise_linux_9:varnish-modules",
            "red_hat_software_collections:rh-varnish6-jemalloc",
            "red_hat_software_collections:rh-varnish6-varnish",
            "red_hat_software_collections:rh-varnish6-varnish-modules"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_enterprise_linux_8:varnish-modules",
            "red_hat_enterprise_linux_8:varnish:6/varnish",
            "red_hat_enterprise_linux_8:varnish:6/varnish-modules",
            "red_hat_enterprise_linux_9:varnish",
            "red_hat_enterprise_linux_9:varnish-modules",
            "red_hat_software_collections:rh-varnish6-jemalloc",
            "red_hat_software_collections:rh-varnish6-varnish",
            "red_hat_software_collections:rh-varnish6-varnish-modules"
          ]
        }
      ],
      "title": "varnish: denial of service via colon-starting reason phrase"
    }
  ]
}