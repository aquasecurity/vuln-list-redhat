{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://access.redhat.com/security/data/csaf/v2/vex/2022/cve-2022-31105.json"
      }
    ],
    "title": "argo-cd: certificate verification is skipped for connections to OIDC providers",
    "tracking": {
      "current_release_date": "2024-08-20T09:54:40+00:00",
      "generator": {
        "date": "2024-08-20T09:54:40+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "3.32.1"
        }
      },
      "id": "CVE-2022-31105",
      "initial_release_date": "2022-07-13T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-07-13T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-02-27T15:13:07+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-08-20T09:54:40+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift GitOps",
                "product": {
                  "name": "Red Hat OpenShift GitOps",
                  "product_id": "red_hat_openshift_gitops",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift_gitops:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift GitOps"
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/applicationset-rhel8",
            "product": {
              "name": "openshift-gitops-1/applicationset-rhel8",
              "product_id": "openshift-gitops-1/applicationset-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-gitops-1/applicationset-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/argocd-rhel8",
            "product": {
              "name": "openshift-gitops-1/argocd-rhel8",
              "product_id": "openshift-gitops-1/argocd-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-gitops-1/argocd-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/gitops-rhel8",
            "product": {
              "name": "openshift-gitops-1/gitops-rhel8",
              "product_id": "openshift-gitops-1/gitops-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-gitops-1/gitops-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/gitops-rhel8-operator",
            "product": {
              "name": "openshift-gitops-1/gitops-rhel8-operator",
              "product_id": "openshift-gitops-1/gitops-rhel8-operator",
              "product_identification_helper": {
                "purl": "pkg:oci/openshift-gitops-1/gitops-rhel8-operator"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/applicationset-rhel8 as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8"
        },
        "product_reference": "openshift-gitops-1/applicationset-rhel8",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/argocd-rhel8 as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8"
        },
        "product_reference": "openshift-gitops-1/argocd-rhel8",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/gitops-rhel8 as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8"
        },
        "product_reference": "openshift-gitops-1/gitops-rhel8",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/gitops-rhel8-operator as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
        },
        "product_reference": "openshift-gitops-1/gitops-rhel8-operator",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-31105",
      "cwe": {
        "id": "CWE-599",
        "name": "Missing Validation of OpenSSL Certificate"
      },
      "discovery_date": "2022-07-13T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2106628"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Argo CD starting with version 0.4.0 and prior to 2.2.11, 2.3.6, and 2.4.5 is vulnerable to an improper certificate validation bug which could cause Argo CD to trust a malicious (or otherwise untrustworthy) OpenID Connect (OIDC) provider. A patch for this vulnerability has been released in Argo CD versions 2.4.5, 2.3.6, and 2.2.11. There are no complete workarounds, but a partial workaround is available. Those who use an external OIDC provider (not the bundled Dex instance), can mitigate the issue by setting the `oidc.config.rootCA` field in the `argocd-cm` ConfigMap. This mitigation only forces certificate validation when the API server handles login flows. It does not force certificate verification when verifying tokens on API calls.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "argo-cd: certificate verification is skipped for connections to OIDC providers",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This issue is already fixed in current Red Hat GitOps releases (1.4.11, 1.5.5, 1.6.0)",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8",
          "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8",
          "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8",
          "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-31105"
        },
        {
          "category": "external",
          "summary": "RHBZ#2106628",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2106628"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-31105",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-31105"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-31105",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-31105"
        },
        {
          "category": "external",
          "summary": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-7943-82jg-wmw5",
          "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-7943-82jg-wmw5"
        }
      ],
      "release_date": "2022-07-13T00:00:00+00:00",
      "title": "argo-cd: certificate verification is skipped for connections to OIDC providers"
    }
  ]
}