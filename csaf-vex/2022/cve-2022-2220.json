{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "None"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-2220.json"
      }
    ],
    "title": "openshfit-router: fails to verify subdomain ownership which can lead to route takeover",
    "tracking": {
      "current_release_date": "2024-12-05T20:17:49+00:00",
      "generator": {
        "date": "2024-12-05T20:17:49+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.2"
        }
      },
      "id": "CVE-2022-2220",
      "initial_release_date": "2022-06-27T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-06-27T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-01-20T17:51:32+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-12-05T20:17:49+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 3.11",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 3.11",
                  "product_id": "red_hat_openshift_container_platform_3.11",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:3.11"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 3.11"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift Container Platform 4",
                "product": {
                  "name": "Red Hat OpenShift Container Platform 4",
                  "product_id": "red_hat_openshift_container_platform_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift Container Platform 4"
          },
          {
            "category": "product_version",
            "name": "atomic-openshift",
            "product": {
              "name": "atomic-openshift",
              "product_id": "atomic-openshift",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/atomic-openshift?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift3/ose-haproxy-router",
            "product": {
              "name": "openshift3/ose-haproxy-router",
              "product_id": "openshift3/ose-haproxy-router",
              "product_identification_helper": {
                "purl": "pkg:oci/ose-haproxy-router?repository_url=registry.redhat.io/openshift3/ose-haproxy-router"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-cluster-ingress-operator",
            "product": {
              "name": "openshift4/ose-cluster-ingress-operator",
              "product_id": "openshift4/ose-cluster-ingress-operator",
              "product_identification_helper": {
                "purl": "pkg:oci/ose-cluster-ingress-operator?repository_url=registry.redhat.io/openshift4/ose-cluster-ingress-operator"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift4/ose-haproxy-router",
            "product": {
              "name": "openshift4/ose-haproxy-router",
              "product_id": "openshift4/ose-haproxy-router",
              "product_identification_helper": {
                "purl": "pkg:oci/ose-haproxy-router?repository_url=registry.redhat.io/openshift4/ose-haproxy-router"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "atomic-openshift as a component of Red Hat OpenShift Container Platform 3.11",
          "product_id": "red_hat_openshift_container_platform_3.11:atomic-openshift"
        },
        "product_reference": "atomic-openshift",
        "relates_to_product_reference": "red_hat_openshift_container_platform_3.11"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift3/ose-haproxy-router as a component of Red Hat OpenShift Container Platform 3.11",
          "product_id": "red_hat_openshift_container_platform_3.11:openshift3/ose-haproxy-router"
        },
        "product_reference": "openshift3/ose-haproxy-router",
        "relates_to_product_reference": "red_hat_openshift_container_platform_3.11"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-cluster-ingress-operator as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-cluster-ingress-operator"
        },
        "product_reference": "openshift4/ose-cluster-ingress-operator",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift4/ose-haproxy-router as a component of Red Hat OpenShift Container Platform 4",
          "product_id": "red_hat_openshift_container_platform_4:openshift4/ose-haproxy-router"
        },
        "product_reference": "openshift4/ose-haproxy-router",
        "relates_to_product_reference": "red_hat_openshift_container_platform_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-2220",
      "cwe": {
        "id": "CWE-1220",
        "name": "Insufficient Granularity of Access Control"
      },
      "discovery_date": "2022-06-27T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_openshift_container_platform_3.11:atomic-openshift",
            "red_hat_openshift_container_platform_3.11:openshift3/ose-haproxy-router",
            "red_hat_openshift_container_platform_4:openshift4/ose-cluster-ingress-operator",
            "red_hat_openshift_container_platform_4:openshift4/ose-haproxy-router"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2101434"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Insufficient Granularity of Access Control in an OpenShift router causes improper subdomain ownership verification, allowing route takeover. Once a custom route is created, the user must update the DNS provider by creating a canonical name (CNAME) record to expose this route externally. The CNAME record should point the custom domain to the OpenShift router as the alias. If the CNAME is not removed when the route is not in use anymore, there is a dangling route that a malicious actor may take over.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "openshfit-router: fails to verify subdomain ownership which can lead to route takeover",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat Product Security does not consider this to be a vulnerability. It is not in the scope of the ingress controller to manage external dns records. It is the cluster administrator's responsibility to manage DNS records and to secure sensitive routes using TLS.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_openshift_container_platform_3.11:atomic-openshift",
          "red_hat_openshift_container_platform_3.11:openshift3/ose-haproxy-router",
          "red_hat_openshift_container_platform_4:openshift4/ose-cluster-ingress-operator",
          "red_hat_openshift_container_platform_4:openshift4/ose-haproxy-router"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-2220"
        },
        {
          "category": "external",
          "summary": "RHBZ#2101434",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2101434"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-2220",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-2220"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-2220",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-2220"
        }
      ],
      "release_date": "2022-06-27T00:00:00+00:00",
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 0,
            "baseSeverity": "NONE"
          },
          "products": [
            "red_hat_openshift_container_platform_3.11:atomic-openshift",
            "red_hat_openshift_container_platform_3.11:openshift3/ose-haproxy-router",
            "red_hat_openshift_container_platform_4:openshift4/ose-cluster-ingress-operator",
            "red_hat_openshift_container_platform_4:openshift4/ose-haproxy-router"
          ]
        }
      ],
      "title": "openshfit-router: fails to verify subdomain ownership which can lead to route takeover"
    }
  ]
}