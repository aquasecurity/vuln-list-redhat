{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-41137.json"
      }
    ],
    "title": "hive-metastore: org.apache.hive:hive-metastore: Apache Hive: Deserialization of untrusted data when fetching partitions from the Metastore",
    "tracking": {
      "current_release_date": "2025-03-03T14:41:40+00:00",
      "generator": {
        "date": "2025-03-03T14:41:40+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.1"
        }
      },
      "id": "CVE-2022-41137",
      "initial_release_date": "2022-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-02-03T05:11:01+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-03-03T14:41:40+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Fuse 7",
                "product": {
                  "name": "Red Hat Fuse 7",
                  "product_id": "red_hat_fuse_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_fuse:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Fuse 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Integration Camel K 1",
                "product": {
                  "name": "Red Hat Integration Camel K 1",
                  "product_id": "red_hat_integration_camel_k_1",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:integration:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Integration Camel K 1"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Data Grid 7",
                "product": {
                  "name": "Red Hat JBoss Data Grid 7",
                  "product_id": "red_hat_jboss_data_grid_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_data_grid:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Data Grid 7"
          },
          {
            "category": "product_version",
            "name": "org.spark-project.hive/hive-metastore",
            "product": {
              "name": "org.spark-project.hive/hive-metastore",
              "product_id": "org.spark-project.hive/hive-metastore"
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "org.spark-project.hive/hive-metastore as a component of Red Hat Fuse 7",
          "product_id": "red_hat_fuse_7:org.spark-project.hive/hive-metastore"
        },
        "product_reference": "org.spark-project.hive/hive-metastore",
        "relates_to_product_reference": "red_hat_fuse_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "org.spark-project.hive/hive-metastore as a component of Red Hat Integration Camel K 1",
          "product_id": "red_hat_integration_camel_k_1:org.spark-project.hive/hive-metastore"
        },
        "product_reference": "org.spark-project.hive/hive-metastore",
        "relates_to_product_reference": "red_hat_integration_camel_k_1"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "org.spark-project.hive/hive-metastore as a component of Red Hat JBoss Data Grid 7",
          "product_id": "red_hat_jboss_data_grid_7:org.spark-project.hive/hive-metastore"
        },
        "product_reference": "org.spark-project.hive/hive-metastore",
        "relates_to_product_reference": "red_hat_jboss_data_grid_7"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-41137",
      "cwe": {
        "id": "CWE-502",
        "name": "Deserialization of Untrusted Data"
      },
      "discovery_date": "2024-12-05T11:00:41.154220+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_integration_camel_k_1:org.spark-project.hive/hive-metastore",
            "red_hat_jboss_data_grid_7:org.spark-project.hive/hive-metastore"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2330533"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in the Apache Hive Metastore (HMS). This vulnerability allows remote code execution (RCE) via deserialization of arbitrary data when the `SerializationUtilities#deserializeObjectWithTypeInformation` method filters and fetches partitions without additional input validation. In real deployments, the vulnerability can be exploited only by authenticated users/clients who successfully establish a connection to the Metastore. From an API perspective, any code that calls the unsafe method may be vulnerable unless it performs additional rechecks on the input arguments.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "hive-metastore: org.apache.hive:hive-metastore: Apache Hive: Deserialization of untrusted data when fetching partitions from the Metastore",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "The Metastore component is used to stores the structure information of tables and partitions in the warehouse, meaning this issue impacts mainly the integrity and availability of the system.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_fuse_7:org.spark-project.hive/hive-metastore"
        ],
        "known_not_affected": [
          "red_hat_integration_camel_k_1:org.spark-project.hive/hive-metastore",
          "red_hat_jboss_data_grid_7:org.spark-project.hive/hive-metastore"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-41137"
        },
        {
          "category": "external",
          "summary": "RHBZ#2330533",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2330533"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-41137",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-41137"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-41137",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-41137"
        },
        {
          "category": "external",
          "summary": "http://www.openwall.com/lists/oss-security/2024/12/04/2",
          "url": "http://www.openwall.com/lists/oss-security/2024/12/04/2"
        },
        {
          "category": "external",
          "summary": "https://github.com/apache/hive",
          "url": "https://github.com/apache/hive"
        },
        {
          "category": "external",
          "summary": "https://github.com/apache/hive/commit/60027bb9c91a93affcfebd9068f064bc1f2a74c9",
          "url": "https://github.com/apache/hive/commit/60027bb9c91a93affcfebd9068f064bc1f2a74c9"
        },
        {
          "category": "external",
          "summary": "https://issues.apache.org/jira/browse/HIVE-26539",
          "url": "https://issues.apache.org/jira/browse/HIVE-26539"
        },
        {
          "category": "external",
          "summary": "https://lists.apache.org/thread/jwtr3d9yovf2wo0qlxvkhoxnwxxyzgts",
          "url": "https://lists.apache.org/thread/jwtr3d9yovf2wo0qlxvkhoxnwxxyzgts"
        }
      ],
      "release_date": "2024-12-05T10:01:41.692000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Any code that calls the unsafe method may be vulnerable unless it performs additional checks on the input arguments. Implementing additional validations on input arguments before passing them to the SerializationUtilities#deserializeObjectWithTypeInformation method might mitigate or decrease this risk.",
          "product_ids": [
            "red_hat_fuse_7:org.spark-project.hive/hive-metastore",
            "red_hat_integration_camel_k_1:org.spark-project.hive/hive-metastore",
            "red_hat_jboss_data_grid_7:org.spark-project.hive/hive-metastore"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "red_hat_fuse_7:org.spark-project.hive/hive-metastore"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "LOW",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 8.3,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_fuse_7:org.spark-project.hive/hive-metastore",
            "red_hat_integration_camel_k_1:org.spark-project.hive/hive-metastore",
            "red_hat_jboss_data_grid_7:org.spark-project.hive/hive-metastore"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "red_hat_fuse_7:org.spark-project.hive/hive-metastore",
            "red_hat_integration_camel_k_1:org.spark-project.hive/hive-metastore",
            "red_hat_jboss_data_grid_7:org.spark-project.hive/hive-metastore"
          ]
        }
      ],
      "title": "hive-metastore: org.apache.hive:hive-metastore: Apache Hive: Deserialization of untrusted data when fetching partitions from the Metastore"
    }
  ]
}