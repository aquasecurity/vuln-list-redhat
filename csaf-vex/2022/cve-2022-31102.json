{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Low"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-31102.json"
      }
    ],
    "title": "argo-cd: leaked API server encryption key can allow XSS for SSO users",
    "tracking": {
      "current_release_date": "2025-01-07T20:34:49+00:00",
      "generator": {
        "date": "2025-01-07T20:34:49+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.5"
        }
      },
      "id": "CVE-2022-31102",
      "initial_release_date": "2022-07-13T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-07-13T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2022-08-19T21:44:00+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-07T20:34:49+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenShift GitOps",
                "product": {
                  "name": "Red Hat OpenShift GitOps",
                  "product_id": "red_hat_openshift_gitops",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift_gitops:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenShift GitOps"
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/applicationset-rhel8",
            "product": {
              "name": "openshift-gitops-1/applicationset-rhel8",
              "product_id": "openshift-gitops-1/applicationset-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/applicationset-rhel8?repository_url=registry.redhat.io/openshift-gitops-1/applicationset-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/argocd-rhel8",
            "product": {
              "name": "openshift-gitops-1/argocd-rhel8",
              "product_id": "openshift-gitops-1/argocd-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/argocd-rhel8?repository_url=registry.redhat.io/openshift-gitops-1/argocd-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/gitops-rhel8",
            "product": {
              "name": "openshift-gitops-1/gitops-rhel8",
              "product_id": "openshift-gitops-1/gitops-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/gitops-rhel8?repository_url=registry.redhat.io/openshift-gitops-1/gitops-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-gitops-1/gitops-rhel8-operator",
            "product": {
              "name": "openshift-gitops-1/gitops-rhel8-operator",
              "product_id": "openshift-gitops-1/gitops-rhel8-operator",
              "product_identification_helper": {
                "purl": "pkg:oci/gitops-rhel8-operator?repository_url=registry.redhat.io/openshift-gitops-1/gitops-rhel8-operator"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/applicationset-rhel8 as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8"
        },
        "product_reference": "openshift-gitops-1/applicationset-rhel8",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/argocd-rhel8 as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8"
        },
        "product_reference": "openshift-gitops-1/argocd-rhel8",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/gitops-rhel8 as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8"
        },
        "product_reference": "openshift-gitops-1/gitops-rhel8",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-gitops-1/gitops-rhel8-operator as a component of Red Hat OpenShift GitOps",
          "product_id": "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
        },
        "product_reference": "openshift-gitops-1/gitops-rhel8-operator",
        "relates_to_product_reference": "red_hat_openshift_gitops"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-31102",
      "cwe": {
        "id": "CWE-74",
        "name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"
      },
      "discovery_date": "2022-07-13T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2106624"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Argo CD starting with 2.3.0 and prior to 2.3.6 and 2.4.5 is vulnerable to a cross-site scripting (XSS) bug which could allow an attacker to inject arbitrary JavaScript in the `/auth/callback` page in a victim's browser. This vulnerability only affects Argo CD instances which have single sign on (SSO) enabled. The exploit also assumes the attacker has 1) access to the API server's encryption key, 2) a method to add a cookie to the victim's browser, and 3) the ability to convince the victim to visit a malicious `/auth/callback` link. The vulnerability is classified as low severity because access to the API server's encryption key already grants a high level of access. Exploiting the XSS would allow the attacker to impersonate the victim, but would not grant any privileges which the attacker could not otherwise gain using the encryption key. A patch for this vulnerability has been released in the following Argo CD versions 2.4.5 and 2.3.6. There is currently no known workaround.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "argo-cd: leaked API server encryption key can allow XSS for SSO users",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This issue is already fixed in current Red Hat GitOps releases (1.4.11, 1.5.5, 1.6.0)",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8",
          "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8",
          "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8",
          "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-31102"
        },
        {
          "category": "external",
          "summary": "RHBZ#2106624",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2106624"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-31102",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-31102"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-31102",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-31102"
        },
        {
          "category": "external",
          "summary": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-pmjg-52h9-72qv",
          "url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-pmjg-52h9-72qv"
        }
      ],
      "release_date": "2022-07-13T00:00:00+00:00",
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:N/I:L/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "HIGH",
            "userInteraction": "REQUIRED",
            "scope": "CHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "LOW",
            "availabilityImpact": "NONE",
            "baseScore": 2.6,
            "baseSeverity": "LOW"
          },
          "products": [
            "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "red_hat_openshift_gitops:openshift-gitops-1/applicationset-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/argocd-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8",
            "red_hat_openshift_gitops:openshift-gitops-1/gitops-rhel8-operator"
          ]
        }
      ],
      "title": "argo-cd: leaked API server encryption key can allow XSS for SSO users"
    }
  ]
}