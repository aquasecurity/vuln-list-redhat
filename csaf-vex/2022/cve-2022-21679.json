{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-21679.json"
      }
    ],
    "title": "istio: Authorization policy bypass",
    "tracking": {
      "current_release_date": "2025-02-07T01:15:16+00:00",
      "generator": {
        "date": "2025-02-07T01:15:16+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2022-21679",
      "initial_release_date": "2022-01-18T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-01-18T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-09-01T02:53:28+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-07T01:15:16+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 1",
                "product": {
                  "name": "OpenShift Service Mesh 1",
                  "product_id": "openshift_service_mesh_1",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 1"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 2.0",
                "product": {
                  "name": "OpenShift Service Mesh 2.0",
                  "product_id": "openshift_service_mesh_2.0",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:2.0"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 2.0"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "OpenShift Service Mesh 2.1",
                "product": {
                  "name": "OpenShift Service Mesh 2.1",
                  "product_id": "openshift_service_mesh_2.1",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:service_mesh:2.1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "OpenShift Service Mesh 2.1"
          },
          {
            "category": "product_version",
            "name": "servicemesh",
            "product": {
              "name": "servicemesh",
              "product_id": "servicemesh",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/servicemesh?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "servicemesh as a component of OpenShift Service Mesh 1",
          "product_id": "openshift_service_mesh_1:servicemesh"
        },
        "product_reference": "servicemesh",
        "relates_to_product_reference": "openshift_service_mesh_1"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "servicemesh as a component of OpenShift Service Mesh 2.0",
          "product_id": "openshift_service_mesh_2.0:servicemesh"
        },
        "product_reference": "servicemesh",
        "relates_to_product_reference": "openshift_service_mesh_2.0"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "servicemesh as a component of OpenShift Service Mesh 2.1",
          "product_id": "openshift_service_mesh_2.1:servicemesh"
        },
        "product_reference": "servicemesh",
        "relates_to_product_reference": "openshift_service_mesh_2.1"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-21679",
      "cwe": {
        "id": "CWE-1220",
        "name": "Insufficient Granularity of Access Control"
      },
      "discovery_date": "2022-01-24T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "openshift_service_mesh_2.0:servicemesh"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2044675"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Istio is an open platform to connect, manage, and secure microservices. In Istio 1.12.0 and 1.12.1 The authorization policy with hosts and notHosts might be accidentally bypassed for ALLOW action or rejected unexpectedly for DENY action during the upgrade from 1.11 to 1.12.0/1.12.1. Istio 1.12 supports the hosts and notHosts fields in authorization policy with a new Envoy API shipped with the 1.12 data plane. A bug in the 1.12.0 and 1.12.1 incorrectly uses the new Envoy API with the 1.11 data plane. This will cause the hosts and notHosts fields to be always matched regardless of the actual value of the host header when mixing 1.12.0/1.12.1 control plane and 1.11 data plane. Users are advised to upgrade or to not mix the 1.12.0/1.12.1 control plane with 1.11 data plane if using hosts or notHosts field in authorization policy.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "istio: Authorization policy bypass",
          "title": "Vulnerability summary"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "openshift_service_mesh_1:servicemesh",
          "openshift_service_mesh_2.1:servicemesh"
        ],
        "known_not_affected": [
          "openshift_service_mesh_2.0:servicemesh"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-21679"
        },
        {
          "category": "external",
          "summary": "RHBZ#2044675",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2044675"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-21679",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-21679"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-21679",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-21679"
        }
      ],
      "release_date": "2022-01-18T00:00:00+00:00",
      "remediations": [
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "openshift_service_mesh_1:servicemesh"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "openshift_service_mesh_2.1:servicemesh"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "products": [
            "openshift_service_mesh_1:servicemesh",
            "openshift_service_mesh_2.0:servicemesh",
            "openshift_service_mesh_2.1:servicemesh"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "openshift_service_mesh_1:servicemesh",
            "openshift_service_mesh_2.0:servicemesh",
            "openshift_service_mesh_2.1:servicemesh"
          ]
        }
      ],
      "title": "istio: Authorization policy bypass"
    }
  ]
}