{
  "document": {
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-35924.json"
      }
    ],
    "title": "Verification requests (magic link) sent to unwanted emails",
    "tracking": {
      "current_release_date": "2025-02-05T18:56:57+00:00",
      "generator": {
        "date": "2025-02-05T18:56:57+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2022-35924",
      "initial_release_date": "2022-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2024-08-03T09:51:58.503000+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-05T18:56:57+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "category": "vendor",
        "name": "Red Hat",
        "product": {
          "name": "All currently supported Red Hat products",
          "product_id": "red_hat_products",
          "product_identification_helper": {
            "cpe": "cpe:/a:redhat"
          }
        }
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-35924",
      "flags": [
        {
          "label": "component_not_present",
          "product_ids": [
            "red_hat_products"
          ]
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "NextAuth.js is a complete open source authentication solution for Next.js applications. `next-auth` users who are using the `EmailProvider` either in versions before `4.10.3` or `3.29.10` are affected. If an attacker could forge a request that sent a comma-separated list of emails (eg.: `attacker@attacker.com,victim@victim.com`) to the sign-in endpoint, NextAuth.js would send emails to both the attacker and the victim's e-mail addresses. The attacker could then login as a newly created user with the email being `attacker@attacker.com,victim@victim.com`. This means that basic authorization like `email.endsWith(\"@victim.com\")` in the `signIn` callback would fail to communicate a threat to the developer and would let the attacker bypass authorization, even with an `@attacker.com` address. This vulnerability has been patched in `v4.10.3` and `v3.29.10` by normalizing the email value that is sent to the sign-in endpoint before accessing it anywhere else. We also added a `normalizeIdentifier` callback on the `EmailProvider` configuration, where you can further tweak your requirements for what your system considers a valid e-mail address. (E.g.: strict RFC2821 compliance). Users are advised to upgrade. There are no known workarounds for this vulnerability. If for some reason you cannot upgrade, you can normalize the incoming request using Advanced Initialization.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "Verification requests (magic link) sent to unwanted emails",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat Product Security has determined that this vulnerability does not affect any currently supported Red Hat product. This assessment may evolve based on further analysis and discovery. For more information about this vulnerability and the products it affects, please see the linked references.",
          "title": "Statement"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_products"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-35924"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-35924",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-35924"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-35924",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-35924"
        },
        {
          "category": "external",
          "summary": "https://en.wikipedia.org/wiki/Email_address#Local-part",
          "url": "https://en.wikipedia.org/wiki/Email_address#Local-part"
        },
        {
          "category": "external",
          "summary": "https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003",
          "url": "https://github.com/nextauthjs/next-auth/commit/afb1fcdae3cc30445038ef588e491d139b916003"
        },
        {
          "category": "external",
          "summary": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587",
          "url": "https://github.com/nextauthjs/next-auth/security/advisories/GHSA-xv97-c62v-4587"
        },
        {
          "category": "external",
          "summary": "https://next-auth.js.org/configuration/callbacks#sign-in-callback",
          "url": "https://next-auth.js.org/configuration/callbacks#sign-in-callback"
        },
        {
          "category": "external",
          "summary": "https://next-auth.js.org/configuration/initialization#advanced-initialization",
          "url": "https://next-auth.js.org/configuration/initialization#advanced-initialization"
        },
        {
          "category": "external",
          "summary": "https://next-auth.js.org/providers/email",
          "url": "https://next-auth.js.org/providers/email"
        },
        {
          "category": "external",
          "summary": "https://next-auth.js.org/providers/email#normalizing-the-e-mail-address",
          "url": "https://next-auth.js.org/providers/email#normalizing-the-e-mail-address"
        },
        {
          "category": "external",
          "summary": "https://nodemailer.com/message/addresses",
          "url": "https://nodemailer.com/message/addresses"
        }
      ],
      "title": "Verification requests (magic link) sent to unwanted emails"
    }
  ]
}