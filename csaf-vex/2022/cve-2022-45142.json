{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat offerings.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://access.redhat.com/security/data/csaf/v2/vex/2022/cve-2022-45142.json"
      }
    ],
    "title": "samba: fix introduced a logic inversion",
    "tracking": {
      "current_release_date": "2024-09-25T02:03:49+00:00",
      "generator": {
        "date": "2024-09-25T02:03:49+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.0.0"
        }
      },
      "id": "CVE-2022-45142",
      "initial_release_date": "2022-01-01T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-01-01T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-03-03T20:14:05+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-09-25T02:03:49+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 9",
                "product": {
                  "name": "Red Hat Enterprise Linux 9",
                  "product_id": "red_hat_enterprise_linux_9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:9"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 9"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Storage 3",
                "product": {
                  "name": "Red Hat Storage 3",
                  "product_id": "red_hat_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Storage 3"
          },
          {
            "category": "product_version",
            "name": "samba",
            "product": {
              "name": "samba",
              "product_id": "samba",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/samba?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 9",
          "product_id": "red_hat_enterprise_linux_9:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Storage 3",
          "product_id": "red_hat_storage_3:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_storage_3"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-45142",
      "cwe": {
        "id": "CWE-354",
        "name": "Improper Validation of Integrity Check Value"
      },
      "discovery_date": "2023-02-02T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_6:samba",
            "red_hat_enterprise_linux_7:samba",
            "red_hat_enterprise_linux_8:samba",
            "red_hat_enterprise_linux_9:samba",
            "red_hat_storage_3:samba"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2166672"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "The fix for CVE-2022-3437 included changing memcmp to be constant time and a workaround for a compiler bug by adding \"!= 0\" comparisons to the result of memcmp. When these patches were backported to the heimdal-7.7.1 and heimdal-7.8.0 branches (and possibly other branches) a logic inversion sneaked in causing the validation of message integrity codes in gssapi/arcfour to be inverted.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "samba: fix introduced a logic inversion",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Samba in RHEL is not compiled to use the Heimdal Kerberos library.\n\nVersions of Samba shipped in Red Hat Enterprise Linux are compiled to use the system MIT Kerberos using the \"--with-system-mitkrb5\" argument, and these installations are not impacted, as the vulnerable code is not compiled into Samba.",
          "title": "Statement"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_6:samba",
          "red_hat_enterprise_linux_7:samba",
          "red_hat_enterprise_linux_8:samba",
          "red_hat_enterprise_linux_9:samba",
          "red_hat_storage_3:samba"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-45142"
        },
        {
          "category": "external",
          "summary": "RHBZ#2166672",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2166672"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-45142",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-45142"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-45142",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-45142"
        }
      ],
      "release_date": "2023-02-08T00:00:00+00:00",
      "title": "samba: fix introduced a logic inversion"
    }
  ]
}