{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2022/cve-2022-33891.json"
      }
    ],
    "title": "apache-spark: Apache Spark shell command injection vulnerability via Spark UI",
    "tracking": {
      "current_release_date": "2024-11-19T07:06:59+00:00",
      "generator": {
        "date": "2024-11-19T07:06:59+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2022-33891",
      "initial_release_date": "2022-07-18T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2022-07-18T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-03-07T17:44:36+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-19T07:06:59+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat build of Apache Camel for Spring Boot 3",
                "product": {
                  "name": "Red Hat build of Apache Camel for Spring Boot 3",
                  "product_id": "red_hat_build_of_apache_camel_for_spring_boot_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:camel_spring_boot:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat build of Apache Camel for Spring Boot 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Fuse 7",
                "product": {
                  "name": "Red Hat Fuse 7",
                  "product_id": "red_hat_fuse_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_fuse:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Fuse 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Integration Camel K",
                "product": {
                  "name": "Red Hat Integration Camel K",
                  "product_id": "red_hat_integration_camel_k",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:integration:1"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Integration Camel K"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat JBoss Data Grid 7",
                "product": {
                  "name": "Red Hat JBoss Data Grid 7",
                  "product_id": "red_hat_jboss_data_grid_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:jboss_data_grid:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat JBoss Data Grid 7"
          },
          {
            "category": "product_version",
            "name": "apache-spark",
            "product": {
              "name": "apache-spark",
              "product_id": "apache-spark"
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "apache-spark as a component of Red Hat build of Apache Camel for Spring Boot 3",
          "product_id": "red_hat_build_of_apache_camel_for_spring_boot_3:apache-spark"
        },
        "product_reference": "apache-spark",
        "relates_to_product_reference": "red_hat_build_of_apache_camel_for_spring_boot_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "apache-spark as a component of Red Hat Fuse 7",
          "product_id": "red_hat_fuse_7:apache-spark"
        },
        "product_reference": "apache-spark",
        "relates_to_product_reference": "red_hat_fuse_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "apache-spark as a component of Red Hat Integration Camel K",
          "product_id": "red_hat_integration_camel_k:apache-spark"
        },
        "product_reference": "apache-spark",
        "relates_to_product_reference": "red_hat_integration_camel_k"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "apache-spark as a component of Red Hat JBoss Data Grid 7",
          "product_id": "red_hat_jboss_data_grid_7:apache-spark"
        },
        "product_reference": "apache-spark",
        "relates_to_product_reference": "red_hat_jboss_data_grid_7"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-33891",
      "cwe": {
        "id": "CWE-77",
        "name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')"
      },
      "discovery_date": "2023-02-28T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_build_of_apache_camel_for_spring_boot_3:apache-spark",
            "red_hat_fuse_7:apache-spark",
            "red_hat_integration_camel_k:apache-spark",
            "red_hat_jboss_data_grid_7:apache-spark"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2174263"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in Apache Spark. This flaw allows a malicious user to impersonate another user and jeopardize the environment by executing shell commands.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "apache-spark: Apache Spark shell command injection vulnerability via Spark UI",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Red Hat Middleware as  Data Grid 7 and Fuse 7 products listed in this CVE page does not ship Apache Spark with their source code or binaries. Those who ship Apache Spark partially do are running versions \u003c 3.x. Since 3.x is written in Scala and 2.x is written in Java, there's a difference in their source code. \nIn 2.4 version this demands 'spark.acls.enable' which comes disabled by default, needs to be set 'true' in order to be vulnerable. Red Hat Middleware stack does not have this option enabled.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_build_of_apache_camel_for_spring_boot_3:apache-spark",
          "red_hat_fuse_7:apache-spark",
          "red_hat_integration_camel_k:apache-spark",
          "red_hat_jboss_data_grid_7:apache-spark"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2022-33891"
        },
        {
          "category": "external",
          "summary": "RHBZ#2174263",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2174263"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2022-33891",
          "url": "https://www.cve.org/CVERecord?id=CVE-2022-33891"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2022-33891",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-33891"
        },
        {
          "category": "external",
          "summary": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
          "url": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog"
        }
      ],
      "release_date": "2022-07-18T00:00:00+00:00",
      "threats": [
        {
          "category": "exploit_status",
          "date": "2023-03-07T00:00:00+00:00",
          "details": "CISA: https://www.cisa.gov/known-exploited-vulnerabilities-catalog"
        }
      ],
      "title": "apache-spark: Apache Spark shell command injection vulnerability via Spark UI"
    }
  ]
}