{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2018/cve-2018-6954.json"
      }
    ],
    "title": "systemd: Mishandled symlinks in systemd-tmpfiles allows local users to obtain ownership of arbitrary files",
    "tracking": {
      "current_release_date": "2025-02-06T21:55:47+00:00",
      "generator": {
        "date": "2025-02-06T21:55:47+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.3.0"
        }
      },
      "id": "CVE-2018-6954",
      "initial_release_date": "2018-01-25T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2018-01-25T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-10-06T17:43:26+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-02-06T21:55:47+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "category": "product_version",
            "name": "systemd",
            "product": {
              "name": "systemd",
              "product_id": "systemd",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/systemd?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "systemd as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:systemd"
        },
        "product_reference": "systemd",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "systemd as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:systemd"
        },
        "product_reference": "systemd",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2018-6954",
      "cwe": {
        "id": "CWE-59",
        "name": "Improper Link Resolution Before File Access ('Link Following')"
      },
      "discovery_date": "2018-02-14T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_8:systemd"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1545017"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "It has been discovered that systemd-tmpfiles mishandles symbolic links present in non-terminal path components. In some configurations a local user could use this vulnerability to get access to arbitrary files when the systemd-tmpfiles command is run.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "systemd: Mishandled symlinks in systemd-tmpfiles allows local users to obtain ownership of arbitrary files",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This flaw affects in particular those systems where custom tmpfiles files are configured (e.g. in /etc/tmpfiles.d). Indeed systemd-tmpfiles installed by system packages set privileges of a directory either to root or to a service specific user and not to interactive users. Even in case they provide one of the vulnerable tmpfiles configuration file (e.g. recursive \"Z\" type entries), an attacker would still need to perform the attack as the service specific user, which means they would first need to compromise that service.\n\nMoreover, systemd-tmpfiles service is automatically executed only when the system boots, when it is very unlikely an attacker has already a chance to perform any action at all. Otherwise, an attacker would have to wait for an administrator to manually run the `systemd-tmpfiles --create` command.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_7:systemd"
        ],
        "known_not_affected": [
          "red_hat_enterprise_linux_8:systemd"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2018-6954"
        },
        {
          "category": "external",
          "summary": "RHBZ#1545017",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1545017"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2018-6954",
          "url": "https://www.cve.org/CVERecord?id=CVE-2018-6954"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2018-6954",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2018-6954"
        }
      ],
      "release_date": "2018-01-25T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "There is no known mitigation available.",
          "product_ids": [
            "red_hat_enterprise_linux_7:systemd",
            "red_hat_enterprise_linux_8:systemd"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_enterprise_linux_7:systemd"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "LOCAL",
            "attackComplexity": "HIGH",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 7,
            "baseSeverity": "HIGH"
          },
          "products": [
            "red_hat_enterprise_linux_7:systemd",
            "red_hat_enterprise_linux_8:systemd"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_enterprise_linux_7:systemd",
            "red_hat_enterprise_linux_8:systemd"
          ]
        }
      ],
      "title": "systemd: Mishandled symlinks in systemd-tmpfiles allows local users to obtain ownership of arbitrary files"
    }
  ]
}