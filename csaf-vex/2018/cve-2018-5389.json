{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2018/cve-2018-5389.json"
      }
    ],
    "title": "IKEv1: IKEv1 protocol vulnerability in the authentication mode with pre-shared keys in the main mode of operation",
    "tracking": {
      "current_release_date": "2024-11-20T21:32:10+00:00",
      "generator": {
        "date": "2024-11-20T21:32:10+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2018-5389",
      "initial_release_date": "2018-08-14T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2018-08-14T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2021-02-16T23:56:38+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-20T21:32:10+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 5",
                "product": {
                  "name": "Red Hat Enterprise Linux 5",
                  "product_id": "red_hat_enterprise_linux_5",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:5"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 5"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "category": "product_version",
            "name": "ipsec-tools",
            "product": {
              "name": "ipsec-tools",
              "product_id": "ipsec-tools",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/ipsec-tools?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openswan",
            "product": {
              "name": "openswan",
              "product_id": "openswan",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/openswan?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "libreswan",
            "product": {
              "name": "libreswan",
              "product_id": "libreswan",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/libreswan?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ipsec-tools as a component of Red Hat Enterprise Linux 5",
          "product_id": "red_hat_enterprise_linux_5:ipsec-tools"
        },
        "product_reference": "ipsec-tools",
        "relates_to_product_reference": "red_hat_enterprise_linux_5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openswan as a component of Red Hat Enterprise Linux 5",
          "product_id": "red_hat_enterprise_linux_5:openswan"
        },
        "product_reference": "openswan",
        "relates_to_product_reference": "red_hat_enterprise_linux_5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "libreswan as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:libreswan"
        },
        "product_reference": "libreswan",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openswan as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:openswan"
        },
        "product_reference": "openswan",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "libreswan as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:libreswan"
        },
        "product_reference": "libreswan",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "libreswan as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:libreswan"
        },
        "product_reference": "libreswan",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2018-5389",
      "cwe": {
        "id": "CWE-325",
        "name": "Missing Cryptographic Step"
      },
      "discovery_date": "2018-07-19T00:00:00+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1603064"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "It was found that IKEv1 (and potentially IKEv2) authentication when using a pre-shared key (PSK) is vulnerable to offline dictionary attacks in Main Mode as well as in Aggressive Mode. A man-in-the-middle attacker who intercepted the handshake of two peers authenticating with a PSK, could apply a brute-force attack to recover the shared secret.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "IKEv1: IKEv1 protocol vulnerability in the authentication mode with pre-shared keys in the main mode of operation",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "PSK based authentication should only be used when the randomness and confidentially of the shared secret can be guaranteed. PSKs should also not be used as Group Secrets, where the security of the PSK is only as strong as the weakest participant in the group. Public Key or EAP authentication methods should be used whenever possible. If PSK must be used, it is essential to ensure the shared secret has a high degree of randomness and is not derived from a password with low entropy, as specified clearly in the IKEv2 specification in RFC 7296.\n\nTo use passwords for authentication of IKE/IPsec peers, the IKEv2 protocol supports various methods that are not based on (inherently weak) PSKs and which are not vulnerable to offline dictionary attacks:\n\nRFC 5998: EAP-Only Authentication in IKEv2\nRFC 6617: Secure Pre-Shared Key (PSK) Authentication for IKE\nRFC 6631: Password Authenticated Connection Establishment with IKEv2\nRFC 6628: Efficient Augmented Password-Only Authentication and Key Exchange for IKEv2\n\nAs implementations supporting IKE assume the security of provided PSKs, and no mechanism within the protocol allows for password-stretching, we do not anticipate any software fixes becoming available.\n\nThe research paper that describes the problems of using weak PSKs also listed another security issue with respect to RSA keys that has different CVE numbers. Libreswan is not vulnerable to those attacks as it requires IKEv1 using either  (\"Encryption with RSA\" (value 5) or \"Revised encryption with RSA\" (value 6). Both of these modes are not implemented by libreswan.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_enterprise_linux_5:ipsec-tools",
          "red_hat_enterprise_linux_5:openswan",
          "red_hat_enterprise_linux_6:libreswan",
          "red_hat_enterprise_linux_6:openswan",
          "red_hat_enterprise_linux_7:libreswan",
          "red_hat_enterprise_linux_8:libreswan"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2018-5389"
        },
        {
          "category": "external",
          "summary": "RHBZ#1603064",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1603064"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2018-5389",
          "url": "https://www.cve.org/CVERecord?id=CVE-2018-5389"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2018-5389",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2018-5389"
        },
        {
          "category": "external",
          "summary": "https://www.kb.cert.org/vuls/id/857035",
          "url": "https://www.kb.cert.org/vuls/id/857035"
        }
      ],
      "release_date": "2018-08-14T00:00:00+00:00",
      "remediations": [
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_enterprise_linux_5:ipsec-tools",
            "red_hat_enterprise_linux_5:openswan",
            "red_hat_enterprise_linux_6:libreswan",
            "red_hat_enterprise_linux_6:openswan",
            "red_hat_enterprise_linux_7:libreswan",
            "red_hat_enterprise_linux_8:libreswan"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.0",
            "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 5.9,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_enterprise_linux_5:ipsec-tools",
            "red_hat_enterprise_linux_5:openswan",
            "red_hat_enterprise_linux_6:libreswan",
            "red_hat_enterprise_linux_6:openswan",
            "red_hat_enterprise_linux_7:libreswan",
            "red_hat_enterprise_linux_8:libreswan"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_enterprise_linux_5:ipsec-tools",
            "red_hat_enterprise_linux_5:openswan",
            "red_hat_enterprise_linux_6:libreswan",
            "red_hat_enterprise_linux_6:openswan",
            "red_hat_enterprise_linux_7:libreswan",
            "red_hat_enterprise_linux_8:libreswan"
          ]
        }
      ],
      "title": "IKEv1: IKEv1 protocol vulnerability in the authentication mode with pre-shared keys in the main mode of operation"
    }
  ]
}