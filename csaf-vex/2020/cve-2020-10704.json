{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2020/cve-2020-10704.json"
      }
    ],
    "title": "samba: LDAP Denial of Service (stack overflow) in Samba AD DC",
    "tracking": {
      "current_release_date": "2024-11-18T20:24:48+00:00",
      "generator": {
        "date": "2024-11-18T20:24:48+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2020-10704",
      "initial_release_date": "2020-04-28T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2020-04-28T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-09-07T22:52:01+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-18T20:24:48+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 5",
                "product": {
                  "name": "Red Hat Enterprise Linux 5",
                  "product_id": "red_hat_enterprise_linux_5",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:5"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 5"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 6",
                "product": {
                  "name": "Red Hat Enterprise Linux 6",
                  "product_id": "red_hat_enterprise_linux_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Storage 3",
                "product": {
                  "name": "Red Hat Storage 3",
                  "product_id": "red_hat_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Storage 3"
          },
          {
            "category": "product_version",
            "name": "samba",
            "product": {
              "name": "samba",
              "product_id": "samba",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/samba?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "samba3x",
            "product": {
              "name": "samba3x",
              "product_id": "samba3x",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/samba3x?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "samba4",
            "product": {
              "name": "samba4",
              "product_id": "samba4",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/samba4?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 5",
          "product_id": "red_hat_enterprise_linux_5:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba3x as a component of Red Hat Enterprise Linux 5",
          "product_id": "red_hat_enterprise_linux_5:samba3x"
        },
        "product_reference": "samba3x",
        "relates_to_product_reference": "red_hat_enterprise_linux_5"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba4 as a component of Red Hat Enterprise Linux 6",
          "product_id": "red_hat_enterprise_linux_6:samba4"
        },
        "product_reference": "samba4",
        "relates_to_product_reference": "red_hat_enterprise_linux_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "samba as a component of Red Hat Storage 3",
          "product_id": "red_hat_storage_3:samba"
        },
        "product_reference": "samba",
        "relates_to_product_reference": "red_hat_storage_3"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2020-10704",
      "cwe": {
        "id": "CWE-674",
        "name": "Uncontrolled Recursion"
      },
      "discovery_date": "2020-04-20T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_enterprise_linux_5:samba",
            "red_hat_enterprise_linux_5:samba3x",
            "red_hat_enterprise_linux_6:samba",
            "red_hat_enterprise_linux_6:samba4",
            "red_hat_enterprise_linux_7:samba",
            "red_hat_enterprise_linux_8:samba",
            "red_hat_storage_3:samba"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1825734"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found when using samba as an Active Directory Domain Controller. Due to the way samba handles certain requests as an Active Directory Domain Controller LDAP server, an unauthorized user can cause a stack overflow leading to a denial of service. The highest threat from this vulnerability is to system availability.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "samba: LDAP Denial of Service (stack overflow) in Samba AD DC",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This flaw does not affect the version of samba shipped with Red Hat Enterprise Linux as there is no support for samba as an Active Directory Domain Controller (AD DC). Similarly, the version of samba shipped with Red Hat Gluster Storage 3 is also not supported for use as an AD DC and, thus, is not affected by this vulnerability.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_not_affected": [
          "red_hat_enterprise_linux_5:samba",
          "red_hat_enterprise_linux_5:samba3x",
          "red_hat_enterprise_linux_6:samba",
          "red_hat_enterprise_linux_6:samba4",
          "red_hat_enterprise_linux_7:samba",
          "red_hat_enterprise_linux_8:samba",
          "red_hat_storage_3:samba"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2020-10704"
        },
        {
          "category": "external",
          "summary": "RHBZ#1825734",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1825734"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2020-10704",
          "url": "https://www.cve.org/CVERecord?id=CVE-2020-10704"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2020-10704",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2020-10704"
        },
        {
          "category": "external",
          "summary": "https://www.samba.org/samba/security/CVE-2020-10704.html",
          "url": "https://www.samba.org/samba/security/CVE-2020-10704.html"
        }
      ],
      "release_date": "2020-04-28T00:00:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "By default, Samba 4.10 is run using the \"standard\" process model, which would leave only the CLDAP server affected.  (Later versions use 'prefork').\n\nThis is controlled by the -M or --model parameter to the samba binary.\n\nAll Samba versions are impacted if -M prefork or -M single is used. To mitigate this issue for LDAP only, select -M standard (however this will use more memory, may allow resource exhaustion, and will still leave the CLDAP server exposed).",
          "product_ids": [
            "red_hat_enterprise_linux_5:samba",
            "red_hat_enterprise_linux_5:samba3x",
            "red_hat_enterprise_linux_6:samba",
            "red_hat_enterprise_linux_6:samba4",
            "red_hat_enterprise_linux_7:samba",
            "red_hat_enterprise_linux_8:samba",
            "red_hat_storage_3:samba"
          ]
        }
      ],
      "title": "samba: LDAP Denial of Service (stack overflow) in Samba AD DC"
    }
  ]
}