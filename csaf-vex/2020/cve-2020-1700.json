{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2020/cve-2020-1700.json"
      }
    ],
    "title": "ceph: connection leak in the RGW Beast front-end permits a DoS against the RGW server",
    "tracking": {
      "current_release_date": "2025-01-07T14:34:45+00:00",
      "generator": {
        "date": "2025-01-07T14:34:45+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.5"
        }
      },
      "id": "CVE-2020-1700",
      "initial_release_date": "2020-01-31T16:55:00+00:00",
      "revision_history": [
        {
          "date": "2020-01-31T16:55:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2023-08-03T08:30:34+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-01-07T14:34:45+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 2",
                "product": {
                  "name": "Red Hat Ceph Storage 2",
                  "product_id": "red_hat_ceph_storage_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 3",
                "product": {
                  "name": "Red Hat Ceph Storage 3",
                  "product_id": "red_hat_ceph_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 4",
                "product": {
                  "name": "Red Hat Ceph Storage 4",
                  "product_id": "red_hat_ceph_storage_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 4"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Enterprise Linux 8",
                "product": {
                  "name": "Red Hat Enterprise Linux 8",
                  "product_id": "red_hat_enterprise_linux_8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:redhat:enterprise_linux:8"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Enterprise Linux 8"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Openshift Container Storage 4",
                "product": {
                  "name": "Red Hat Openshift Container Storage 4",
                  "product_id": "red_hat_openshift_container_storage_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift_container_storage:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Openshift Container Storage 4"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenStack Platform 13 (Queens)",
                "product": {
                  "name": "Red Hat OpenStack Platform 13 (Queens)",
                  "product_id": "red_hat_openstack_platform_13_(queens)",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openstack:13"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenStack Platform 13 (Queens)"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenStack Platform 15 (Stein)",
                "product": {
                  "name": "Red Hat OpenStack Platform 15 (Stein)",
                  "product_id": "red_hat_openstack_platform_15_(stein)",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openstack:15"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenStack Platform 15 (Stein)"
          },
          {
            "category": "product_version",
            "name": "ceph",
            "product": {
              "name": "ceph",
              "product_id": "ceph",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/ceph?arch=src"
              }
            }
          },
          {
            "category": "product_version",
            "name": "ceph-common",
            "product": {
              "name": "ceph-common",
              "product_id": "ceph-common",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/ceph-common?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat Ceph Storage 2",
          "product_id": "red_hat_ceph_storage_2:ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_ceph_storage_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat Ceph Storage 3",
          "product_id": "red_hat_ceph_storage_3:ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_ceph_storage_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat Ceph Storage 4",
          "product_id": "red_hat_ceph_storage_4:ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_ceph_storage_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph-common as a component of Red Hat Enterprise Linux 7",
          "product_id": "red_hat_enterprise_linux_7:ceph-common"
        },
        "product_reference": "ceph-common",
        "relates_to_product_reference": "red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat Enterprise Linux 8",
          "product_id": "red_hat_enterprise_linux_8:ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_enterprise_linux_8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat Openshift Container Storage 4",
          "product_id": "red_hat_openshift_container_storage_4:ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_openshift_container_storage_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat OpenStack Platform 13 (Queens)",
          "product_id": "red_hat_openstack_platform_13_(queens):ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_openstack_platform_13_(queens)"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "ceph as a component of Red Hat OpenStack Platform 15 (Stein)",
          "product_id": "red_hat_openstack_platform_15_(stein):ceph"
        },
        "product_reference": "ceph",
        "relates_to_product_reference": "red_hat_openstack_platform_15_(stein)"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2020-1700",
      "cwe": {
        "id": "CWE-400",
        "name": "Uncontrolled Resource Consumption"
      },
      "discovery_date": "2020-01-16T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_ceph_storage_3:ceph",
            "red_hat_ceph_storage_4:ceph",
            "red_hat_enterprise_linux_7:ceph-common",
            "red_hat_enterprise_linux_8:ceph",
            "red_hat_openstack_platform_13_(queens):ceph",
            "red_hat_openstack_platform_15_(stein):ceph"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1791691"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in the way the Ceph RGW Beast front-end handles unexpected disconnects. An authenticated attacker can abuse this flaw by making multiple disconnect attempts resulting in a permanent leak of a socket connection by radosgw. This flaw could lead to a denial of service condition by pile up of CLOSE_WAIT sockets, eventually leading to the exhaustion of available resources, preventing legitimate users from connecting to the system.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "ceph: connection leak in the RGW Beast front-end permits a DoS against the RGW server",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "* Red Hat Ceph Storage 3 is not affected by this flaw, as beast is unsupported in the product.\n* Red Hat Ceph Storage 4 is not affected by this flaw, as it is shipping patched version of ceph.\n* Red Hat Openshift Container Storage 4.2 is affected by this flaw, as it is using the affected version of ceph.\n* Red Hat OpenStack Platform 13 included some Ceph components at release for in order to support ppc64le. The version provided in the OpenStack repositories is outdated and customers are expected to be using versions provided in Ceph repositories now. Red Hat OpenStack Platform 13 operators should verify they are using Ceph repositories which are up to date and unaffected by this vulnerability.\n* Red Hat Enterprise Linux 7 is not affected by this flaw, as it ships an old version of the code which does not include the vulnerable code.\n* Red Hat Enterprise Linux 8 is not affected by this flaw, as only libcephfs-devel component is shipped and it does include the vulnerable code.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_ceph_storage_2:ceph",
          "red_hat_openshift_container_storage_4:ceph"
        ],
        "known_not_affected": [
          "red_hat_ceph_storage_3:ceph",
          "red_hat_ceph_storage_4:ceph",
          "red_hat_enterprise_linux_7:ceph-common",
          "red_hat_enterprise_linux_8:ceph",
          "red_hat_openstack_platform_13_(queens):ceph",
          "red_hat_openstack_platform_15_(stein):ceph"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2020-1700"
        },
        {
          "category": "external",
          "summary": "RHBZ#1791691",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1791691"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2020-1700",
          "url": "https://www.cve.org/CVERecord?id=CVE-2020-1700"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2020-1700",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2020-1700"
        }
      ],
      "release_date": "2020-01-31T16:55:00+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "If Beast front end is in use, switch to CivetWeb to mitigate the issue. The following is an example of the /etc/ceph/ceph.conf file:\n\n\u003csnip\u003e\n...\n[client.rgw.node1]\nrgw frontends = civetweb\n...\n\u003c/snip\u003e",
          "product_ids": [
            "red_hat_ceph_storage_2:ceph",
            "red_hat_ceph_storage_3:ceph",
            "red_hat_ceph_storage_4:ceph",
            "red_hat_enterprise_linux_7:ceph-common",
            "red_hat_enterprise_linux_8:ceph",
            "red_hat_openshift_container_storage_4:ceph",
            "red_hat_openstack_platform_13_(queens):ceph",
            "red_hat_openstack_platform_15_(stein):ceph"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "red_hat_ceph_storage_2:ceph"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_openshift_container_storage_4:ceph"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "HIGH",
            "baseScore": 6.5,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_ceph_storage_2:ceph",
            "red_hat_ceph_storage_3:ceph",
            "red_hat_ceph_storage_4:ceph",
            "red_hat_enterprise_linux_7:ceph-common",
            "red_hat_enterprise_linux_8:ceph",
            "red_hat_openshift_container_storage_4:ceph",
            "red_hat_openstack_platform_13_(queens):ceph",
            "red_hat_openstack_platform_15_(stein):ceph"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_ceph_storage_2:ceph",
            "red_hat_ceph_storage_3:ceph",
            "red_hat_ceph_storage_4:ceph",
            "red_hat_enterprise_linux_7:ceph-common",
            "red_hat_enterprise_linux_8:ceph",
            "red_hat_openshift_container_storage_4:ceph",
            "red_hat_openstack_platform_13_(queens):ceph",
            "red_hat_openstack_platform_15_(stein):ceph"
          ]
        }
      ],
      "title": "ceph: connection leak in the RGW Beast front-end permits a DoS against the RGW server"
    }
  ]
}