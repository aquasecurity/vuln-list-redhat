{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2020/cve-2020-7471.json"
      }
    ],
    "title": "django: potential SQL injection via StringAgg(delimiter)",
    "tracking": {
      "current_release_date": "2024-11-19T15:17:32+00:00",
      "generator": {
        "date": "2024-11-19T15:17:32+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.2.1"
        }
      },
      "id": "CVE-2020-7471",
      "initial_release_date": "2020-02-03T00:00:00+00:00",
      "revision_history": [
        {
          "date": "2020-02-03T00:00:00+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2021-12-14T18:47:58+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2024-11-19T15:17:32+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 2",
                "product": {
                  "name": "Red Hat Ceph Storage 2",
                  "product_id": "red_hat_ceph_storage_2",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:2"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 2"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Ceph Storage 3",
                "product": {
                  "name": "Red Hat Ceph Storage 3",
                  "product_id": "red_hat_ceph_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:ceph_storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Ceph Storage 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Certification for Red Hat Enterprise Linux 7",
                "product": {
                  "name": "Red Hat Certification for Red Hat Enterprise Linux 7",
                  "product_id": "red_hat_certification_for_red_hat_enterprise_linux_7",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:certifications:1::el7"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Certification for Red Hat Enterprise Linux 7"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenStack Platform 10 (Newton)",
                "product": {
                  "name": "Red Hat OpenStack Platform 10 (Newton)",
                  "product_id": "red_hat_openstack_platform_10_(newton)",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openstack:10"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenStack Platform 10 (Newton)"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenStack Platform 13 (Queens)",
                "product": {
                  "name": "Red Hat OpenStack Platform 13 (Queens)",
                  "product_id": "red_hat_openstack_platform_13_(queens)",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openstack:13"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenStack Platform 13 (Queens)"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenStack Platform 15 (Stein)",
                "product": {
                  "name": "Red Hat OpenStack Platform 15 (Stein)",
                  "product_id": "red_hat_openstack_platform_15_(stein)",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openstack:15"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenStack Platform 15 (Stein)"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat OpenStack Platform 16 (Train)",
                "product": {
                  "name": "Red Hat OpenStack Platform 16 (Train)",
                  "product_id": "red_hat_openstack_platform_16_(train)",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openstack:16"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat OpenStack Platform 16 (Train)"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Satellite 6",
                "product": {
                  "name": "Red Hat Satellite 6",
                  "product_id": "red_hat_satellite_6",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:satellite:6"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Satellite 6"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Storage 3",
                "product": {
                  "name": "Red Hat Storage 3",
                  "product_id": "red_hat_storage_3",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:storage:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Storage 3"
          },
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Update Infrastructure 3 for Cloud Providers",
                "product": {
                  "name": "Red Hat Update Infrastructure 3 for Cloud Providers",
                  "product_id": "red_hat_update_infrastructure_3_for_cloud_providers",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:rhui:3"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Update Infrastructure 3 for Cloud Providers"
          },
          {
            "category": "product_version",
            "name": "python-django",
            "product": {
              "name": "python-django",
              "product_id": "python-django",
              "product_identification_helper": {
                "purl": "pkg:rpm/redhat/python-django?arch=src"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat Ceph Storage 2",
          "product_id": "red_hat_ceph_storage_2:python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_ceph_storage_2"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat Ceph Storage 3",
          "product_id": "red_hat_ceph_storage_3:python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_ceph_storage_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat Certification for Red Hat Enterprise Linux 7",
          "product_id": "red_hat_certification_for_red_hat_enterprise_linux_7:python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_certification_for_red_hat_enterprise_linux_7"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat OpenStack Platform 10 (Newton)",
          "product_id": "red_hat_openstack_platform_10_(newton):python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_openstack_platform_10_(newton)"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat OpenStack Platform 13 (Queens)",
          "product_id": "red_hat_openstack_platform_13_(queens):python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_openstack_platform_13_(queens)"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat OpenStack Platform 15 (Stein)",
          "product_id": "red_hat_openstack_platform_15_(stein):python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_openstack_platform_15_(stein)"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat OpenStack Platform 16 (Train)",
          "product_id": "red_hat_openstack_platform_16_(train):python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_openstack_platform_16_(train)"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat Satellite 6",
          "product_id": "red_hat_satellite_6:python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_satellite_6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat Storage 3",
          "product_id": "red_hat_storage_3:python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_storage_3"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "python-django as a component of Red Hat Update Infrastructure 3 for Cloud Providers",
          "product_id": "red_hat_update_infrastructure_3_for_cloud_providers:python-django"
        },
        "product_reference": "python-django",
        "relates_to_product_reference": "red_hat_update_infrastructure_3_for_cloud_providers"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2020-7471",
      "cwe": {
        "id": "CWE-89",
        "name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
      },
      "discovery_date": "2020-02-05T00:00:00+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "red_hat_ceph_storage_3:python-django",
            "red_hat_certification_for_red_hat_enterprise_linux_7:python-django"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "1798515"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A flaw was found in Django, where it may allow SQL injection if improperly sanitized data is used as a StringAgg delimiter.  If a suitably crafted delimiter is passed to a 'contrib.postgres.aggregates.StringAgg' instance, it is possible to break escaping and inject malicious SQL. An attacker could use this flaw to cause a denial of service, information disclosure, or privilege escalation.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "django: potential SQL injection via StringAgg(delimiter)",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "Even though the version of python-django as shipped in Red Hat Update Infrastructure contains the vulnerable code, the Product is not vulnerable because the vulnerable function is not used. Red Hat Update Infrastructure is based on pulp 2, which still uses MongoDB as database and not postgresql, where the flaw lies.\n\nAlthough Red Hat OpenStack Platform 13, 15, \u0026 16 contain the vulnerable code, postgresql is not a supported database hence the lowered impact.\n\nSatellite 6 versions include vulnerable version of python-django however vulnerability is not directly exposed through code since the product does not use 'StringAgg' delimiter implementation. This issue may be get fixed in future updates.\n\nRed Hat Update Infrastructure 3 is in Maintenance Support phase and product only fixing Critical or Important impact flaws. Please refer lifecycle page for more details: https://access.redhat.com/support/policy/updates/rhui",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_ceph_storage_2:python-django",
          "red_hat_openstack_platform_10_(newton):python-django",
          "red_hat_openstack_platform_13_(queens):python-django",
          "red_hat_openstack_platform_15_(stein):python-django",
          "red_hat_openstack_platform_16_(train):python-django",
          "red_hat_satellite_6:python-django",
          "red_hat_storage_3:python-django",
          "red_hat_update_infrastructure_3_for_cloud_providers:python-django"
        ],
        "known_not_affected": [
          "red_hat_ceph_storage_3:python-django",
          "red_hat_certification_for_red_hat_enterprise_linux_7:python-django"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2020-7471"
        },
        {
          "category": "external",
          "summary": "RHBZ#1798515",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1798515"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2020-7471",
          "url": "https://www.cve.org/CVERecord?id=CVE-2020-7471"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2020-7471",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2020-7471"
        }
      ],
      "release_date": "2020-02-03T00:00:00+00:00",
      "remediations": [
        {
          "category": "no_fix_planned",
          "details": "Out of support scope",
          "product_ids": [
            "red_hat_ceph_storage_2:python-django",
            "red_hat_openstack_platform_10_(newton):python-django"
          ]
        },
        {
          "category": "no_fix_planned",
          "details": "Will not fix",
          "product_ids": [
            "red_hat_openstack_platform_13_(queens):python-django",
            "red_hat_openstack_platform_15_(stein):python-django",
            "red_hat_openstack_platform_16_(train):python-django",
            "red_hat_satellite_6:python-django",
            "red_hat_update_infrastructure_3_for_cloud_providers:python-django"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "red_hat_storage_3:python-django"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "NONE",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseScore": 9.8,
            "baseSeverity": "CRITICAL"
          },
          "products": [
            "red_hat_ceph_storage_2:python-django",
            "red_hat_openstack_platform_10_(newton):python-django",
            "red_hat_openstack_platform_13_(queens):python-django",
            "red_hat_openstack_platform_15_(stein):python-django",
            "red_hat_openstack_platform_16_(train):python-django"
          ]
        },
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "LOW",
            "userInteraction": "NONE",
            "scope": "UNCHANGED",
            "confidentialityImpact": "NONE",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 0,
            "baseSeverity": "NONE"
          },
          "products": [
            "red_hat_satellite_6:python-django",
            "red_hat_storage_3:python-django",
            "red_hat_update_infrastructure_3_for_cloud_providers:python-django"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "red_hat_ceph_storage_2:python-django",
            "red_hat_openstack_platform_10_(newton):python-django"
          ]
        },
        {
          "category": "impact",
          "details": "Low",
          "product_ids": [
            "red_hat_openstack_platform_13_(queens):python-django",
            "red_hat_openstack_platform_15_(stein):python-django",
            "red_hat_openstack_platform_16_(train):python-django",
            "red_hat_satellite_6:python-django",
            "red_hat_storage_3:python-django",
            "red_hat_update_infrastructure_3_for_cloud_providers:python-django"
          ]
        }
      ],
      "title": "django: potential SQL injection via StringAgg(delimiter)"
    }
  ]
}