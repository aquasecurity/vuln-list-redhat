{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: jffs2: fix use-after-free in jffs2_clear_xattr_subsystem",
    "id": "2348186",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348186"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2021-47656",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\njffs2: fix use-after-free in jffs2_clear_xattr_subsystem\nWhen we mount a jffs2 image, assume that the first few blocks of\nthe image are normal and contain at least one xattr-related inode,\nbut the next block is abnormal. As a result, an error is returned\nin jffs2_scan_eraseblock(). jffs2_clear_xattr_subsystem() is then\ncalled in jffs2_build_filesystem() and then again in\njffs2_do_fill_super().\nFinally we can observe the following report:\n==================================================================\nBUG: KASAN: use-after-free in jffs2_clear_xattr_subsystem+0x95/0x6ac\nRead of size 8 at addr ffff8881243384e0 by task mount/719\nCall Trace:\ndump_stack+0x115/0x16b\njffs2_clear_xattr_subsystem+0x95/0x6ac\njffs2_do_fill_super+0x84f/0xc30\njffs2_fill_super+0x2ea/0x4c0\nmtd_get_sb+0x254/0x400\nmtd_get_sb_by_nr+0x4f/0xd0\nget_tree_mtd+0x498/0x840\njffs2_get_tree+0x25/0x30\nvfs_get_tree+0x8d/0x2e0\npath_mount+0x50f/0x1e50\ndo_mount+0x107/0x130\n__se_sys_mount+0x1c5/0x2f0\n__x64_sys_mount+0xc7/0x160\ndo_syscall_64+0x45/0x70\nentry_SYSCALL_64_after_hwframe+0x44/0xa9\nAllocated by task 719:\nkasan_save_stack+0x23/0x60\n__kasan_kmalloc.constprop.0+0x10b/0x120\nkasan_slab_alloc+0x12/0x20\nkmem_cache_alloc+0x1c0/0x870\njffs2_alloc_xattr_ref+0x2f/0xa0\njffs2_scan_medium.cold+0x3713/0x4794\njffs2_do_mount_fs.cold+0xa7/0x2253\njffs2_do_fill_super+0x383/0xc30\njffs2_fill_super+0x2ea/0x4c0\n[...]\nFreed by task 719:\nkmem_cache_free+0xcc/0x7b0\njffs2_free_xattr_ref+0x78/0x98\njffs2_clear_xattr_subsystem+0xa1/0x6ac\njffs2_do_mount_fs.cold+0x5e6/0x2253\njffs2_do_fill_super+0x383/0xc30\njffs2_fill_super+0x2ea/0x4c0\n[...]\nThe buggy address belongs to the object at ffff8881243384b8\nwhich belongs to the cache jffs2_xattr_ref of size 48\nThe buggy address is located 40 bytes inside of\n48-byte region [ffff8881243384b8, ffff8881243384e8)\n[...]\n==================================================================\nThe triggering of the BUG is shown in the following stack:\n-----------------------------------------------------------\njffs2_fill_super\njffs2_do_fill_super\njffs2_do_mount_fs\njffs2_build_filesystem\njffs2_scan_medium\njffs2_scan_eraseblock        \u003c--- ERROR\njffs2_clear_xattr_subsystem    \u003c--- free\njffs2_clear_xattr_subsystem        \u003c--- free again\n-----------------------------------------------------------\nAn error is returned in jffs2_do_mount_fs(). If the error is returned\nby jffs2_sum_init(), the jffs2_clear_xattr_subsystem() does not need to\nbe executed. If the error is returned by jffs2_build_filesystem(), the\njffs2_clear_xattr_subsystem() also does not need to be executed again.\nSo move jffs2_clear_xattr_subsystem() from 'out_inohash' to 'out_root'\nto fix this UAF problem."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2021-47656\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-47656\nhttps://lore.kernel.org/linux-cve-announce/2025022650-CVE-2021-47656-0abd@gregkh/T"
  ]
}