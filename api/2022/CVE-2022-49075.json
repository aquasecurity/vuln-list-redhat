{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: btrfs: fix qgroup reserve overflow the qgroup limit",
    "id": "2347794",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2347794"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49075",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nbtrfs: fix qgroup reserve overflow the qgroup limit\nWe use extent_changeset-\u003ebytes_changed in qgroup_reserve_data() to record\nhow many bytes we set for EXTENT_QGROUP_RESERVED state. Currently the\nbytes_changed is set as \"unsigned int\", and it will overflow if we try to\nfallocate a range larger than 4GiB. The result is we reserve less bytes\nand eventually break the qgroup limit.\nUnlike regular buffered/direct write, which we use one changeset for\neach ordered extent, which can never be larger than 256M.  For\nfallocate, we use one changeset for the whole range, thus it no longer\nrespects the 256M per extent limit, and caused the problem.\nThe following example test script reproduces the problem:\n$ cat qgroup-overflow.sh\n#!/bin/bash\nDEV=/dev/sdj\nMNT=/mnt/sdj\nmkfs.btrfs -f $DEV\nmount $DEV $MNT\n# Set qgroup limit to 2GiB.\nbtrfs quota enable $MNT\nbtrfs qgroup limit 2G $MNT\n# Try to fallocate a 3GiB file. This should fail.\necho\necho \"Try to fallocate a 3GiB file...\"\nfallocate -l 3G $MNT/3G.file\n# Try to fallocate a 5GiB file.\necho\necho \"Try to fallocate a 5GiB file...\"\nfallocate -l 5G $MNT/5G.file\n# See we break the qgroup limit.\necho\nsync\nbtrfs qgroup show -r $MNT\numount $MNT\nWhen running the test:\n$ ./qgroup-overflow.sh\n(...)\nTry to fallocate a 3GiB file...\nfallocate: fallocate failed: Disk quota exceeded\nTry to fallocate a 5GiB file...\nqgroupid         rfer         excl     max_rfer\n--------         ----         ----     --------\n0/5           5.00GiB      5.00GiB      2.00GiB\nSince we have no control of how bytes_changed is used, it's better to\nset it to u64."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49075\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49075\nhttps://lore.kernel.org/linux-cve-announce/2025022656-CVE-2022-49075-ad31@gregkh/T"
  ]
}