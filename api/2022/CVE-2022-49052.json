{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: mm: fix unexpected zeroed page mapping with zram swap",
    "id": "2347838",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2347838"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49052",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nmm: fix unexpected zeroed page mapping with zram swap\nTwo processes under CLONE_VM cloning, user process can be corrupted by\nseeing zeroed page unexpectedly.\nCPU A                        CPU B\ndo_swap_page                do_swap_page\nSWP_SYNCHRONOUS_IO path     SWP_SYNCHRONOUS_IO path\nswap_readpage valid data\nswap_slot_free_notify\ndelete zram entry\nswap_readpage zeroed(invalid) data\npte_lock\nmap the *zero data* to userspace\npte_unlock\npte_lock\nif (!pte_same)\ngoto out_nomap;\npte_unlock\nreturn and next refault will\nread zeroed data\nThe swap_slot_free_notify is bogus for CLONE_VM case since it doesn't\nincrease the refcount of swap slot at copy_mm so it couldn't catch up\nwhether it's safe or not to discard data from backing device.  In the\ncase, only the lock it could rely on to synchronize swap slot freeing is\npage table lock.  Thus, this patch gets rid of the swap_slot_free_notify\nfunction.  With this patch, CPU A will see correct data.\nCPU A                        CPU B\ndo_swap_page                do_swap_page\nSWP_SYNCHRONOUS_IO path     SWP_SYNCHRONOUS_IO path\nswap_readpage original data\npte_lock\nmap the original data\nswap_free\nswap_range_free\nbd_disk-\u003efops-\u003eswap_slot_free_notify\nswap_readpage read zeroed data\npte_unlock\npte_lock\nif (!pte_same)\ngoto out_nomap;\npte_unlock\nreturn\non next refault will see mapped data by CPU B\nThe concern of the patch would increase memory consumption since it\ncould keep wasted memory with compressed form in zram as well as\nuncompressed form in address space.  However, most of cases of zram uses\nno readahead and do_swap_page is followed by swap_free so it will free\nthe compressed form from in zram quickly."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49052\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49052\nhttps://lore.kernel.org/linux-cve-announce/2025022651-CVE-2022-49052-4ea2@gregkh/T"
  ]
}