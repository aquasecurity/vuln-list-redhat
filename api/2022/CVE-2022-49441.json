{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: tty: fix deadlock caused by calling printk() under tty_port-\u003elock",
    "id": "2348057",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348057"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49441",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\ntty: fix deadlock caused by calling printk() under tty_port-\u003elock\npty_write() invokes kmalloc() which may invoke a normal printk() to print\nfailure message.  This can cause a deadlock in the scenario reported by\nsyz-bot below:\nCPU0              CPU1                    CPU2\n----              ----                    ----\nlock(console_owner);\nlock(\u0026port_lock_key);\nlock(\u0026port-\u003elock);\nlock(\u0026port_lock_key);\nlock(\u0026port-\u003elock);\nlock(console_owner);\nAs commit dbdda842fe96 (\"printk: Add console owner and waiter logic to\nload balance console writes\") said, such deadlock can be prevented by\nusing printk_deferred() in kmalloc() (which is invoked in the section\nguarded by the port-\u003elock).  But there are too many printk() on the\nkmalloc() path, and kmalloc() can be called from anywhere, so changing\nprintk() to printk_deferred() is too complicated and inelegant.\nTherefore, this patch chooses to specify __GFP_NOWARN to kmalloc(), so\nthat printk() will not be called, and this deadlock problem can be\navoided.\nSyzbot reported the following lockdep error:\n======================================================\nWARNING: possible circular locking dependency detected\n5.4.143-00237-g08ccc19a-dirty #10 Not tainted\n------------------------------------------------------\nsyz-executor.4/29420 is trying to acquire lock:\nffffffff8aedb2a0 (console_owner){....}-{0:0}, at: console_trylock_spinning kernel/printk/printk.c:1752 [inline]\nffffffff8aedb2a0 (console_owner){....}-{0:0}, at: vprintk_emit+0x2ca/0x470 kernel/printk/printk.c:2023\nbut task is already holding lock:\nffff8880119c9158 (\u0026port-\u003elock){-.-.}-{2:2}, at: pty_write+0xf4/0x1f0 drivers/tty/pty.c:120\nwhich lock already depends on the new lock.\nthe existing dependency chain (in reverse order) is:\n-\u003e #2 (\u0026port-\u003elock){-.-.}-{2:2}:\n__raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:110 [inline]\n_raw_spin_lock_irqsave+0x35/0x50 kernel/locking/spinlock.c:159\ntty_port_tty_get drivers/tty/tty_port.c:288 [inline]          \u003c-- lock(\u0026port-\u003elock);\ntty_port_default_wakeup+0x1d/0xb0 drivers/tty/tty_port.c:47\nserial8250_tx_chars+0x530/0xa80 drivers/tty/serial/8250/8250_port.c:1767\nserial8250_handle_irq.part.0+0x31f/0x3d0 drivers/tty/serial/8250/8250_port.c:1854\nserial8250_handle_irq drivers/tty/serial/8250/8250_port.c:1827 [inline] \u003c-- lock(\u0026port_lock_key);\nserial8250_default_handle_irq+0xb2/0x220 drivers/tty/serial/8250/8250_port.c:1870\nserial8250_interrupt+0xfd/0x200 drivers/tty/serial/8250/8250_core.c:126\n__handle_irq_event_percpu+0x109/0xa50 kernel/irq/handle.c:156\n[...]\n-\u003e #1 (\u0026port_lock_key){-.-.}-{2:2}:\n__raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:110 [inline]\n_raw_spin_lock_irqsave+0x35/0x50 kernel/locking/spinlock.c:159\nserial8250_console_write+0x184/0xa40 drivers/tty/serial/8250/8250_port.c:3198\n\u003c-- lock(\u0026port_lock_key);\ncall_console_drivers kernel/printk/printk.c:1819 [inline]\nconsole_unlock+0x8cb/0xd00 kernel/printk/printk.c:2504\nvprintk_emit+0x1b5/0x470 kernel/printk/printk.c:2024\u003c-- lock(console_owner);\nvprintk_func+0x8d/0x250 kernel/printk/printk_safe.c:394\nprintk+0xba/0xed kernel/printk/printk.c:2084\nregister_console+0x8b3/0xc10 kernel/printk/printk.c:2829\nuniv8250_console_init+0x3a/0x46 drivers/tty/serial/8250/8250_core.c:681\nconsole_init+0x49d/0x6d3 kernel/printk/printk.c:2915\nstart_kernel+0x5e9/0x879 init/main.c:713\nsecondary_startup_64+0xa4/0xb0 arch/x86/kernel/head_64.S:241\n-\u003e #0 (console_owner){....}-{0:0}:\n[...]\nlock_acquire+0x127/0x340 kernel/locking/lockdep.c:4734\nconsole_trylock_spinning kernel/printk/printk.c:1773 \n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49441\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49441\nhttps://lore.kernel.org/linux-cve-announce/2025022657-CVE-2022-49441-8b58@gregkh/T"
  ]
}