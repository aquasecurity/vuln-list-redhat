{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-07-16T00:00:00Z",
  "bugzilla": {
    "description": "kernel: vhost: fix hung thread due to erroneous iotlb entries",
    "id": "2298206",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2298206"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-835",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-48862",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nvhost: fix hung thread due to erroneous iotlb entries\nIn vhost_iotlb_add_range_ctx(), range size can overflow to 0 when\nstart is 0 and last is ULONG_MAX. One instance where it can happen\nis when userspace sends an IOTLB message with iova=size=uaddr=0\n(vhost_process_iotlb_msg). So, an entry with size = 0, start = 0,\nlast = ULONG_MAX ends up in the iotlb. Next time a packet is sent,\niotlb_access_ok() loops indefinitely due to that erroneous entry.\nCall Trace:\n\u003cTASK\u003e\niotlb_access_ok+0x21b/0x3e0 drivers/vhost/vhost.c:1340\nvq_meta_prefetch+0xbc/0x280 drivers/vhost/vhost.c:1366\nvhost_transport_do_send_pkt+0xe0/0xfd0 drivers/vhost/vsock.c:104\nvhost_worker+0x23d/0x3d0 drivers/vhost/vhost.c:372\nkthread+0x2e9/0x3a0 kernel/kthread.c:377\nret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:295\n\u003c/TASK\u003e\nReported by syzbot at:\nhttps://syzkaller.appspot.com/bug?extid=0abd373e2e50d704db87\nTo fix this, do two things:\n1. Return -EINVAL in vhost_chr_write_iter() when userspace asks to map\na range with size 0.\n2. Fix vhost_iotlb_add_range_ctx() to handle the range [0, ULONG_MAX]\nby splitting it into two entries."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-48862\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48862\nhttps://lore.kernel.org/linux-cve-announce/2024071628-CVE-2022-48862-0c27@gregkh/T"
  ]
}