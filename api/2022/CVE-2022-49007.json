{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-10-21T00:00:00Z",
  "bugzilla": {
    "description": "kernel: nilfs2: fix NULL pointer dereference in nilfs_palloc_commit_free_entry()",
    "id": "2320740",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2320740"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-476",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49007",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnilfs2: fix NULL pointer dereference in nilfs_palloc_commit_free_entry()\nSyzbot reported a null-ptr-deref bug:\nNILFS (loop0): segctord starting. Construction interval = 5 seconds, CP\nfrequency \u003c 30 seconds\ngeneral protection fault, probably for non-canonical address\n0xdffffc0000000002: 0000 [#1] PREEMPT SMP KASAN\nKASAN: null-ptr-deref in range [0x0000000000000010-0x0000000000000017]\nCPU: 1 PID: 3603 Comm: segctord Not tainted\n6.1.0-rc2-syzkaller-00105-gb229b6ca5abb #0\nHardware name: Google Compute Engine/Google Compute Engine, BIOS Google\n10/11/2022\nRIP: 0010:nilfs_palloc_commit_free_entry+0xe5/0x6b0\nfs/nilfs2/alloc.c:608\nCode: 00 00 00 00 fc ff df 80 3c 02 00 0f 85 cd 05 00 00 48 b8 00 00 00\n00 00 fc ff df 4c 8b 73 08 49 8d 7e 10 48 89 fa 48 c1 ea 03 \u003c80\u003e 3c 02\n00 0f 85 26 05 00 00 49 8b 46 10 be a6 00 00 00 48 c7 c7\nRSP: 0018:ffffc90003dff830 EFLAGS: 00010212\nRAX: dffffc0000000000 RBX: ffff88802594e218 RCX: 000000000000000d\nRDX: 0000000000000002 RSI: 0000000000002000 RDI: 0000000000000010\nRBP: ffff888071880222 R08: 0000000000000005 R09: 000000000000003f\nR10: 000000000000000d R11: 0000000000000000 R12: ffff888071880158\nR13: ffff88802594e220 R14: 0000000000000000 R15: 0000000000000004\nFS:  0000000000000000(0000) GS:ffff8880b9b00000(0000)\nknlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007fb1c08316a8 CR3: 0000000018560000 CR4: 0000000000350ee0\nCall Trace:\n\u003cTASK\u003e\nnilfs_dat_commit_free fs/nilfs2/dat.c:114 [inline]\nnilfs_dat_commit_end+0x464/0x5f0 fs/nilfs2/dat.c:193\nnilfs_dat_commit_update+0x26/0x40 fs/nilfs2/dat.c:236\nnilfs_btree_commit_update_v+0x87/0x4a0 fs/nilfs2/btree.c:1940\nnilfs_btree_commit_propagate_v fs/nilfs2/btree.c:2016 [inline]\nnilfs_btree_propagate_v fs/nilfs2/btree.c:2046 [inline]\nnilfs_btree_propagate+0xa00/0xd60 fs/nilfs2/btree.c:2088\nnilfs_bmap_propagate+0x73/0x170 fs/nilfs2/bmap.c:337\nnilfs_collect_file_data+0x45/0xd0 fs/nilfs2/segment.c:568\nnilfs_segctor_apply_buffers+0x14a/0x470 fs/nilfs2/segment.c:1018\nnilfs_segctor_scan_file+0x3f4/0x6f0 fs/nilfs2/segment.c:1067\nnilfs_segctor_collect_blocks fs/nilfs2/segment.c:1197 [inline]\nnilfs_segctor_collect fs/nilfs2/segment.c:1503 [inline]\nnilfs_segctor_do_construct+0x12fc/0x6af0 fs/nilfs2/segment.c:2045\nnilfs_segctor_construct+0x8e3/0xb30 fs/nilfs2/segment.c:2379\nnilfs_segctor_thread_construct fs/nilfs2/segment.c:2487 [inline]\nnilfs_segctor_thread+0x3c3/0xf30 fs/nilfs2/segment.c:2570\nkthread+0x2e4/0x3a0 kernel/kthread.c:376\nret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:306\n\u003c/TASK\u003e\n...\nIf DAT metadata file is corrupted on disk, there is a case where\nreq-\u003epr_desc_bh is NULL and blocknr is 0 at nilfs_dat_commit_end() during\na b-tree operation that cascadingly updates ancestor nodes of the b-tree,\nbecause nilfs_dat_commit_alloc() for a lower level block can initialize\nthe blocknr on the same DAT entry between nilfs_dat_prepare_end() and\nnilfs_dat_commit_end().\nIf this happens, nilfs_dat_commit_end() calls nilfs_dat_commit_free()\nwithout valid buffer heads in req-\u003epr_desc_bh and req-\u003epr_bitmap_bh, and\ncauses the NULL pointer dereference above in\nnilfs_palloc_commit_free_entry() function, which leads to a crash.\nFix this by adding a NULL check on req-\u003epr_desc_bh and req-\u003epr_bitmap_bh\nbefore nilfs_palloc_commit_free_entry() in nilfs_dat_commit_free().\nThis also calls nilfs_error() in that case to notify that there is a fatal\nflaw in the filesystem metadata and prevent further operations."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49007\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49007\nhttps://lore.kernel.org/linux-cve-announce/2024102151-CVE-2022-49007-c02b@gregkh/T"
  ]
}