{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: macsec: fix UAF bug for real_dev",
    "id": "2348056",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348056"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49390",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nmacsec: fix UAF bug for real_dev\nCreate a new macsec device but not get reference to real_dev. That can\nnot ensure that real_dev is freed after macsec. That will trigger the\nUAF bug for real_dev as following:\n==================================================================\nBUG: KASAN: use-after-free in macsec_get_iflink+0x5f/0x70 drivers/net/macsec.c:3662\nCall Trace:\n...\nmacsec_get_iflink+0x5f/0x70 drivers/net/macsec.c:3662\ndev_get_iflink+0x73/0xe0 net/core/dev.c:637\ndefault_operstate net/core/link_watch.c:42 [inline]\nrfc2863_policy+0x233/0x2d0 net/core/link_watch.c:54\nlinkwatch_do_dev+0x2a/0x150 net/core/link_watch.c:161\nAllocated by task 22209:\n...\nalloc_netdev_mqs+0x98/0x1100 net/core/dev.c:10549\nrtnl_create_link+0x9d7/0xc00 net/core/rtnetlink.c:3235\nveth_newlink+0x20e/0xa90 drivers/net/veth.c:1748\nFreed by task 8:\n...\nkfree+0xd6/0x4d0 mm/slub.c:4552\nkvfree+0x42/0x50 mm/util.c:615\ndevice_release+0x9f/0x240 drivers/base/core.c:2229\nkobject_cleanup lib/kobject.c:673 [inline]\nkobject_release lib/kobject.c:704 [inline]\nkref_put include/linux/kref.h:65 [inline]\nkobject_put+0x1c8/0x540 lib/kobject.c:721\nnetdev_run_todo+0x72e/0x10b0 net/core/dev.c:10327\nAfter commit faab39f63c1f (\"net: allow out-of-order netdev unregistration\")\nand commit e5f80fcf869a (\"ipv6: give an IPv6 dev to blackhole_netdev\"), we\ncan add dev_hold_track() in macsec_dev_init() and dev_put_track() in\nmacsec_free_netdev() to fix the problem."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49390\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49390\nhttps://lore.kernel.org/linux-cve-announce/2025022649-CVE-2022-49390-1583@gregkh/T"
  ]
}