{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-07-16T00:00:00Z",
  "bugzilla": {
    "description": "kernel: NFC: port100: fix use-after-free in port100_send_complete",
    "id": "2298198",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2298198"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.6",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-48857",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nNFC: port100: fix use-after-free in port100_send_complete\nSyzbot reported UAF in port100_send_complete(). The root case is in\nmissing usb_kill_urb() calls on error handling path of -\u003eprobe function.\nport100_send_complete() accesses devm allocated memory which will be\nfreed on probe failure. We should kill this urbs before returning an\nerror from probe function to prevent reported use-after-free\nFail log:\nBUG: KASAN: use-after-free in port100_send_complete+0x16e/0x1a0 drivers/nfc/port100.c:935\nRead of size 1 at addr ffff88801bb59540 by task ksoftirqd/2/26\n...\nCall Trace:\n\u003cTASK\u003e\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106\nprint_address_description.constprop.0.cold+0x8d/0x303 mm/kasan/report.c:255\n__kasan_report mm/kasan/report.c:442 [inline]\nkasan_report.cold+0x83/0xdf mm/kasan/report.c:459\nport100_send_complete+0x16e/0x1a0 drivers/nfc/port100.c:935\n__usb_hcd_giveback_urb+0x2b0/0x5c0 drivers/usb/core/hcd.c:1670\n...\nAllocated by task 1255:\nkasan_save_stack+0x1e/0x40 mm/kasan/common.c:38\nkasan_set_track mm/kasan/common.c:45 [inline]\nset_alloc_info mm/kasan/common.c:436 [inline]\n____kasan_kmalloc mm/kasan/common.c:515 [inline]\n____kasan_kmalloc mm/kasan/common.c:474 [inline]\n__kasan_kmalloc+0xa6/0xd0 mm/kasan/common.c:524\nalloc_dr drivers/base/devres.c:116 [inline]\ndevm_kmalloc+0x96/0x1d0 drivers/base/devres.c:823\ndevm_kzalloc include/linux/device.h:209 [inline]\nport100_probe+0x8a/0x1320 drivers/nfc/port100.c:1502\nFreed by task 1255:\nkasan_save_stack+0x1e/0x40 mm/kasan/common.c:38\nkasan_set_track+0x21/0x30 mm/kasan/common.c:45\nkasan_set_free_info+0x20/0x30 mm/kasan/generic.c:370\n____kasan_slab_free mm/kasan/common.c:366 [inline]\n____kasan_slab_free+0xff/0x140 mm/kasan/common.c:328\nkasan_slab_free include/linux/kasan.h:236 [inline]\n__cache_free mm/slab.c:3437 [inline]\nkfree+0xf8/0x2b0 mm/slab.c:3794\nrelease_nodes+0x112/0x1a0 drivers/base/devres.c:501\ndevres_release_all+0x114/0x190 drivers/base/devres.c:530\nreally_probe+0x626/0xcc0 drivers/base/dd.c:670"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-48857\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48857\nhttps://lore.kernel.org/linux-cve-announce/2024071627-CVE-2022-48857-e0b2@gregkh/T"
  ]
}