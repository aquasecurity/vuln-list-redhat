{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-07-16T00:00:00Z",
  "bugzilla": {
    "description": "kernel: tracing/osnoise: Do not unregister events twice",
    "id": "2298189",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2298189"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-399",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-48848",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\ntracing/osnoise: Do not unregister events twice\nNicolas reported that using:\n# trace-cmd record -e all -M 10 -p osnoise --poll\nResulted in the following kernel warning:\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 1217 at kernel/tracepoint.c:404 tracepoint_probe_unregister+0x280/0x370\n[...]\nCPU: 0 PID: 1217 Comm: trace-cmd Not tainted 5.17.0-rc6-next-20220307-nico+ #19\nRIP: 0010:tracepoint_probe_unregister+0x280/0x370\n[...]\nCR2: 00007ff919b29497 CR3: 0000000109da4005 CR4: 0000000000170ef0\nCall Trace:\n\u003cTASK\u003e\nosnoise_workload_stop+0x36/0x90\ntracing_set_tracer+0x108/0x260\ntracing_set_trace_write+0x94/0xd0\n? __check_object_size.part.0+0x10a/0x150\n? selinux_file_permission+0x104/0x150\nvfs_write+0xb5/0x290\nksys_write+0x5f/0xe0\ndo_syscall_64+0x3b/0x90\nentry_SYSCALL_64_after_hwframe+0x44/0xae\nRIP: 0033:0x7ff919a18127\n[...]\n---[ end trace 0000000000000000 ]---\nThe warning complains about an attempt to unregister an\nunregistered tracepoint.\nThis happens on trace-cmd because it first stops tracing, and\nthen switches the tracer to nop. Which is equivalent to:\n# cd /sys/kernel/tracing/\n# echo osnoise \u003e current_tracer\n# echo 0 \u003e tracing_on\n# echo nop \u003e current_tracer\nThe osnoise tracer stops the workload when no trace instance\nis actually collecting data. This can be caused both by\ndisabling tracing or disabling the tracer itself.\nTo avoid unregistering events twice, use the existing\ntrace_osnoise_callback_enabled variable to check if the events\n(and the workload) are actually active before trying to\ndeactivate them."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-48848\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48848\nhttps://lore.kernel.org/linux-cve-announce/2024071624-CVE-2022-48848-3cfb@gregkh/T"
  ]
}