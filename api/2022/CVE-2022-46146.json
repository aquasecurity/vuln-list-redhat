{
  "affected_release": [
    {
      "product_name": "Red Hat OpenShift Container Platform 4.11",
      "release_date": "2023-09-13T00:00:00Z",
      "advisory": "RHSA-2023:5001",
      "package": "openshift4/ose-thanos-rhel8:v4.11.0-202308311243.p0.g99b6e03.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.11::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.12",
      "release_date": "2023-05-10T00:00:00Z",
      "advisory": "RHSA-2023:2110",
      "package": "openshift4/ose-thanos-rhel8:v4.12.0-202305022015.p0.g9f2b5ff.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.12::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.13",
      "release_date": "2023-05-17T00:00:00Z",
      "advisory": "RHSA-2023:1326",
      "package": "openshift4/ose-kube-state-metrics:v4.13.0-202304190216.p0.g4b96984.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.13::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.13",
      "release_date": "2023-05-17T00:00:00Z",
      "advisory": "RHSA-2023:1326",
      "package": "openshift4/ose-prometheus:v4.13.0-202305020815.p0.g8279148.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.13::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.13",
      "release_date": "2023-05-17T00:00:00Z",
      "advisory": "RHSA-2023:1326",
      "package": "openshift4/ose-prometheus-alertmanager:v4.13.0-202304190216.p0.gf44d574.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.13::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.13",
      "release_date": "2023-05-17T00:00:00Z",
      "advisory": "RHSA-2023:1326",
      "package": "openshift4/ose-prometheus-node-exporter:v4.13.0-202304190216.p0.g10dc380.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.13::el8"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.13",
      "release_date": "2023-05-17T00:00:00Z",
      "advisory": "RHSA-2023:1326",
      "package": "openshift4/ose-thanos-rhel8:v4.13.0-202304190216.p0.gb6f11a5.assembly.stream",
      "cpe": "cpe:/a:redhat:openshift:4.13::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Not affected",
      "package_name": "openshift-logging/logging-loki-rhel8",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Not affected",
      "package_name": "openshift-logging/lokistack-gateway-rhel9",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Not affected",
      "package_name": "openshift-logging/opa-openshift-rhel8",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/acm-grafana-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/acm-prometheus-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/memcached-exporter-rhel9",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/node-exporter-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/prometheus-alertmanager-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/prometheus-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/rbac-query-proxy-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/thanos-receive-controller-rhel8",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Not affected",
      "package_name": "rhacm2/thanos-rhel7",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "grafana",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "openshift4/metallb-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "openshift4/ose-cluster-monitoring-operator",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "openshift4/ose-grafana",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "openshift4/ose-prometheus-rhel9-operator",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "openshift4/ose-prom-label-proxy",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Will not fix",
      "package_name": "openshift-tech-preview/metallb-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 2",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-rhel8-operator",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:2"
    },
    {
      "product_name": "Red Hat Quay 3",
      "fix_state": "Will not fix",
      "package_name": "quay/quay-rhel8",
      "cpe": "cpe:/a:redhat:quay:3"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-11-29T00:00:00Z",
  "bugzilla": {
    "description": "exporter-toolkit: authentication bypass via cache poisoning",
    "id": "2149436",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2149436"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-305",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-46146",
  "document_distribution": "",
  "details": [
    "Prometheus Exporter Toolkit is a utility package to build exporters. Prior to versions 0.7.2 and 0.8.2, if someone has access to a Prometheus web.yml file and users' bcrypted passwords, they can bypass security by poisoning the built-in authentication cache. Versions 0.7.2 and 0.8.2 contain a fix for the issue. There is no workaround, but attacker must have access to the hashed password to use this functionality.",
    "A flaw was found in exporter-toolkit. A request can be forged by an attacker to poison the internal cache used to cache hashes and make subsequent successful requests. This cache is used to limit side channel attacks that could tell an attacker if a user is present in the file or not. Prometheus and its exporters can be secured by a web.yml file that specifies usernames and hashed passwords for basic authentication. Passwords are hashed with bcrypt, which means that even if you have access to the hash, it is very hard to find the original password. However, due to the way this mechanism was implemented in the exporter toolkit, if the hashed password is known, it is possible to authenticate against Prometheus."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-46146\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-46146\nhttp://www.openwall.com/lists/oss-security/2022/11/29/1\nhttp://www.openwall.com/lists/oss-security/2022/11/29/2\nhttps://github.com/prometheus/exporter-toolkit/commit/5b1eab34484ddd353986bce736cd119d863e4ff5\nhttps://github.com/prometheus/exporter-toolkit/security/advisories/GHSA-7rg2-cxvp-9p7p"
  ]
}