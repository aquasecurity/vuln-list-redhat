{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-08-21T00:00:00Z",
  "bugzilla": {
    "description": "kernel: Bluetooth: hci_qca: Fix driver shutdown on closed serdev",
    "id": "2306399",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2306399"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "Red Hat Enterprise Linux is not impacted by this CVE, as this vulnerability does not affect the specific versions or configurations of the Linux kernel used in its distributions. This ensures that users of Red Hat Enterprise Linux are not exposed to the potential risks associated with this issue and no further action or mitigation is necessary for systems running this operating system.",
  "acknowledgement": "",
  "name": "CVE-2022-48878",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nBluetooth: hci_qca: Fix driver shutdown on closed serdev\nThe driver shutdown callback (which sends EDL_SOC_RESET to the device\nover serdev) should not be invoked when HCI device is not open (e.g. if\nhci_dev_open_sync() failed), because the serdev and its TTY are not open\neither.  Also skip this step if device is powered off\n(qca_power_shutdown()).\nThe shutdown callback causes use-after-free during system reboot with\nQualcomm Atheros Bluetooth:\nUnable to handle kernel paging request at virtual address\n0072662f67726fd7\n...\nCPU: 6 PID: 1 Comm: systemd-shutdow Tainted: G        W\n6.1.0-rt5-00325-g8a5f56bcfcca #8\nHardware name: Qualcomm Technologies, Inc. Robotics RB5 (DT)\nCall trace:\ntty_driver_flush_buffer+0x4/0x30\nserdev_device_write_flush+0x24/0x34\nqca_serdev_shutdown+0x80/0x130 [hci_uart]\ndevice_shutdown+0x15c/0x260\nkernel_restart+0x48/0xac\nKASAN report:\nBUG: KASAN: use-after-free in tty_driver_flush_buffer+0x1c/0x50\nRead of size 8 at addr ffff16270c2e0018 by task systemd-shutdow/1\nCPU: 7 PID: 1 Comm: systemd-shutdow Not tainted\n6.1.0-next-20221220-00014-gb85aaf97fb01-dirty #28\nHardware name: Qualcomm Technologies, Inc. Robotics RB5 (DT)\nCall trace:\ndump_backtrace.part.0+0xdc/0xf0\nshow_stack+0x18/0x30\ndump_stack_lvl+0x68/0x84\nprint_report+0x188/0x488\nkasan_report+0xa4/0xf0\n__asan_load8+0x80/0xac\ntty_driver_flush_buffer+0x1c/0x50\nttyport_write_flush+0x34/0x44\nserdev_device_write_flush+0x48/0x60\nqca_serdev_shutdown+0x124/0x274\ndevice_shutdown+0x1e8/0x350\nkernel_restart+0x48/0xb0\n__do_sys_reboot+0x244/0x2d0\n__arm64_sys_reboot+0x54/0x70\ninvoke_syscall+0x60/0x190\nel0_svc_common.constprop.0+0x7c/0x160\ndo_el0_svc+0x44/0xf0\nel0_svc+0x2c/0x6c\nel0t_64_sync_handler+0xbc/0x140\nel0t_64_sync+0x190/0x194",
    "A vulnerability was found in the Linux kernel's bluetooth driver hci_qca.c. If the driver's shutdown callback is invoked while the HCI device is not open, it may cause a use-after-free situation and potentially lead to a kernel panic during system reboot."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-48878\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48878\nhttps://lore.kernel.org/linux-cve-announce/2024082107-CVE-2022-48878-5802@gregkh/T"
  ]
}