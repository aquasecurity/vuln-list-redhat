{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: powerpc: Fix virt_addr_valid() for 64-bit Book3E \u0026#38; 32-bit",
    "id": "2348129",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348129"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49067",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\npowerpc: Fix virt_addr_valid() for 64-bit Book3E \u0026 32-bit\nmpe: On 64-bit Book3E vmalloc space starts at 0x8000000000000000.\nBecause of the way __pa() works we have:\n__pa(0x8000000000000000) == 0, and therefore\nvirt_to_pfn(0x8000000000000000) == 0, and therefore\nvirt_addr_valid(0x8000000000000000) == true\nWhich is wrong, virt_addr_valid() should be false for vmalloc space.\nIn fact all vmalloc addresses that alias with a valid PFN will return\ntrue from virt_addr_valid(). That can cause bugs with hardened usercopy\nas described below by Kefeng Wang:\nWhen running ethtool eth0 on 64-bit Book3E, a BUG occurred:\nusercopy: Kernel memory exposure attempt detected from SLUB object not in SLUB page?! (offset 0, size 1048)!\nkernel BUG at mm/usercopy.c:99\n...\nusercopy_abort+0x64/0xa0 (unreliable)\n__check_heap_object+0x168/0x190\n__check_object_size+0x1a0/0x200\ndev_ethtool+0x2494/0x2b20\ndev_ioctl+0x5d0/0x770\nsock_do_ioctl+0xf0/0x1d0\nsock_ioctl+0x3ec/0x5a0\n__se_sys_ioctl+0xf0/0x160\nsystem_call_exception+0xfc/0x1f0\nsystem_call_common+0xf8/0x200\nThe code shows below,\ndata = vzalloc(array_size(gstrings.len, ETH_GSTRING_LEN));\ncopy_to_user(useraddr, data, gstrings.len * ETH_GSTRING_LEN))\nThe data is alloced by vmalloc(), virt_addr_valid(ptr) will return true\non 64-bit Book3E, which leads to the panic.\nAs commit 4dd7554a6456 (\"powerpc/64: Add VIRTUAL_BUG_ON checks for __va\nand __pa addresses\") does, make sure the virt addr above PAGE_OFFSET in\nthe virt_addr_valid() for 64-bit, also add upper limit check to make\nsure the virt is below high_memory.\nMeanwhile, for 32-bit PAGE_OFFSET is the virtual address of the start\nof lowmem, high_memory is the upper low virtual address, the check is\nsuitable for 32-bit, this will fix the issue mentioned in commit\n602946ec2f90 (\"powerpc: Set max_mapnr correctly\") too.\nOn 32-bit there is a similar problem with high memory, that was fixed in\ncommit 602946ec2f90 (\"powerpc: Set max_mapnr correctly\"), but that\ncommit breaks highmem and needs to be reverted.\nWe can't easily fix __pa(), we have code that relies on its current\nbehaviour. So for now add extra checks to virt_addr_valid().\nFor 64-bit Book3S the extra checks are not necessary, the combination of\nvirt_to_pfn() and pfn_valid() should yield the correct result, but they\nare harmless.\n[mpe: Add additional change log detail]"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49067\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49067\nhttps://lore.kernel.org/linux-cve-announce/2025022654-CVE-2022-49067-94d7@gregkh/T"
  ]
}