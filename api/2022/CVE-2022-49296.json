{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: ceph: fix possible deadlock when holding Fwb to get inline_data",
    "id": "2347701",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2347701"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49296",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nceph: fix possible deadlock when holding Fwb to get inline_data\n1, mount with wsync.\n2, create a file with O_RDWR, and the request was sent to mds.0:\nceph_atomic_open()--\u003e\nceph_mdsc_do_request(openc)\nfinish_open(file, dentry, ceph_open)--\u003e\nceph_open()--\u003e\nceph_init_file()--\u003e\nceph_init_file_info()--\u003e\nceph_uninline_data()--\u003e\n{\n...\nif (inline_version == 1 || /* initial version, no data */\ninline_version == CEPH_INLINE_NONE)\ngoto out_unlock;\n...\n}\nThe inline_version will be 1, which is the initial version for the\nnew create file. And here the ci-\u003ei_inline_version will keep with 1,\nit's buggy.\n3, buffer write to the file immediately:\nceph_write_iter()--\u003e\nceph_get_caps(file, need=Fw, want=Fb, ...);\ngeneric_perform_write()--\u003e\na_ops-\u003ewrite_begin()--\u003e\nceph_write_begin()--\u003e\nnetfs_write_begin()--\u003e\nnetfs_begin_read()--\u003e\nnetfs_rreq_submit_slice()--\u003e\nnetfs_read_from_server()--\u003e\nrreq-\u003enetfs_ops-\u003eissue_read()--\u003e\nceph_netfs_issue_read()--\u003e\n{\n...\nif (ci-\u003ei_inline_version != CEPH_INLINE_NONE \u0026\u0026\nceph_netfs_issue_op_inline(subreq))\nreturn;\n...\n}\nceph_put_cap_refs(ci, Fwb);\nThe ceph_netfs_issue_op_inline() will send a getattr(Fsr) request to\nmds.1.\n4, then the mds.1 will request the rd lock for CInode::filelock from\nthe auth mds.0, the mds.0 will do the CInode::filelock state transation\nfrom excl --\u003e sync, but it need to revoke the Fxwb caps back from the\nclients.\nWhile the kernel client has aleady held the Fwb caps and waiting for\nthe getattr(Fsr).\nIt's deadlock!\nURL: https://tracker.ceph.com/issues/55377"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49296\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49296\nhttps://lore.kernel.org/linux-cve-announce/2025022625-CVE-2022-49296-f8f1@gregkh/T"
  ]
}