{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: jffs2: fix memory leak in jffs2_scan_medium",
    "id": "2348044",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348044"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49276",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\njffs2: fix memory leak in jffs2_scan_medium\nIf an error is returned in jffs2_scan_eraseblock() and some memory\nhas been added to the jffs2_summary *s, we can observe the following\nkmemleak report:\n--------------------------------------------\nunreferenced object 0xffff88812b889c40 (size 64):\ncomm \"mount\", pid 692, jiffies 4294838325 (age 34.288s)\nhex dump (first 32 bytes):\n40 48 b5 14 81 88 ff ff 01 e0 31 00 00 00 50 00  @H........1...P.\n00 00 01 00 00 00 01 00 00 00 02 00 00 00 09 08  ................\nbacktrace:\n[\u003cffffffffae93a3a3\u003e] __kmalloc+0x613/0x910\n[\u003cffffffffaf423b9c\u003e] jffs2_sum_add_dirent_mem+0x5c/0xa0\n[\u003cffffffffb0f3afa8\u003e] jffs2_scan_medium.cold+0x36e5/0x4794\n[\u003cffffffffb0f3dbe1\u003e] jffs2_do_mount_fs.cold+0xa7/0x2267\n[\u003cffffffffaf40acf3\u003e] jffs2_do_fill_super+0x383/0xc30\n[\u003cffffffffaf40c00a\u003e] jffs2_fill_super+0x2ea/0x4c0\n[\u003cffffffffb0315d64\u003e] mtd_get_sb+0x254/0x400\n[\u003cffffffffb0315f5f\u003e] mtd_get_sb_by_nr+0x4f/0xd0\n[\u003cffffffffb0316478\u003e] get_tree_mtd+0x498/0x840\n[\u003cffffffffaf40bd15\u003e] jffs2_get_tree+0x25/0x30\n[\u003cffffffffae9f358d\u003e] vfs_get_tree+0x8d/0x2e0\n[\u003cffffffffaea7a98f\u003e] path_mount+0x50f/0x1e50\n[\u003cffffffffaea7c3d7\u003e] do_mount+0x107/0x130\n[\u003cffffffffaea7c5c5\u003e] __se_sys_mount+0x1c5/0x2f0\n[\u003cffffffffaea7c917\u003e] __x64_sys_mount+0xc7/0x160\n[\u003cffffffffb10142f5\u003e] do_syscall_64+0x45/0x70\nunreferenced object 0xffff888114b54840 (size 32):\ncomm \"mount\", pid 692, jiffies 4294838325 (age 34.288s)\nhex dump (first 32 bytes):\nc0 75 b5 14 81 88 ff ff 02 e0 02 00 00 00 02 00  .u..............\n00 00 84 00 00 00 44 00 00 00 6b 6b 6b 6b 6b a5  ......D...kkkkk.\nbacktrace:\n[\u003cffffffffae93be24\u003e] kmem_cache_alloc_trace+0x584/0x880\n[\u003cffffffffaf423b04\u003e] jffs2_sum_add_inode_mem+0x54/0x90\n[\u003cffffffffb0f3bd44\u003e] jffs2_scan_medium.cold+0x4481/0x4794\n[...]\nunreferenced object 0xffff888114b57280 (size 32):\ncomm \"mount\", pid 692, jiffies 4294838393 (age 34.357s)\nhex dump (first 32 bytes):\n10 d5 6c 11 81 88 ff ff 08 e0 05 00 00 00 01 00  ..l.............\n00 00 38 02 00 00 28 00 00 00 6b 6b 6b 6b 6b a5  ..8...(...kkkkk.\nbacktrace:\n[\u003cffffffffae93be24\u003e] kmem_cache_alloc_trace+0x584/0x880\n[\u003cffffffffaf423c34\u003e] jffs2_sum_add_xattr_mem+0x54/0x90\n[\u003cffffffffb0f3a24f\u003e] jffs2_scan_medium.cold+0x298c/0x4794\n[...]\nunreferenced object 0xffff8881116cd510 (size 16):\ncomm \"mount\", pid 692, jiffies 4294838395 (age 34.355s)\nhex dump (first 16 bytes):\n00 00 00 00 00 00 00 00 09 e0 60 02 00 00 6b a5  ..........`...k.\nbacktrace:\n[\u003cffffffffae93be24\u003e] kmem_cache_alloc_trace+0x584/0x880\n[\u003cffffffffaf423cc4\u003e] jffs2_sum_add_xref_mem+0x54/0x90\n[\u003cffffffffb0f3b2e3\u003e] jffs2_scan_medium.cold+0x3a20/0x4794\n[...]\n--------------------------------------------\nTherefore, we should call jffs2_sum_reset_collected(s) on exit to\nrelease the memory added in s. In addition, a new tag \"out_buf\" is\nadded to prevent the NULL pointer reference caused by s being NULL.\n(thanks to Zhang Yi for this analysis)"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49276\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49276\nhttps://lore.kernel.org/linux-cve-announce/2025022631-CVE-2022-49276-d58d@gregkh/T"
  ]
}