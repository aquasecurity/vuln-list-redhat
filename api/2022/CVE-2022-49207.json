{
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-05-09T00:00:00Z",
      "advisory": "RHSA-2023:2458",
      "package": "kernel-0:5.14.0-284.11.1.el9_2",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-05-09T00:00:00Z",
      "advisory": "RHSA-2023:2458",
      "package": "kernel-0:5.14.0-284.11.1.el9_2",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2025-02-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: bpf, sockmap: Fix memleak in sk_psock_queue_msg",
    "id": "2347653",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2347653"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-401",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49207",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nbpf, sockmap: Fix memleak in sk_psock_queue_msg\nIf tcp_bpf_sendmsg is running during a tear down operation we may enqueue\ndata on the ingress msg queue while tear down is trying to free it.\nsk1 (redirect sk2)                         sk2\n-------------------                      ---------------\ntcp_bpf_sendmsg()\ntcp_bpf_send_verdict()\ntcp_bpf_sendmsg_redir()\nbpf_tcp_ingress()\nsock_map_close()\nlock_sock()\nlock_sock() ... blocking\nsk_psock_stop\nsk_psock_clear_state(psock, SK_PSOCK_TX_ENABLED);\nrelease_sock(sk);\nlock_sock()\nsk_mem_charge()\nget_page()\nsk_psock_queue_msg()\nsk_psock_test_state(psock, SK_PSOCK_TX_ENABLED);\ndrop_sk_msg()\nrelease_sock()\nWhile drop_sk_msg(), the msg has charged memory form sk by sk_mem_charge\nand has sg pages need to put. To fix we use sk_msg_free() and then kfee()\nmsg.\nThis issue can cause the following info:\nWARNING: CPU: 0 PID: 9202 at net/core/stream.c:205 sk_stream_kill_queues+0xc8/0xe0\nCall Trace:\n\u003cIRQ\u003e\ninet_csk_destroy_sock+0x55/0x110\ntcp_rcv_state_process+0xe5f/0xe90\n? sk_filter_trim_cap+0x10d/0x230\n? tcp_v4_do_rcv+0x161/0x250\ntcp_v4_do_rcv+0x161/0x250\ntcp_v4_rcv+0xc3a/0xce0\nip_protocol_deliver_rcu+0x3d/0x230\nip_local_deliver_finish+0x54/0x60\nip_local_deliver+0xfd/0x110\n? ip_protocol_deliver_rcu+0x230/0x230\nip_rcv+0xd6/0x100\n? ip_local_deliver+0x110/0x110\n__netif_receive_skb_one_core+0x85/0xa0\nprocess_backlog+0xa4/0x160\n__napi_poll+0x29/0x1b0\nnet_rx_action+0x287/0x300\n__do_softirq+0xff/0x2fc\ndo_softirq+0x79/0x90\n\u003c/IRQ\u003e\nWARNING: CPU: 0 PID: 531 at net/ipv4/af_inet.c:154 inet_sock_destruct+0x175/0x1b0\nCall Trace:\n\u003cTASK\u003e\n__sk_destruct+0x24/0x1f0\nsk_psock_destroy+0x19b/0x1c0\nprocess_one_work+0x1b3/0x3c0\n? process_one_work+0x3c0/0x3c0\nworker_thread+0x30/0x350\n? process_one_work+0x3c0/0x3c0\nkthread+0xe6/0x110\n? kthread_complete_and_exit+0x20/0x20\nret_from_fork+0x22/0x30\n\u003c/TASK\u003e"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49207\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49207\nhttps://lore.kernel.org/linux-cve-announce/2025022619-CVE-2022-49207-cfc1@gregkh/T"
  ]
}