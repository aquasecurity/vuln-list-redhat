{
  "mitigation": "Any code that calls the unsafe method may be vulnerable unless it performs additional checks on the input arguments. Implementing additional validations on input arguments before passing them to the SerializationUtilities#deserializeObjectWithTypeInformation method might mitigate or decrease this risk.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Fuse 7",
      "fix_state": "Out of support scope",
      "package_name": "org.spark-project.hive/hive-metastore",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat Integration Camel K 1",
      "fix_state": "Not affected",
      "package_name": "org.spark-project.hive/hive-metastore",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Not affected",
      "package_name": "org.spark-project.hive/hive-metastore",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-12-05T10:01:41Z",
  "bugzilla": {
    "description": "hive-metastore: org.apache.hive:hive-metastore: Apache Hive: Deserialization of untrusted data when fetching partitions from the Metastore",
    "id": "2330533",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2330533"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-502",
  "statement": "The Metastore component is used to stores the structure information of tables and partitions in the warehouse, meaning this issue impacts mainly the integrity and availability of the system.",
  "acknowledgement": "",
  "name": "CVE-2022-41137",
  "document_distribution": "",
  "details": [
    "Apache Hive Metastore (HMS) uses SerializationUtilities#deserializeObjectWithTypeInformation method when filtering and fetching partitions that is unsafe and can lead to Remote Code Execution (RCE) since it allows the deserialization of arbitrary data.\nIn real deployments, the vulnerability can be exploited only by authenticated users/clients that were able to successfully establish a connection to the Metastore. From an API perspective any code that calls the unsafe method may be vulnerable unless it performs additional prerechecks on the input arguments.",
    "A flaw was found in the Apache Hive Metastore (HMS). This vulnerability allows remote code execution (RCE) via deserialization of arbitrary data when the `SerializationUtilities#deserializeObjectWithTypeInformation` method filters and fetches partitions without additional input validation. In real deployments, the vulnerability can be exploited only by authenticated users/clients who successfully establish a connection to the Metastore. From an API perspective, any code that calls the unsafe method may be vulnerable unless it performs additional rechecks on the input arguments."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-41137\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-41137\nhttp://www.openwall.com/lists/oss-security/2024/12/04/2\nhttps://github.com/apache/hive\nhttps://github.com/apache/hive/commit/60027bb9c91a93affcfebd9068f064bc1f2a74c9\nhttps://issues.apache.org/jira/browse/HIVE-26539\nhttps://lists.apache.org/thread/jwtr3d9yovf2wo0qlxvkhoxnwxxyzgts"
  ]
}