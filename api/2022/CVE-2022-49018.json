{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-10-21T00:00:00Z",
  "bugzilla": {
    "description": "kernel: mptcp: fix sleep in atomic at close time",
    "id": "2320685",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2320685"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.7",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-460",
  "statement": "Not actual for all versions of the Red Hat Enterprise Linux. For the latest versions (where enabled) already fixed.",
  "acknowledgement": "",
  "name": "CVE-2022-49018",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nmptcp: fix sleep in atomic at close time\nMatt reported a splat at msk close time:\nBUG: sleeping function called from invalid context at net/mptcp/protocol.c:2877\nin_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 155, name: packetdrill\npreempt_count: 201, expected: 0\nRCU nest depth: 0, expected: 0\n4 locks held by packetdrill/155:\n#0: ffff888001536990 (\u0026sb-\u003es_type-\u003ei_mutex_key#6){+.+.}-{3:3}, at: __sock_release (net/socket.c:650)\n#1: ffff88800b498130 (sk_lock-AF_INET){+.+.}-{0:0}, at: mptcp_close (net/mptcp/protocol.c:2973)\n#2: ffff88800b49a130 (sk_lock-AF_INET/1){+.+.}-{0:0}, at: __mptcp_close_ssk (net/mptcp/protocol.c:2363)\n#3: ffff88800b49a0b0 (slock-AF_INET){+...}-{2:2}, at: __lock_sock_fast (include/net/sock.h:1820)\nPreemption disabled at:\n0x0\nCPU: 1 PID: 155 Comm: packetdrill Not tainted 6.1.0-rc5 #365\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014\nCall Trace:\n\u003cTASK\u003e\ndump_stack_lvl (lib/dump_stack.c:107 (discriminator 4))\n__might_resched.cold (kernel/sched/core.c:9891)\n__mptcp_destroy_sock (include/linux/kernel.h:110)\n__mptcp_close (net/mptcp/protocol.c:2959)\nmptcp_subflow_queue_clean (include/net/sock.h:1777)\n__mptcp_close_ssk (net/mptcp/protocol.c:2363)\nmptcp_destroy_common (net/mptcp/protocol.c:3170)\nmptcp_destroy (include/net/sock.h:1495)\n__mptcp_destroy_sock (net/mptcp/protocol.c:2886)\n__mptcp_close (net/mptcp/protocol.c:2959)\nmptcp_close (net/mptcp/protocol.c:2974)\ninet_release (net/ipv4/af_inet.c:432)\n__sock_release (net/socket.c:651)\nsock_close (net/socket.c:1367)\n__fput (fs/file_table.c:320)\ntask_work_run (kernel/task_work.c:181 (discriminator 1))\nexit_to_user_mode_prepare (include/linux/resume_user_mode.h:49)\nsyscall_exit_to_user_mode (kernel/entry/common.c:130)\ndo_syscall_64 (arch/x86/entry/common.c:87)\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:120)\nWe can't call mptcp_close under the 'fast' socket lock variant, replace\nit with a sock_lock_nested() as the relevant code is already under the\nlistening msk socket lock protection."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49018\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49018\nhttps://lore.kernel.org/linux-cve-announce/2024102153-CVE-2022-49018-7ee3@gregkh/T"
  ]
}