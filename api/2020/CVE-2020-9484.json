{
  "mitigation": "Users may configure the PersistenceManager with an appropriate value for sessionAttributeValueClassNameFilter to ensure that only application provided attributes are serialized and deserialized.  For more details about the configuration, refer to the Apache Tomcat 9 Configuration Reference https://tomcat.apache.org/tomcat-9.0-doc/config/manager.html.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2020-06-11T00:00:00Z",
      "advisory": "RHSA-2020:2529",
      "package": "tomcat6-0:6.0.24-115.el6_10",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2020-06-11T00:00:00Z",
      "advisory": "RHSA-2020:2530",
      "package": "tomcat-0:7.0.76-12.el7_8",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Fuse 7.11",
      "release_date": "2022-07-07T00:00:00Z",
      "advisory": "RHSA-2022:5532",
      "package": "",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat Fuse 7.9",
      "release_date": "2021-08-11T00:00:00Z",
      "advisory": "RHSA-2021:3140",
      "package": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3.1",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2487",
      "package": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3 for RHEL 6",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2483",
      "package": "tomcat7-0:7.0.70-40.ep7.el6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el6"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3 for RHEL 6",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2483",
      "package": "tomcat8-0:8.0.36-44.ep7.el6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el6"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3 for RHEL 6",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2483",
      "package": "tomcat-native-0:1.2.23-22.redhat_22.ep7.el6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el6"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3 for RHEL 7",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2483",
      "package": "tomcat7-0:7.0.70-40.ep7.el7",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3 for RHEL 7",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2483",
      "package": "tomcat8-0:8.0.36-44.ep7.el7",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 3 for RHEL 7",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2483",
      "package": "tomcat-native-0:1.2.23-22.redhat_22.ep7.el7",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:3.1::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.3 on RHEL 6",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2506",
      "package": "jws5-tomcat-0:9.0.30-4.redhat_5.1.el6jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.3::el6"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.3 on RHEL 6",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2506",
      "package": "jws5-tomcat-native-0:1.2.23-5.redhat_5.el6jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.3::el6"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.3 on RHEL 7",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2506",
      "package": "jws5-tomcat-0:9.0.30-4.redhat_5.1.el7jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.3::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.3 on RHEL 7",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2506",
      "package": "jws5-tomcat-native-0:1.2.23-5.redhat_5.el7jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.3::el7"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.3 on RHEL 8",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2506",
      "package": "jws5-tomcat-0:9.0.30-4.redhat_5.1.el8jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.3::el8"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5.3 on RHEL 8",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2506",
      "package": "jws5-tomcat-native-0:1.2.23-5.redhat_5.el8jws",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.3::el8"
    },
    {
      "product_name": "Red Hat JBoss Web Server (JWS) 5.3",
      "release_date": "2020-06-10T00:00:00Z",
      "advisory": "RHSA-2020:2509",
      "package": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5.3"
    },
    {
      "product_name": "Red Hat Runtimes Spring Boot 2.1.15",
      "release_date": "2020-07-27T00:00:00Z",
      "advisory": "RHSA-2020:3017",
      "package": "tomcat",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Not affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "pki-deps:10.6/pki-servlet-engine",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 6",
      "fix_state": "Not affected",
      "package_name": "jbossweb",
      "cpe": "cpe:/a:redhat:jboss_data_grid:6"
    },
    {
      "product_name": "Red Hat JBoss Data Virtualization 6",
      "fix_state": "Out of support scope",
      "package_name": "jbossweb",
      "cpe": "cpe:/a:redhat:jboss_data_virtualization:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Not affected",
      "package_name": "jbossweb",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Not affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Out of support scope",
      "package_name": "opendaylight",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Not affected",
      "package_name": "opendaylight",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Not affected",
      "package_name": "tomcat",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Software Collections",
      "fix_state": "Not affected",
      "package_name": "rh-java-common-tomcat",
      "cpe": "cpe:/a:redhat:rhel_software_collections:3"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2020-05-20T00:00:00Z",
  "bugzilla": {
    "description": "deserialization flaw in session persistence storage leading to RCE",
    "id": "1838332",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1838332"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-502",
  "statement": "In Red Hat Enterprise Linux 8, Red Hat Certificate System 10 and Identity Management are using the pki-servlet-engine component, which embeds a vulnerable version of Tomcat. However, in these specific contexts, the prerequisites to the vulnerability are not met. The PersistentManager is not set, and a SecurityManager is used. The use of pki-servlet-engine outside of these contexts is not supported. As a result, the vulnerability can not be triggered in supported configurations of these products. A future update may update Tomcat in pki-servlet-engine.\nRed Hat Satellite do not ship Tomcat and rather use its configuration. The product is not affected because configuration does not make use of PersistanceManager or FileStore. Tomcat updates can be obtain from Red Hat Enterprise Linux (RHEL) RHSA.",
  "acknowledgement": "",
  "name": "CVE-2020-9484",
  "document_distribution": "",
  "details": [
    "When using Apache Tomcat versions 10.0.0-M1 to 10.0.0-M4, 9.0.0.M1 to 9.0.34, 8.5.0 to 8.5.54 and 7.0.0 to 7.0.103 if a) an attacker is able to control the contents and name of a file on the server; and b) the server is configured to use the PersistenceManager with a FileStore; and c) the PersistenceManager is configured with sessionAttributeValueClassNameFilter=\"null\" (the default unless a SecurityManager is used) or a sufficiently lax filter to allow the attacker provided object to be deserialized; and d) the attacker knows the relative file path from the storage location used by FileStore to the file the attacker has control over; then, using a specifically crafted request, the attacker will be able to trigger remote code execution via deserialization of the file under their control. Note that all of conditions a) to d) must be true for the attack to succeed.",
    "A deserialization flaw was discovered in Apache Tomcat's use of a FileStore. Under specific circumstances, an attacker can use a specially crafted request to trigger Remote Code Execution through deserialization of the file under their control. The highest threat from the vulnerability is to data confidentiality and integrity as well as system availability."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2020-9484\nhttps://nvd.nist.gov/vuln/detail/CVE-2020-9484\nhttp://mail-archives.apache.org/mod_mbox/tomcat-announce/202005.mbox/%3Ce3a0a517-bf82-ba62-0af6-24b83ea0e4e2%40apache.org%3E\nhttp://tomcat.apache.org/security-10.html#Fixed_in_Apache_Tomcat_10.0.0-M5\nhttp://tomcat.apache.org/security-7.html#Fixed_in_Apache_Tomcat_7.0.104\nhttp://tomcat.apache.org/security-8.html#Fixed_in_Apache_Tomcat_8.5.55\nhttp://tomcat.apache.org/security-9.html#Fixed_in_Apache_Tomcat_9.0.35"
  ]
}