{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2025-04-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: netfilter: nf_conncount: Fully initialize struct nf_conncount_tuple in insert_tree()",
    "id": "2356610",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2356610"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21959",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnetfilter: nf_conncount: Fully initialize struct nf_conncount_tuple in insert_tree()\nSince commit b36e4523d4d5 (\"netfilter: nf_conncount: fix garbage\ncollection confirm race\"), `cpu` and `jiffies32` were introduced to\nthe struct nf_conncount_tuple.\nThe commit made nf_conncount_add() initialize `conn-\u003ecpu` and\n`conn-\u003ejiffies32` when allocating the struct.\nIn contrast, count_tree() was not changed to initialize them.\nBy commit 34848d5c896e (\"netfilter: nf_conncount: Split insert and\ntraversal\"), count_tree() was split and the relevant allocation\ncode now resides in insert_tree().\nInitialize `conn-\u003ecpu` and `conn-\u003ejiffies32` in insert_tree().\nBUG: KMSAN: uninit-value in find_or_evict net/netfilter/nf_conncount.c:117 [inline]\nBUG: KMSAN: uninit-value in __nf_conncount_add+0xd9c/0x2850 net/netfilter/nf_conncount.c:143\nfind_or_evict net/netfilter/nf_conncount.c:117 [inline]\n__nf_conncount_add+0xd9c/0x2850 net/netfilter/nf_conncount.c:143\ncount_tree net/netfilter/nf_conncount.c:438 [inline]\nnf_conncount_count+0x82f/0x1e80 net/netfilter/nf_conncount.c:521\nconnlimit_mt+0x7f6/0xbd0 net/netfilter/xt_connlimit.c:72\n__nft_match_eval net/netfilter/nft_compat.c:403 [inline]\nnft_match_eval+0x1a5/0x300 net/netfilter/nft_compat.c:433\nexpr_call_ops_eval net/netfilter/nf_tables_core.c:240 [inline]\nnft_do_chain+0x426/0x2290 net/netfilter/nf_tables_core.c:288\nnft_do_chain_ipv4+0x1a5/0x230 net/netfilter/nft_chain_filter.c:23\nnf_hook_entry_hookfn include/linux/netfilter.h:154 [inline]\nnf_hook_slow+0xf4/0x400 net/netfilter/core.c:626\nnf_hook_slow_list+0x24d/0x860 net/netfilter/core.c:663\nNF_HOOK_LIST include/linux/netfilter.h:350 [inline]\nip_sublist_rcv+0x17b7/0x17f0 net/ipv4/ip_input.c:633\nip_list_rcv+0x9ef/0xa40 net/ipv4/ip_input.c:669\n__netif_receive_skb_list_ptype net/core/dev.c:5936 [inline]\n__netif_receive_skb_list_core+0x15c5/0x1670 net/core/dev.c:5983\n__netif_receive_skb_list net/core/dev.c:6035 [inline]\nnetif_receive_skb_list_internal+0x1085/0x1700 net/core/dev.c:6126\nnetif_receive_skb_list+0x5a/0x460 net/core/dev.c:6178\nxdp_recv_frames net/bpf/test_run.c:280 [inline]\nxdp_test_run_batch net/bpf/test_run.c:361 [inline]\nbpf_test_run_xdp_live+0x2e86/0x3480 net/bpf/test_run.c:390\nbpf_prog_test_run_xdp+0xf1d/0x1ae0 net/bpf/test_run.c:1316\nbpf_prog_test_run+0x5e5/0xa30 kernel/bpf/syscall.c:4407\n__sys_bpf+0x6aa/0xd90 kernel/bpf/syscall.c:5813\n__do_sys_bpf kernel/bpf/syscall.c:5902 [inline]\n__se_sys_bpf kernel/bpf/syscall.c:5900 [inline]\n__ia32_sys_bpf+0xa0/0xe0 kernel/bpf/syscall.c:5900\nia32_sys_call+0x394d/0x4180 arch/x86/include/generated/asm/syscalls_32.h:358\ndo_syscall_32_irqs_on arch/x86/entry/common.c:165 [inline]\n__do_fast_syscall_32+0xb0/0x110 arch/x86/entry/common.c:387\ndo_fast_syscall_32+0x38/0x80 arch/x86/entry/common.c:412\ndo_SYSENTER_32+0x1f/0x30 arch/x86/entry/common.c:450\nentry_SYSENTER_compat_after_hwframe+0x84/0x8e\nUninit was created at:\nslab_post_alloc_hook mm/slub.c:4121 [inline]\nslab_alloc_node mm/slub.c:4164 [inline]\nkmem_cache_alloc_noprof+0x915/0xe10 mm/slub.c:4171\ninsert_tree net/netfilter/nf_conncount.c:372 [inline]\ncount_tree net/netfilter/nf_conncount.c:450 [inline]\nnf_conncount_count+0x1415/0x1e80 net/netfilter/nf_conncount.c:521\nconnlimit_mt+0x7f6/0xbd0 net/netfilter/xt_connlimit.c:72\n__nft_match_eval net/netfilter/nft_compat.c:403 [inline]\nnft_match_eval+0x1a5/0x300 net/netfilter/nft_compat.c:433\nexpr_call_ops_eval net/netfilter/nf_tables_core.c:240 [inline]\nnft_do_chain+0x426/0x2290 net/netfilter/nf_tables_core.c:288\nnft_do_chain_ipv4+0x1a5/0x230 net/netfilter/nft_chain_filter.c:23\nnf_hook_entry_hookfn include/linux/netfilter.h:154 [inline]\nnf_hook_slow+0xf4/0x400 net/netfilter/core.c:626\nnf_hook_slow_list+0x24d/0x860 net/netfilter/core.c:663\nNF_HOOK_LIST include/linux/netfilter.h:350 [inline]\nip_sublist_rcv+0x17b7/0x17f0 net/ipv4/ip_input.c:633\nip_list_rcv+0x9ef/0xa40 net/ip\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21959\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21959\nhttps://lore.kernel.org/linux-cve-announce/2025040144-CVE-2025-21959-a643@gregkh/T"
  ]
}