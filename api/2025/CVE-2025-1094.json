{
  "mitigation": "To mitigate, apply PostgreSQL patches once available. Until then:\n1. Validate UTF-8 encoding: Reject inputs containing invalid UTF-8 sequences before passing to psql.\n2. Avoid dynamic SQL: Use parameterized queries or ORM frameworks to minimize direct psql usage with raw input.\n3. Restrict psql privileges: Limit OS-level permissions for the PostgreSQL user to reduce RCE impact.\n4. Monitor logs: Flag repeated invalid byte sequence for encoding \"UTF8\" errors, which may indicate exploitation attempts.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1736",
      "package": "postgresql:13-8100020250219110026.489197e6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1737",
      "package": "libpq-0:13.20-1.el8_10",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1739",
      "package": "postgresql:15-8100020250218154242.489197e6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1740",
      "package": "postgresql:16-8100020250218110357.489197e6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.2 Advanced Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1720",
      "package": "libpq-0:12.7-1.el8_2.2",
      "cpe": "cpe:/a:redhat:rhel_aus:8.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1724",
      "package": "postgresql:13-8040020250218192842.522a0ee4",
      "cpe": "cpe:/a:redhat:rhel_aus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1735",
      "package": "libpq-0:13.20-1.el8_4",
      "cpe": "cpe:/a:redhat:rhel_aus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1724",
      "package": "postgresql:13-8040020250218192842.522a0ee4",
      "cpe": "cpe:/a:redhat:rhel_tus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1735",
      "package": "libpq-0:13.20-1.el8_4",
      "cpe": "cpe:/a:redhat:rhel_tus:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1724",
      "package": "postgresql:13-8040020250218192842.522a0ee4",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1735",
      "package": "libpq-0:13.20-1.el8_4",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Advanced Mission Critical Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1723",
      "package": "postgresql:13-8060020250218173011.ad008a3a",
      "cpe": "cpe:/a:redhat:rhel_aus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Advanced Mission Critical Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1745",
      "package": "libpq-0:13.20-1.el8_6",
      "cpe": "cpe:/a:redhat:rhel_aus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Telecommunications Update Service",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1723",
      "package": "postgresql:13-8060020250218173011.ad008a3a",
      "cpe": "cpe:/a:redhat:rhel_tus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Telecommunications Update Service",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1745",
      "package": "libpq-0:13.20-1.el8_6",
      "cpe": "cpe:/a:redhat:rhel_tus:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Update Services for SAP Solutions",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1723",
      "package": "postgresql:13-8060020250218173011.ad008a3a",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.6 Update Services for SAP Solutions",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1745",
      "package": "libpq-0:13.20-1.el8_6",
      "cpe": "cpe:/a:redhat:rhel_e4s:8.6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1721",
      "package": "postgresql:15-8080020250218151741.63b34585",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1729",
      "package": "postgresql:13-8080020250218141334.63b34585",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1744",
      "package": "libpq-0:13.20-1.el8_8",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1738",
      "package": "libpq-0:13.20-1.el9_5",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1741",
      "package": "postgresql:15-9050020250218090615.rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1742",
      "package": "postgresql-0:13.20-1.el9_5",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1743",
      "package": "postgresql:16-9050020250218075302.rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Update Services for SAP Solutions",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1725",
      "package": "libpq-0:13.20-1.el9_0",
      "cpe": "cpe:/a:redhat:rhel_e4s:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Update Services for SAP Solutions",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1728",
      "package": "postgresql-0:13.20-1.el9_0",
      "cpe": "cpe:/a:redhat:rhel_e4s:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1722",
      "package": "postgresql:15-9020020250218153429.rhel9",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1727",
      "package": "postgresql-0:13.20-1.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1733",
      "package": "libpq-0:13.20-1.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1726",
      "package": "postgresql-0:13.20-1.el9_4",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1730",
      "package": "postgresql:15-9040020250218181918.rhel9",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1731",
      "package": "postgresql:16-9040020250218200209.rhel9",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2025-02-20T00:00:00Z",
      "advisory": "RHSA-2025:1732",
      "package": "libpq-0:13.20-1.el9_4",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "postgresql:12/postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2025-02-13T13:00:02Z",
  "bugzilla": {
    "description": "postgresql: PostgreSQL quoting APIs miss neutralizing quoting syntax in text that fails encoding validation",
    "id": "2345548",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2345548"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-149",
  "statement": "This vulnerability is marked as Important because it not only enables SQL injection but also allows arbitrary code execution (ACE) through PostgreSQL’s psql interactive tool. The flaw arises from improper neutralization of malformed UTF-8 sequences, which can bypass PostgreSQL’s escaping functions, leading to successful injection attacks. What elevates its severity is psql's support for meta-commands, specifically the ! command, which allows execution of arbitrary shell commands on the host system.\nEven when untrusted input is correctly escaped (e.g., via pg_escape_string), an attacker can craft invalid UTF-8 characters containing raw bytes like 0x27 (a single quote), causing psql to misinterpret the SQL statement’s structure. This allows splitting a single query into multiple statements, enabling unauthenticated attackers to execute arbitrary SQL meta-commands (e.g., \\! \u003cOS command\u003e) or inject malicious SQL.",
  "acknowledgement": "",
  "name": "CVE-2025-1094",
  "document_distribution": "",
  "details": [
    "Improper neutralization of quoting syntax in PostgreSQL libpq functions PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), and PQescapeStringConn() allows a database input provider to achieve SQL injection in certain usage patterns.  Specifically, SQL injection requires the application to use the function result to construct input to psql, the PostgreSQL interactive terminal.  Similarly, improper neutralization of quoting syntax in PostgreSQL command line utility programs allows a source of command line arguments to achieve SQL injection when client_encoding is BIG5 and server_encoding is one of EUC_TW or MULE_INTERNAL.  Versions before PostgreSQL 17.3, 16.7, 15.11, 14.16, and 13.19 are affected.",
    "A flaw was found in PostgreSQL. Due to improper neutralization of quoting syntax, affected versions potentially allow a database input provider to achieve SQL injection in certain usage patterns. Specifically, SQL injection requires the application to use the affected function's result to construct input to psql, the PostgreSQL interactive terminal. Similarly, improper neutralization of quoting syntax in PostgreSQL command line utility programs allows a source of command line arguments to achieve SQL injection when `client_encoding` is `BIG5` and `server_encoding` is one of `EUC_TW` or `MULE_INTERNAL`."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-1094\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-1094\nhttps://attackerkb.com/topics/G5s8ZWAbYH/cve-2024-12356/rapid7-analysis\nhttps://www.postgresql.org/support/security/CVE-2025-1094/\nhttps://www.rapid7.com/blog/post/2025/02/13/cve-2025-1094-postgresql-psql-sql-injection-fixed/"
  ]
}