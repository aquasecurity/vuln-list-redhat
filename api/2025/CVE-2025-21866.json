{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2025-03-12T00:00:00Z",
  "bugzilla": {
    "description": "kernel: powerpc/code-patching: Fix KASAN hit by not flagging text patching area as VM_ALLOC",
    "id": "2351623",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2351623"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-770",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21866",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\npowerpc/code-patching: Fix KASAN hit by not flagging text patching area as VM_ALLOC\nErhard reported the following KASAN hit while booting his PowerMac G4\nwith a KASAN-enabled kernel 6.13-rc6:\nBUG: KASAN: vmalloc-out-of-bounds in copy_to_kernel_nofault+0xd8/0x1c8\nWrite of size 8 at addr f1000000 by task chronyd/1293\nCPU: 0 UID: 123 PID: 1293 Comm: chronyd Tainted: G        W          6.13.0-rc6-PMacG4 #2\nTainted: [W]=WARN\nHardware name: PowerMac3,6 7455 0x80010303 PowerMac\nCall Trace:\n[c2437590] [c1631a84] dump_stack_lvl+0x70/0x8c (unreliable)\n[c24375b0] [c0504998] print_report+0xdc/0x504\n[c2437610] [c050475c] kasan_report+0xf8/0x108\n[c2437690] [c0505a3c] kasan_check_range+0x24/0x18c\n[c24376a0] [c03fb5e4] copy_to_kernel_nofault+0xd8/0x1c8\n[c24376c0] [c004c014] patch_instructions+0x15c/0x16c\n[c2437710] [c00731a8] bpf_arch_text_copy+0x60/0x7c\n[c2437730] [c0281168] bpf_jit_binary_pack_finalize+0x50/0xac\n[c2437750] [c0073cf4] bpf_int_jit_compile+0xb30/0xdec\n[c2437880] [c0280394] bpf_prog_select_runtime+0x15c/0x478\n[c24378d0] [c1263428] bpf_prepare_filter+0xbf8/0xc14\n[c2437990] [c12677ec] bpf_prog_create_from_user+0x258/0x2b4\n[c24379d0] [c027111c] do_seccomp+0x3dc/0x1890\n[c2437ac0] [c001d8e0] system_call_exception+0x2dc/0x420\n[c2437f30] [c00281ac] ret_from_syscall+0x0/0x2c\n--- interrupt: c00 at 0x5a1274\nNIP:  005a1274 LR: 006a3b3c CTR: 005296c8\nREGS: c2437f40 TRAP: 0c00   Tainted: G        W           (6.13.0-rc6-PMacG4)\nMSR:  0200f932 \u003cVEC,EE,PR,FP,ME,IR,DR,RI\u003e  CR: 24004422  XER: 00000000\nGPR00: 00000166 af8f3fa0 a7ee3540 00000001 00000000 013b6500 005a5858 0200f932\nGPR08: 00000000 00001fe9 013d5fc8 005296c8 2822244c 00b2fcd8 00000000 af8f4b57\nGPR16: 00000000 00000001 00000000 00000000 00000000 00000001 00000000 00000002\nGPR24: 00afdbb0 00000000 00000000 00000000 006e0004 013ce060 006e7c1c 00000001\nNIP [005a1274] 0x5a1274\nLR [006a3b3c] 0x6a3b3c\n--- interrupt: c00\nThe buggy address belongs to the virtual mapping at\n[f1000000, f1002000) created by:\ntext_area_cpu_up+0x20/0x190\nThe buggy address belongs to the physical page:\npage: refcount:1 mapcount:0 mapping:00000000 index:0x0 pfn:0x76e30\nflags: 0x80000000(zone=2)\nraw: 80000000 00000000 00000122 00000000 00000000 00000000 ffffffff 00000001\nraw: 00000000\npage dumped because: kasan: bad access detected\nMemory state around the buggy address:\nf0ffff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\nf0ffff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n\u003ef1000000: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8\n^\nf1000080: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8\nf1000100: f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8 f8\n==================================================================\nf8 corresponds to KASAN_VMALLOC_INVALID which means the area is not\ninitialised hence not supposed to be used yet.\nPowerpc text patching infrastructure allocates a virtual memory area\nusing get_vm_area() and flags it as VM_ALLOC. But that flag is meant\nto be used for vmalloc() and vmalloc() allocated memory is not\nsupposed to be used before a call to __vmalloc_node_range() which is\nnever called for that area.\nThat went undetected until commit e4137f08816b (\"mm, kasan, kmsan:\ninstrument copy_from/to_kernel_nofault\")\nThe area allocated by text_area_cpu_up() is not vmalloc memory, it is\nmapped directly on demand when needed by map_kernel_page(). There is\nno VM flag corresponding to such usage, so just pass no flag. That way\nthe area will be unpoisonned and usable immediately."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21866\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21866\nhttps://lore.kernel.org/linux-cve-announce/2025031218-CVE-2025-21866-11c0@gregkh/T"
  ]
}