{
  "mitigation": "To mitigate this vulnerability, it is recommended to impose an input size restriction before parsing (i.e. validating or limiting the length of expression strings that the application will accept). Ensuring no unbounded-length expressions are fed into the parser will prevent the parser from constructing a very large AST and avoid the potential memory exhaustion issue.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2025-03-27T00:00:00Z",
      "advisory": "RHSA-2025:3335",
      "package": "opentelemetry-collector-0:0.107.0-8.el9_5",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2025-04-03T00:00:00Z",
      "advisory": "RHSA-2025:3593",
      "package": "opentelemetry-collector-0:0.107.0-7.el9_4",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3.5.1",
      "release_date": "2025-04-09T00:00:00Z",
      "advisory": "RHSA-2025:3740",
      "package": "registry.redhat.io/rhosdt/tempo-rhel8:sha256:d0e7bae0605cb69b34347e9c0d07314842c19bef22b413e1fba9aa2aa2e98675",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.5::el8"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3.5.1",
      "release_date": "2025-04-09T00:00:00Z",
      "advisory": "RHSA-2025:3743",
      "package": "registry.redhat.io/rhosdt/opentelemetry-collector-rhel8:sha256:360b97d5055aba77fb7cc5c029e910be7e7eb10672df530eca2c91346da2f2b0",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3.5::el8"
    }
  ],
  "package_state": [
    {
      "product_name": "Custom Metric Autoscaler operator for Red Hat Openshift",
      "fix_state": "Affected",
      "package_name": "custom-metrics-autoscaler/custom-metrics-autoscaler-admission-webhooks-rhel8",
      "cpe": "cpe:/a:redhat:openshift_custom_metrics_autoscaler:2"
    },
    {
      "product_name": "Custom Metric Autoscaler operator for Red Hat Openshift",
      "fix_state": "Affected",
      "package_name": "custom-metrics-autoscaler/custom-metrics-autoscaler-rhel8",
      "cpe": "cpe:/a:redhat:openshift_custom_metrics_autoscaler:2"
    },
    {
      "product_name": "Custom Metric Autoscaler operator for Red Hat Openshift",
      "fix_state": "Affected",
      "package_name": "custom-metrics-autoscaler-tech-preview/custom-metrics-autoscaler-adapter-rhel8",
      "cpe": "cpe:/a:redhat:openshift_custom_metrics_autoscaler:2"
    },
    {
      "product_name": "Deployment Validation Operator",
      "fix_state": "Affected",
      "package_name": "deployment-validation-operator-container",
      "cpe": "cpe:/a:redhat:deployment_validator_operator"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-data-science-pipelines-argo-argoexec-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-data-science-pipelines-argo-workflowcontroller-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-ml-pipelines-api-server-v2-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-ml-pipelines-driver-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-ml-pipelines-launcher-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-ml-pipelines-persistenceagent-v2-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-ml-pipelines-scheduledworkflow-v2-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-collector-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-operator-bundle",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-rhel8-operator",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-target-allocator-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/tempo-gateway-opa-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/tempo-gateway-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/tempo-operator-bundle",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/tempo-query-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/tempo-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/tempo-rhel8-operator",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-1/argocd-rhel8",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Will not fix",
      "package_name": "openshift-gitops-1/gitops-operator-bundle",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-argocd-rhel9-container",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2025-03-17T13:15:32Z",
  "bugzilla": {
    "description": "github.com/expr-lang/expr: Memory Exhaustion in Expr Parser with Unrestricted Input",
    "id": "2352914",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2352914"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-770",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-29786",
  "document_distribution": "",
  "details": [
    "Expr is an expression language and expression evaluation for Go. Prior to version 1.17.0, if the Expr expression parser is given an unbounded input string, it will attempt to compile the entire string and generate an Abstract Syntax Tree (AST) node for each part of the expression. In scenarios where input size isnâ€™t limited, a malicious or inadvertent extremely large expression can consume excessive memory as the parser builds a huge AST. This can ultimately lead to*excessive memory usage and an Out-Of-Memory (OOM) crash of the process. This issue is relatively uncommon and will only manifest when there are no restrictions on the input size, i.e. the expression length is allowed to grow arbitrarily large. In typical use cases where inputs are bounded or validated, this problem would not occur. The problem has been patched in the latest versions of the Expr library. The fix introduces compile-time limits on the number of AST nodes and memory usage during parsing, preventing any single expression from exhausting resources. Users should upgrade to Expr version 1.17.0 or later, as this release includes the new node budget and memory limit safeguards. Upgrading to v1.17.0 ensures that extremely deep or large expressions are detected and safely aborted during compilation, avoiding the OOM condition. For users who cannot immediately upgrade, the recommended workaround is to impose an input size restriction before parsing. In practice, this means validating or limiting the length of expression strings that your application will accept. For example, set a maximum allowable number of characters (or nodes) for any expression and reject or truncate inputs that exceed this limit. By ensuring no unbounded-length expression is ever fed into the parser, one can prevent the parser from constructing a pathologically large AST and avoid potential memory exhaustion. In short, pre-validate and cap input size as a safeguard in the absence of the patch.",
    "A flaw was found in Expr. This vulnerability allows excessive memory usage and potential out-of-memory (OOM) crashes via unbounded input strings, where a malicious or inadvertent large expression can cause the parser to construct an extremely large Abstract Syntax Tree (AST), consuming excessive memory."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-29786\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-29786\nhttps://github.com/expr-lang/expr/pull/762\nhttps://github.com/expr-lang/expr/security/advisories/GHSA-93mq-9ffx-83m2"
  ]
}