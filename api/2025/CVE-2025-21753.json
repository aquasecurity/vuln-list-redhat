{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: btrfs: fix use-after-free when attempting to join an aborted transaction",
    "id": "2348641",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348641"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "Red Hat Enterprise Linux is not vulnerable to this CVE, as it does not affect the versions or configurations of the Linux kernel used in its distributions.\nThis vulnerability marked as a Moderate severity instead of Important because, while it leads to a use-after-free (UAF) bug, its exploitability is limited. The issue occurs in the Btrfs transaction handling code, which primarily affects filesystem operations rather than exposing a direct attack surface to unprivileged users. To trigger this bug, an attacker would likely need local access and the ability to perform concurrent file operations in a way that causes a race condition. Additionally, while UAF bugs can sometimes lead to arbitrary code execution, this particular case is more likely to result in kernel crashes or filesystem corruption rather than immediate privilege escalation.",
  "acknowledgement": "",
  "name": "CVE-2025-21753",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nbtrfs: fix use-after-free when attempting to join an aborted transaction\nWhen we are trying to join the current transaction and if it's aborted,\nwe read its 'aborted' field after unlocking fs_info-\u003etrans_lock and\nwithout holding any extra reference count on it. This means that a\nconcurrent task that is aborting the transaction may free the transaction\nbefore we read its 'aborted' field, leading to a use-after-free.\nFix this by reading the 'aborted' field while holding fs_info-\u003etrans_lock\nsince any freeing task must first acquire that lock and set\nfs_info-\u003erunning_transaction to NULL before freeing the transaction.\nThis was reported by syzbot and Dmitry with the following stack traces\nfrom KASAN:\n==================================================================\nBUG: KASAN: slab-use-after-free in join_transaction+0xd9b/0xda0 fs/btrfs/transaction.c:278\nRead of size 4 at addr ffff888011839024 by task kworker/u4:9/1128\nCPU: 0 UID: 0 PID: 1128 Comm: kworker/u4:9 Not tainted 6.13.0-rc7-syzkaller-00019-gc45323b7560e #0\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014\nWorkqueue: events_unbound btrfs_async_reclaim_data_space\nCall Trace:\n\u003cTASK\u003e\n__dump_stack lib/dump_stack.c:94 [inline]\ndump_stack_lvl+0x241/0x360 lib/dump_stack.c:120\nprint_address_description mm/kasan/report.c:378 [inline]\nprint_report+0x169/0x550 mm/kasan/report.c:489\nkasan_report+0x143/0x180 mm/kasan/report.c:602\njoin_transaction+0xd9b/0xda0 fs/btrfs/transaction.c:278\nstart_transaction+0xaf8/0x1670 fs/btrfs/transaction.c:697\nflush_space+0x448/0xcf0 fs/btrfs/space-info.c:803\nbtrfs_async_reclaim_data_space+0x159/0x510 fs/btrfs/space-info.c:1321\nprocess_one_work kernel/workqueue.c:3236 [inline]\nprocess_scheduled_works+0xa66/0x1840 kernel/workqueue.c:3317\nworker_thread+0x870/0xd30 kernel/workqueue.c:3398\nkthread+0x2f0/0x390 kernel/kthread.c:389\nret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147\nret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244\n\u003c/TASK\u003e\nAllocated by task 5315:\nkasan_save_stack mm/kasan/common.c:47 [inline]\nkasan_save_track+0x3f/0x80 mm/kasan/common.c:68\npoison_kmalloc_redzone mm/kasan/common.c:377 [inline]\n__kasan_kmalloc+0x98/0xb0 mm/kasan/common.c:394\nkasan_kmalloc include/linux/kasan.h:260 [inline]\n__kmalloc_cache_noprof+0x243/0x390 mm/slub.c:4329\nkmalloc_noprof include/linux/slab.h:901 [inline]\njoin_transaction+0x144/0xda0 fs/btrfs/transaction.c:308\nstart_transaction+0xaf8/0x1670 fs/btrfs/transaction.c:697\nbtrfs_create_common+0x1b2/0x2e0 fs/btrfs/inode.c:6572\nlookup_open fs/namei.c:3649 [inline]\nopen_last_lookups fs/namei.c:3748 [inline]\npath_openat+0x1c03/0x3590 fs/namei.c:3984\ndo_filp_open+0x27f/0x4e0 fs/namei.c:4014\ndo_sys_openat2+0x13e/0x1d0 fs/open.c:1402\ndo_sys_open fs/open.c:1417 [inline]\n__do_sys_creat fs/open.c:1495 [inline]\n__se_sys_creat fs/open.c:1489 [inline]\n__x64_sys_creat+0x123/0x170 fs/open.c:1489\ndo_syscall_x64 arch/x86/entry/common.c:52 [inline]\ndo_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\nentry_SYSCALL_64_after_hwframe+0x77/0x7f\nFreed by task 5336:\nkasan_save_stack mm/kasan/common.c:47 [inline]\nkasan_save_track+0x3f/0x80 mm/kasan/common.c:68\nkasan_save_free_info+0x40/0x50 mm/kasan/generic.c:582\npoison_slab_object mm/kasan/common.c:247 [inline]\n__kasan_slab_free+0x59/0x70 mm/kasan/common.c:264\nkasan_slab_free include/linux/kasan.h:233 [inline]\nslab_free_hook mm/slub.c:2353 [inline]\nslab_free mm/slub.c:4613 [inline]\nkfree+0x196/0x430 mm/slub.c:4761\ncleanup_transaction fs/btrfs/transaction.c:2063 [inline]\nbtrfs_commit_transaction+0x2c97/0x3720 fs/btrfs/transaction.c:2598\ninsert_balance_item+0x1284/0x20b0 fs/btrfs/volumes.c:3757\nbtrfs_balance+0x992/\n---truncated---",
    "A use-after-free (UAF) vulnerability was found in Btrfs. A transaction handling allowed a race condition where an aborted transaction could be accessed after being freed, leading to potential kernel crashes or filesystem corruption."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21753\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21753\nhttps://lore.kernel.org/linux-cve-announce/2025022602-CVE-2025-21753-91bd@gregkh/T"
  ]
}