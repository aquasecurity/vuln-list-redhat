{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-03-12T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net: Add rx_skb of kfree_skb to raw_tp_null_args[].",
    "id": "2351614",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2351614"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21852",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet: Add rx_skb of kfree_skb to raw_tp_null_args[].\nYan Zhai reported a BPF prog could trigger a null-ptr-deref [0]\nin trace_kfree_skb if the prog does not check if rx_sk is NULL.\nCommit c53795d48ee8 (\"net: add rx_sk to trace_kfree_skb\") added\nrx_sk to trace_kfree_skb, but rx_sk is optional and could be NULL.\nLet's add kfree_skb to raw_tp_null_args[] to let the BPF verifier\nvalidate such a prog and prevent the issue.\nNow we fail to load such a prog:\nlibbpf: prog 'drop': -- BEGIN PROG LOAD LOG --\n0: R1=ctx() R10=fp0\n; int BPF_PROG(drop, struct sk_buff *skb, void *location, @ kfree_skb_sk_null.bpf.c:21\n0: (79) r3 = *(u64 *)(r1 +24)\nfunc 'kfree_skb' arg3 has btf_id 5253 type STRUCT 'sock'\n1: R1=ctx() R3_w=trusted_ptr_or_null_sock(id=1)\n; bpf_printk(\"sk: %d, %d\\n\", sk, sk-\u003e__sk_common.skc_family); @ kfree_skb_sk_null.bpf.c:24\n1: (69) r4 = *(u16 *)(r3 +16)\nR3 invalid mem access 'trusted_ptr_or_null_'\nprocessed 2 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0\n-- END PROG LOAD LOG --\nNote this fix requires commit 838a10bd2ebf (\"bpf: Augment raw_tp\narguments with PTR_MAYBE_NULL\").\n[0]:\nBUG: kernel NULL pointer dereference, address: 0000000000000010\nPF: supervisor read access in kernel mode\nPF: error_code(0x0000) - not-present page\nPGD 0 P4D 0\nPREEMPT SMP\nRIP: 0010:bpf_prog_5e21a6db8fcff1aa_drop+0x10/0x2d\nCall Trace:\n\u003cTASK\u003e\n? __die+0x1f/0x60\n? page_fault_oops+0x148/0x420\n? search_bpf_extables+0x5b/0x70\n? fixup_exception+0x27/0x2c0\n? exc_page_fault+0x75/0x170\n? asm_exc_page_fault+0x22/0x30\n? bpf_prog_5e21a6db8fcff1aa_drop+0x10/0x2d\nbpf_trace_run4+0x68/0xd0\n? unix_stream_connect+0x1f4/0x6f0\nsk_skb_reason_drop+0x90/0x120\nunix_stream_connect+0x1f4/0x6f0\n__sys_connect+0x7f/0xb0\n__x64_sys_connect+0x14/0x20\ndo_syscall_64+0x47/0xc30\nentry_SYSCALL_64_after_hwframe+0x4b/0x53"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21852\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21852\nhttps://lore.kernel.org/linux-cve-announce/2025031213-CVE-2025-21852-b942@gregkh/T"
  ]
}