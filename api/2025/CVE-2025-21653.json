{
  "mitigation": "To mitigate this issue, prevent module cls_flow from being loaded. Please see https://access.redhat.com/solutions/41278 for how to blacklist a kernel module to prevent it from loading automatically.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-01-19T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net_sched: cls_flow: validate TCA_FLOW_RSHIFT attribute",
    "id": "2338817",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2338817"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.7",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "If qdisc (or other packets filtering with cls_flow) being used, user can trigger ubsan_handle_shift_out_of_bounds (only with KASAN enabled and this incorrect shift could not be used for privileges escalation, but instead fail of this service itself that is deny of service). The security impact is limited.",
  "acknowledgement": "",
  "name": "CVE-2025-21653",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet_sched: cls_flow: validate TCA_FLOW_RSHIFT attribute\nsyzbot found that TCA_FLOW_RSHIFT attribute was not validated.\nRight shitfing a 32bit integer is undefined for large shift values.\nUBSAN: shift-out-of-bounds in net/sched/cls_flow.c:329:23\nshift exponent 9445 is too large for 32-bit type 'u32' (aka 'unsigned int')\nCPU: 1 UID: 0 PID: 54 Comm: kworker/u8:3 Not tainted 6.13.0-rc3-syzkaller-00180-g4f619d518db9 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024\nWorkqueue: ipv6_addrconf addrconf_dad_work\nCall Trace:\n\u003cTASK\u003e\n__dump_stack lib/dump_stack.c:94 [inline]\ndump_stack_lvl+0x241/0x360 lib/dump_stack.c:120\nubsan_epilogue lib/ubsan.c:231 [inline]\n__ubsan_handle_shift_out_of_bounds+0x3c8/0x420 lib/ubsan.c:468\nflow_classify+0x24d5/0x25b0 net/sched/cls_flow.c:329\ntc_classify include/net/tc_wrapper.h:197 [inline]\n__tcf_classify net/sched/cls_api.c:1771 [inline]\ntcf_classify+0x420/0x1160 net/sched/cls_api.c:1867\nsfb_classify net/sched/sch_sfb.c:260 [inline]\nsfb_enqueue+0x3ad/0x18b0 net/sched/sch_sfb.c:318\ndev_qdisc_enqueue+0x4b/0x290 net/core/dev.c:3793\n__dev_xmit_skb net/core/dev.c:3889 [inline]\n__dev_queue_xmit+0xf0e/0x3f50 net/core/dev.c:4400\ndev_queue_xmit include/linux/netdevice.h:3168 [inline]\nneigh_hh_output include/net/neighbour.h:523 [inline]\nneigh_output include/net/neighbour.h:537 [inline]\nip_finish_output2+0xd41/0x1390 net/ipv4/ip_output.c:236\niptunnel_xmit+0x55d/0x9b0 net/ipv4/ip_tunnel_core.c:82\nudp_tunnel_xmit_skb+0x262/0x3b0 net/ipv4/udp_tunnel_core.c:173\ngeneve_xmit_skb drivers/net/geneve.c:916 [inline]\ngeneve_xmit+0x21dc/0x2d00 drivers/net/geneve.c:1039\n__netdev_start_xmit include/linux/netdevice.h:5002 [inline]\nnetdev_start_xmit include/linux/netdevice.h:5011 [inline]\nxmit_one net/core/dev.c:3590 [inline]\ndev_hard_start_xmit+0x27a/0x7d0 net/core/dev.c:3606\n__dev_queue_xmit+0x1b73/0x3f50 net/core/dev.c:4434"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21653\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21653\nhttps://lore.kernel.org/linux-cve-announce/2025011947-CVE-2025-21653-b6c0@gregkh/T"
  ]
}