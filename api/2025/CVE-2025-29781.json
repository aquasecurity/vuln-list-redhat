{
  "mitigation": "Operator can configure BMO role-based access control (RBAC) to be namespace scoped instead of cluster scoped to prevent BMO from accessing Secrets from other namespaces, or use the `WATCH_NAMESPACE` configuration option to limit BMO to a single namespace.",
  "affected_release": [
    {
      "product_name": "Red Hat OpenShift Container Platform 4.17",
      "release_date": "2025-04-16T00:00:00Z",
      "advisory": "RHSA-2025:3798",
      "package": "openshift4/ose-baremetal-rhel9-operator:v4.17.0-202504091537.p0.ge6e5d54.assembly.stream.el9",
      "cpe": "cpe:/a:redhat:openshift:4.17::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.18",
      "release_date": "2025-04-16T00:00:00Z",
      "advisory": "RHSA-2025:3775",
      "package": "openshift4/ose-baremetal-rhel9-operator:v4.18.0-202504090803.p0.g001d949.assembly.stream.el9",
      "cpe": "cpe:/a:redhat:openshift:4.18::el9"
    }
  ],
  "package_state": [
    {
      "product_name": "Assisted Installer for Red Hat OpenShift Container Platform",
      "fix_state": "Fix deferred",
      "package_name": "rhai-tech-preview/assisted-installer-reporter-rhel8",
      "cpe": "cpe:/a:redhat:assisted_installer:2"
    },
    {
      "product_name": "Assisted Installer for Red Hat OpenShift Container Platform",
      "fix_state": "Fix deferred",
      "package_name": "rhai-tech-preview/assisted-installer-rhel8",
      "cpe": "cpe:/a:redhat:assisted_installer:2"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/agent-service-rhel8",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/assisted-installer-controller-rhel8",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/assisted-installer-reporter-rhel8",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/assisted-installer-rhel8",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/assisted-service-8-rhel8",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/assisted-service-9-rhel9",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/hive-rhel8",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Multicluster Engine for Kubernetes",
      "fix_state": "Fix deferred",
      "package_name": "multicluster-engine/image-based-install-rhel9",
      "cpe": "cpe:/a:redhat:multicluster_engine"
    },
    {
      "product_name": "Red Hat Advanced Cluster Management for Kubernetes 2",
      "fix_state": "Fix deferred",
      "package_name": "rhacm2/acm-siteconfig-rhel9",
      "cpe": "cpe:/a:redhat:acm:2"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "o-cloud-hwmgr-plugin-operator-bundle-container",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "o-cloud-manager-operator-bundle-container",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-agent-installer-api-server-rhel9",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-agent-installer-csr-approver-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-agent-installer-orchestrator-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-baremetal-cluster-api-controllers-rhel9",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-baremetal-installer-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-baremetal-machine-controllers",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-baremetal-runtimecfg-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "openshift4/ose-cluster-baremetal-operator-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-image-customization-controller-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-installer",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-installer-altinfra-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "openshift4/ose-installer-artifacts",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "oran-o2ims-operator-bundle-container",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Fix deferred",
      "package_name": "ose-installer-terraform-providers-container",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "fix_state": "Fix deferred",
      "package_name": "osp-director-provisioner-container",
      "cpe": "cpe:/a:redhat:openstack:16.2"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "fix_state": "Fix deferred",
      "package_name": "rhosp-rhel8/osp-director-agent",
      "cpe": "cpe:/a:redhat:openstack:16.2"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "fix_state": "Fix deferred",
      "package_name": "rhosp-rhel8-tech-preview/osp-director-downloader",
      "cpe": "cpe:/a:redhat:openstack:16.2"
    },
    {
      "product_name": "Red Hat OpenStack Platform 16.2",
      "fix_state": "Fix deferred",
      "package_name": "rhosp-rhel8-tech-preview/osp-director-operator",
      "cpe": "cpe:/a:redhat:openstack:16.2"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.1",
      "fix_state": "Fix deferred",
      "package_name": "rhosp-rhel9/osp-director-agent",
      "cpe": "cpe:/a:redhat:openstack:17.1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.1",
      "fix_state": "Fix deferred",
      "package_name": "rhosp-rhel9/osp-director-downloader",
      "cpe": "cpe:/a:redhat:openstack:17.1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.1",
      "fix_state": "Fix deferred",
      "package_name": "rhosp-rhel9/osp-director-operator",
      "cpe": "cpe:/a:redhat:openstack:17.1"
    },
    {
      "product_name": "Red Hat OpenStack Platform 18.0",
      "fix_state": "Fix deferred",
      "package_name": "openstack-baremetal-agent-container",
      "cpe": "cpe:/a:redhat:openstack:18.0"
    },
    {
      "product_name": "Red Hat OpenStack Platform 18.0",
      "fix_state": "Fix deferred",
      "package_name": "openstack-baremetal-operator-bundle-container",
      "cpe": "cpe:/a:redhat:openstack:18.0"
    },
    {
      "product_name": "Red Hat OpenStack Platform 18.0",
      "fix_state": "Fix deferred",
      "package_name": "openstack-baremetal-operator-container",
      "cpe": "cpe:/a:redhat:openstack:18.0"
    },
    {
      "product_name": "Red Hat OpenStack Platform 18.0",
      "fix_state": "Fix deferred",
      "package_name": "openstack-operator-bundle-container",
      "cpe": "cpe:/a:redhat:openstack:18.0"
    },
    {
      "product_name": "Red Hat OpenStack Platform 18.0",
      "fix_state": "Fix deferred",
      "package_name": "openstack-operator-container",
      "cpe": "cpe:/a:redhat:openstack:18.0"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-03-17T21:37:31Z",
  "bugzilla": {
    "description": "baremetal-operator/apis: Bare Metal Operator (BMO) can expose any secret from other namespaces via BMCEventSubscription CRD",
    "id": "2353041",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2353041"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "(CWE-200|CWE-653)",
  "statement": "This vulnerability is rated as Important for OpenShift Baremetal Operator, because RBAC is cluster scoped and, while `WATCH_NAMESPACE` is set to `openshift-machine-api` by default, it is common for deployments to have a less restrictive value configured.",
  "acknowledgement": "",
  "name": "CVE-2025-29781",
  "document_distribution": "",
  "details": [
    "The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. Baremetal Operator enables users to load Secret from arbitrary namespaces upon deployment of the namespace scoped Custom Resource `BMCEventSubscription`. Prior to versions 0.8.1 and 0.9.1, an adversary Kubernetes account with only namespace level roles (e.g. a tenant controlling a namespace) may create a `BMCEventSubscription` in his authorized namespace and then load Secrets from his unauthorized namespaces to his authorized namespace via the Baremetal Operator, causing Secret Leakage. The patch makes BMO refuse to read Secrets from other namespace than where the corresponding BMH resource is. The patch does not change the `BMCEventSubscription` API in BMO, but stricter validation will fail the request at admission time. It will also prevent the controller reading such Secrets, in case the BMCES CR has already been deployed. The issue exists for all versions of BMO, and is patched in BMO releases v0.9.1 and v0.8.1. Prior upgrading to patched BMO version, duplicate any existing Secret pointed to by `BMCEventSubscription`'s `httpHeadersRef` to the same namespace where the corresponding BMH exists. After upgrade, remove the old Secrets. As a workaround, the operator can configure BMO RBAC to be namespace scoped, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces, and/or use `WATCH_NAMESPACE` configuration option to limit BMO to single namespace.",
    "A flaw was found in the Bare Metal Operator (BMO) Kubernetes API component. BMO enables users to load Secrets from arbitrary namespaces upon deployment of the namespace-scoped Custom Resource `BMCEventSubscription`. In affected versions, an adversary using a Kubernetes account with only namespace level roles (e.g. a tenant controlling a namespace) may create a `BMCEventSubscription` in their authorized namespace and then load Secrets from their unauthorized namespaces to another authorized namespace via the Baremetal Operator, which can lead to the exposure of secrets and credential information."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-29781\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-29781\nhttps://github.com/metal3-io/baremetal-operator/commit/19f8443b1fe182f76dd81b43122e8dd102f8b94c\nhttps://github.com/metal3-io/baremetal-operator/pull/2321\nhttps://github.com/metal3-io/baremetal-operator/pull/2322\nhttps://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-c98h-7hp9-v9hq\nhttps://github.com/metal3-io/metal3-docs/blob/main/design/baremetal-operator/bmc-events.md"
  ]
}