{
  "mitigation": "Below are the mitigation steps to avoid the flaw from happening, still it is indicated to update the product after the fix is available.\n1) set GRPC_SERVER_MAX_THREADS_PER_PROCESS = 1\nThis mitigates problems going FORWARD for the issue because then there is only one thread using the ExternalAuth() object instantiated by the parent process, this eliminates the thread safety risk as the worker only processes one request at a time.\n2) It is possible that at any time since install/upgrade of AAP 2.5, that long lived Oauth tokens created in the components with the endpoints could implicate long term access to a different user's identity/privileges. Requests made with these tokens will appear to be from the user for which they were created and are indistinguishable from “valid” tokens that were created by the correct user:\n/api/controller/v2/tokens/\n/api/controller/v2/applications/\u003cid\u003e/tokens/\n/api/galaxy/v3/auth/token/\n/api/controller/o/token/\nBecause it is likely not feasible to back trace every request that could have generated a token to its original request in the GRPC server, the most conservative and safe path to mitigate this risk would be to invalidate/revoke all existing oauth tokens in the components (hub, controller, eda)",
  "affected_release": [
    {
      "product_name": "Red Hat Ansible Automation Platform 2.5 for RHEL 8",
      "release_date": "2025-03-01T00:00:00Z",
      "advisory": "RHSA-2025:1954",
      "package": "automation-gateway-0:2.5.20250305-1.el8ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.5 for RHEL 9",
      "release_date": "2025-03-01T00:00:00Z",
      "advisory": "RHSA-2025:1954",
      "package": "automation-gateway-0:2.5.20250305-1.el9ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el9"
    }
  ],
  "package_state": null,
  "threat_severity": "Important",
  "public_date": "2025-03-01T00:00:00Z",
  "bugzilla": {
    "description": "aap-gateway: aap-gateway privilege escalation",
    "id": "2349081",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2349081"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-362",
  "statement": "Red Hat has evaluated this vulnerability, this affects only AAP 2.5 GA version onwards.",
  "acknowledgement": "This issue was discovered by Chris Meyers (Red Hat) and Elijah DeLee (Red Hat).",
  "name": "CVE-2025-1801",
  "document_distribution": "",
  "details": [
    "No description is available for this CVE."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-1801\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-1801"
  ]
}