{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-01-31T00:00:00Z",
  "bugzilla": {
    "description": "kernel: smb: client: fix double free of TCP_Server_Info::hostname",
    "id": "2343184",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2343184"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21673",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nsmb: client: fix double free of TCP_Server_Info::hostname\nWhen shutting down the server in cifs_put_tcp_session(), cifsd thread\nmight be reconnecting to multiple DFS targets before it realizes it\nshould exit the loop, so @server-\u003ehostname can't be freed as long as\ncifsd thread isn't done.  Otherwise the following can happen:\nRIP: 0010:__slab_free+0x223/0x3c0\nCode: 5e 41 5f c3 cc cc cc cc 4c 89 de 4c 89 cf 44 89 44 24 08 4c 89\n1c 24 e8 fb cf 8e 00 44 8b 44 24 08 4c 8b 1c 24 e9 5f fe ff ff \u003c0f\u003e\n0b 41 f7 45 08 00 0d 21 00 0f 85 2d ff ff ff e9 1f ff ff ff 80\nRSP: 0018:ffffb26180dbfd08 EFLAGS: 00010246\nRAX: ffff8ea34728e510 RBX: ffff8ea34728e500 RCX: 0000000000800068\nRDX: 0000000000800068 RSI: 0000000000000000 RDI: ffff8ea340042400\nRBP: ffffe112041ca380 R08: 0000000000000001 R09: 0000000000000000\nR10: 6170732e31303000 R11: 70726f632e786563 R12: ffff8ea34728e500\nR13: ffff8ea340042400 R14: ffff8ea34728e500 R15: 0000000000800068\nFS: 0000000000000000(0000) GS:ffff8ea66fd80000(0000)\n000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007ffc25376080 CR3: 000000012a2ba001 CR4:\nPKRU: 55555554\nCall Trace:\n\u003cTASK\u003e\n? show_trace_log_lvl+0x1c4/0x2df\n? show_trace_log_lvl+0x1c4/0x2df\n? __reconnect_target_unlocked+0x3e/0x160 [cifs]\n? __die_body.cold+0x8/0xd\n? die+0x2b/0x50\n? do_trap+0xce/0x120\n? __slab_free+0x223/0x3c0\n? do_error_trap+0x65/0x80\n? __slab_free+0x223/0x3c0\n? exc_invalid_op+0x4e/0x70\n? __slab_free+0x223/0x3c0\n? asm_exc_invalid_op+0x16/0x20\n? __slab_free+0x223/0x3c0\n? extract_hostname+0x5c/0xa0 [cifs]\n? extract_hostname+0x5c/0xa0 [cifs]\n? __kmalloc+0x4b/0x140\n__reconnect_target_unlocked+0x3e/0x160 [cifs]\nreconnect_dfs_server+0x145/0x430 [cifs]\ncifs_handle_standard+0x1ad/0x1d0 [cifs]\ncifs_demultiplex_thread+0x592/0x730 [cifs]\n? __pfx_cifs_demultiplex_thread+0x10/0x10 [cifs]\nkthread+0xdd/0x100\n? __pfx_kthread+0x10/0x10\nret_from_fork+0x29/0x50\n\u003c/TASK\u003e"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21673\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21673\nhttps://lore.kernel.org/linux-cve-announce/2025013100-CVE-2025-21673-4465@gregkh/T"
  ]
}