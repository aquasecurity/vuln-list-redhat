{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-03-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: ovl: fix UAF in ovl_dentry_update_reval by moving dput() in ovl_link_up",
    "id": "2355405",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2355405"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21887",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\novl: fix UAF in ovl_dentry_update_reval by moving dput() in ovl_link_up\nThe issue was caused by dput(upper) being called before\novl_dentry_update_reval(), while upper-\u003ed_flags was still\naccessed in ovl_dentry_remote().\nMove dput(upper) after its last use to prevent use-after-free.\nBUG: KASAN: slab-use-after-free in ovl_dentry_remote fs/overlayfs/util.c:162 [inline]\nBUG: KASAN: slab-use-after-free in ovl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c:167\nCall Trace:\n\u003cTASK\u003e\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0x116/0x1f0 lib/dump_stack.c:114\nprint_address_description mm/kasan/report.c:377 [inline]\nprint_report+0xc3/0x620 mm/kasan/report.c:488\nkasan_report+0xd9/0x110 mm/kasan/report.c:601\novl_dentry_remote fs/overlayfs/util.c:162 [inline]\novl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c:167\novl_link_up fs/overlayfs/copy_up.c:610 [inline]\novl_copy_up_one+0x2105/0x3490 fs/overlayfs/copy_up.c:1170\novl_copy_up_flags+0x18d/0x200 fs/overlayfs/copy_up.c:1223\novl_rename+0x39e/0x18c0 fs/overlayfs/dir.c:1136\nvfs_rename+0xf84/0x20a0 fs/namei.c:4893\n...\n\u003c/TASK\u003e"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21887\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21887\nhttps://lore.kernel.org/linux-cve-announce/2025032714-CVE-2025-21887-48e8@gregkh/T"
  ]
}