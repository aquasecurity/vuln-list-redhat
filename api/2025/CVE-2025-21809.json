{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: rxrpc, afs: Fix peer hash locking vs RCU callback",
    "id": "2348889",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348889"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21809",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nrxrpc, afs: Fix peer hash locking vs RCU callback\nIn its address list, afs now retains pointers to and refs on one or more\nrxrpc_peer objects.  The address list is freed under RCU and at this time,\nit puts the refs on those peers.\nNow, when an rxrpc_peer object runs out of refs, it gets removed from the\npeer hash table and, for that, rxrpc has to take a spinlock.  However, it\nis now being called from afs's RCU cleanup, which takes place in BH\ncontext - but it is just taking an ordinary spinlock.\nThe put may also be called from non-BH context, and so there exists the\npossibility of deadlock if the BH-based RCU cleanup happens whilst the hash\nspinlock is held.  This led to the attached lockdep complaint.\nFix this by changing spinlocks of rxnet-\u003epeer_hash_lock back to\nBH-disabling locks.\n================================\nWARNING: inconsistent lock state\n6.13.0-rc5-build2+ #1223 Tainted: G            E\n--------------------------------\ninconsistent {SOFTIRQ-ON-W} -\u003e {IN-SOFTIRQ-W} usage.\nswapper/1/0 [HC0[0]:SC1[1]:HE1:SE0] takes:\nffff88810babe228 (\u0026rxnet-\u003epeer_hash_lock){+.?.}-{3:3}, at: rxrpc_put_peer+0xcb/0x180\n{SOFTIRQ-ON-W} state was registered at:\nmark_usage+0x164/0x180\n__lock_acquire+0x544/0x990\nlock_acquire.part.0+0x103/0x280\n_raw_spin_lock+0x2f/0x40\nrxrpc_peer_keepalive_worker+0x144/0x440\nprocess_one_work+0x486/0x7c0\nprocess_scheduled_works+0x73/0x90\nworker_thread+0x1c8/0x2a0\nkthread+0x19b/0x1b0\nret_from_fork+0x24/0x40\nret_from_fork_asm+0x1a/0x30\nirq event stamp: 972402\nhardirqs last  enabled at (972402): [\u003cffffffff8244360e\u003e] _raw_spin_unlock_irqrestore+0x2e/0x50\nhardirqs last disabled at (972401): [\u003cffffffff82443328\u003e] _raw_spin_lock_irqsave+0x18/0x60\nsoftirqs last  enabled at (972300): [\u003cffffffff810ffbbe\u003e] handle_softirqs+0x3ee/0x430\nsoftirqs last disabled at (972313): [\u003cffffffff810ffc54\u003e] __irq_exit_rcu+0x44/0x110\nother info that might help us debug this:\nPossible unsafe locking scenario:\nCPU0\n----\nlock(\u0026rxnet-\u003epeer_hash_lock);\n\u003cInterrupt\u003e\nlock(\u0026rxnet-\u003epeer_hash_lock);\n*** DEADLOCK ***\n1 lock held by swapper/1/0:\n#0: ffffffff83576be0 (rcu_callback){....}-{0:0}, at: rcu_lock_acquire+0x7/0x30\nstack backtrace:\nCPU: 1 UID: 0 PID: 0 Comm: swapper/1 Tainted: G            E      6.13.0-rc5-build2+ #1223\nTainted: [E]=UNSIGNED_MODULE\nHardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014\nCall Trace:\n\u003cIRQ\u003e\ndump_stack_lvl+0x57/0x80\nprint_usage_bug.part.0+0x227/0x240\nvalid_state+0x53/0x70\nmark_lock_irq+0xa5/0x2f0\nmark_lock+0xf7/0x170\nmark_usage+0xe1/0x180\n__lock_acquire+0x544/0x990\nlock_acquire.part.0+0x103/0x280\n_raw_spin_lock+0x2f/0x40\nrxrpc_put_peer+0xcb/0x180\nafs_free_addrlist+0x46/0x90 [kafs]\nrcu_do_batch+0x2d2/0x640\nrcu_core+0x2f7/0x350\nhandle_softirqs+0x1ee/0x430\n__irq_exit_rcu+0x44/0x110\nirq_exit_rcu+0xa/0x30\nsysvec_apic_timer_interrupt+0x7f/0xa0\n\u003c/IRQ\u003e"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21809\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21809\nhttps://lore.kernel.org/linux-cve-announce/2025022754-CVE-2025-21809-4258@gregkh/T"
  ]
}