{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: mptcp: handle fastopen disconnect correctly",
    "id": "2348635",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348635"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21705",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nmptcp: handle fastopen disconnect correctly\nSyzbot was able to trigger a data stream corruption:\nWARNING: CPU: 0 PID: 9846 at net/mptcp/protocol.c:1024 __mptcp_clean_una+0xddb/0xff0 net/mptcp/protocol.c:1024\nModules linked in:\nCPU: 0 UID: 0 PID: 9846 Comm: syz-executor351 Not tainted 6.13.0-rc2-syzkaller-00059-g00a5acdbf398 #0\nHardware name: Google Compute Engine/Google Compute Engine, BIOS Google 11/25/2024\nRIP: 0010:__mptcp_clean_una+0xddb/0xff0 net/mptcp/protocol.c:1024\nCode: fa ff ff 48 8b 4c 24 18 80 e1 07 fe c1 38 c1 0f 8c 8e fa ff ff 48 8b 7c 24 18 e8 e0 db 54 f6 e9 7f fa ff ff e8 e6 80 ee f5 90 \u003c0f\u003e 0b 90 4c 8b 6c 24 40 4d 89 f4 e9 04 f5 ff ff 44 89 f1 80 e1 07\nRSP: 0018:ffffc9000c0cf400 EFLAGS: 00010293\nRAX: ffffffff8bb0dd5a RBX: ffff888033f5d230 RCX: ffff888059ce8000\nRDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000000\nRBP: ffffc9000c0cf518 R08: ffffffff8bb0d1dd R09: 1ffff110170c8928\nR10: dffffc0000000000 R11: ffffed10170c8929 R12: 0000000000000000\nR13: ffff888033f5d220 R14: dffffc0000000000 R15: ffff8880592b8000\nFS:  00007f6e866496c0(0000) GS:ffff8880b8600000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f6e86f491a0 CR3: 00000000310e6000 CR4: 00000000003526f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n\u003cTASK\u003e\n__mptcp_clean_una_wakeup+0x7f/0x2d0 net/mptcp/protocol.c:1074\nmptcp_release_cb+0x7cb/0xb30 net/mptcp/protocol.c:3493\nrelease_sock+0x1aa/0x1f0 net/core/sock.c:3640\ninet_wait_for_connect net/ipv4/af_inet.c:609 [inline]\n__inet_stream_connect+0x8bd/0xf30 net/ipv4/af_inet.c:703\nmptcp_sendmsg_fastopen+0x2a2/0x530 net/mptcp/protocol.c:1755\nmptcp_sendmsg+0x1884/0x1b10 net/mptcp/protocol.c:1830\nsock_sendmsg_nosec net/socket.c:711 [inline]\n__sock_sendmsg+0x1a6/0x270 net/socket.c:726\n____sys_sendmsg+0x52a/0x7e0 net/socket.c:2583\n___sys_sendmsg net/socket.c:2637 [inline]\n__sys_sendmsg+0x269/0x350 net/socket.c:2669\ndo_syscall_x64 arch/x86/entry/common.c:52 [inline]\ndo_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\nentry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7f6e86ebfe69\nCode: 28 00 00 00 75 05 48 83 c4 28 c3 e8 b1 1f 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 \u003c48\u003e 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b0 ff ff ff f7 d8 64 89 01 48\nRSP: 002b:00007f6e86649168 EFLAGS: 00000246 ORIG_RAX: 000000000000002e\nRAX: ffffffffffffffda RBX: 00007f6e86f491b8 RCX: 00007f6e86ebfe69\nRDX: 0000000030004001 RSI: 0000000020000080 RDI: 0000000000000003\nRBP: 00007f6e86f491b0 R08: 00007f6e866496c0 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000246 R12: 00007f6e86f491bc\nR13: 000000000000006e R14: 00007ffe445d9420 R15: 00007ffe445d9508\n\u003c/TASK\u003e\nThe root cause is the bad handling of disconnect() generated internally\nby the MPTCP protocol in case of connect FASTOPEN errors.\nAddress the issue increasing the socket disconnect counter even on such\na case, to allow other threads waiting on the same socket lock to\nproperly error out."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21705\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21705\nhttps://lore.kernel.org/linux-cve-announce/2025022642-CVE-2025-21705-c7e5@gregkh/T"
  ]
}