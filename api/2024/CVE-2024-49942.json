{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-10-21T00:00:00Z",
  "bugzilla": {
    "description": "kernel: drm/xe: Prevent null pointer access in xe_migrate_copy",
    "id": "2320445",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2320445"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-49942",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\ndrm/xe: Prevent null pointer access in xe_migrate_copy\nxe_migrate_copy designed to copy content of TTM resources. When source\nresource is null, it will trigger a NULL pointer dereference in\nxe_migrate_copy. To avoid this situation, update lacks source flag to\ntrue for this case, the flag will trigger xe_migrate_clear rather than\nxe_migrate_copy.\nIssue trace:\n\u003c7\u003e [317.089847] xe 0000:00:02.0: [drm:xe_migrate_copy [xe]] Pass 14,\nsizes: 4194304 \u0026 4194304\n\u003c7\u003e [317.089945] xe 0000:00:02.0: [drm:xe_migrate_copy [xe]] Pass 15,\nsizes: 4194304 \u0026 4194304\n\u003c1\u003e [317.128055] BUG: kernel NULL pointer dereference, address:\n0000000000000010\n\u003c1\u003e [317.128064] #PF: supervisor read access in kernel mode\n\u003c1\u003e [317.128066] #PF: error_code(0x0000) - not-present page\n\u003c6\u003e [317.128069] PGD 0 P4D 0\n\u003c4\u003e [317.128071] Oops: Oops: 0000 [#1] PREEMPT SMP NOPTI\n\u003c4\u003e [317.128074] CPU: 1 UID: 0 PID: 1440 Comm: kunit_try_catch Tainted:\nG     U           N 6.11.0-rc7-xe #1\n\u003c4\u003e [317.128078] Tainted: [U]=USER, [N]=TEST\n\u003c4\u003e [317.128080] Hardware name: Intel Corporation Lunar Lake Client\nPlatform/LNL-M LP5 RVP1, BIOS LNLMFWI1.R00.3221.D80.2407291239 07/29/2024\n\u003c4\u003e [317.128082] RIP: 0010:xe_migrate_copy+0x66/0x13e0 [xe]\n\u003c4\u003e [317.128158] Code: 00 00 48 89 8d e0 fe ff ff 48 8b 40 10 4c 89 85 c8\nfe ff ff 44 88 8d bd fe ff ff 65 48 8b 3c 25 28 00 00 00 48 89 7d d0 31\nff \u003c8b\u003e 79 10 48 89 85 a0 fe ff ff 48 8b 00 48 89 b5 d8 fe ff ff 83 ff\n\u003c4\u003e [317.128162] RSP: 0018:ffffc9000167f9f0 EFLAGS: 00010246\n\u003c4\u003e [317.128164] RAX: ffff8881120d8028 RBX: ffff88814d070428 RCX:\n0000000000000000\n\u003c4\u003e [317.128166] RDX: ffff88813cb99c00 RSI: 0000000004000000 RDI:\n0000000000000000\n\u003c4\u003e [317.128168] RBP: ffffc9000167fbb8 R08: ffff88814e7b1f08 R09:\n0000000000000001\n\u003c4\u003e [317.128170] R10: 0000000000000001 R11: 0000000000000001 R12:\nffff88814e7b1f08\n\u003c4\u003e [317.128172] R13: ffff88814e7b1f08 R14: ffff88813cb99c00 R15:\n0000000000000001\n\u003c4\u003e [317.128174] FS:  0000000000000000(0000) GS:ffff88846f280000(0000)\nknlGS:0000000000000000\n\u003c4\u003e [317.128176] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n\u003c4\u003e [317.128178] CR2: 0000000000000010 CR3: 000000011f676004 CR4:\n0000000000770ef0\n\u003c4\u003e [317.128180] DR0: 0000000000000000 DR1: 0000000000000000 DR2:\n0000000000000000\n\u003c4\u003e [317.128182] DR3: 0000000000000000 DR6: 00000000ffff07f0 DR7:\n0000000000000400\n\u003c4\u003e [317.128184] PKRU: 55555554\n\u003c4\u003e [317.128185] Call Trace:\n\u003c4\u003e [317.128187]  \u003cTASK\u003e\n\u003c4\u003e [317.128189]  ? show_regs+0x67/0x70\n\u003c4\u003e [317.128194]  ? __die_body+0x20/0x70\n\u003c4\u003e [317.128196]  ? __die+0x2b/0x40\n\u003c4\u003e [317.128198]  ? page_fault_oops+0x15f/0x4e0\n\u003c4\u003e [317.128203]  ? do_user_addr_fault+0x3fb/0x970\n\u003c4\u003e [317.128205]  ? lock_acquire+0xc7/0x2e0\n\u003c4\u003e [317.128209]  ? exc_page_fault+0x87/0x2b0\n\u003c4\u003e [317.128212]  ? asm_exc_page_fault+0x27/0x30\n\u003c4\u003e [317.128216]  ? xe_migrate_copy+0x66/0x13e0 [xe]\n\u003c4\u003e [317.128263]  ? __lock_acquire+0xb9d/0x26f0\n\u003c4\u003e [317.128265]  ? __lock_acquire+0xb9d/0x26f0\n\u003c4\u003e [317.128267]  ? sg_free_append_table+0x20/0x80\n\u003c4\u003e [317.128271]  ? lock_acquire+0xc7/0x2e0\n\u003c4\u003e [317.128273]  ? mark_held_locks+0x4d/0x80\n\u003c4\u003e [317.128275]  ? trace_hardirqs_on+0x1e/0xd0\n\u003c4\u003e [317.128278]  ? _raw_spin_unlock_irqrestore+0x31/0x60\n\u003c4\u003e [317.128281]  ? __pm_runtime_resume+0x60/0xa0\n\u003c4\u003e [317.128284]  xe_bo_move+0x682/0xc50 [xe]\n\u003c4\u003e [317.128315]  ? lock_is_held_type+0xaa/0x120\n\u003c4\u003e [317.128318]  ttm_bo_handle_move_mem+0xe5/0x1a0 [ttm]\n\u003c4\u003e [317.128324]  ttm_bo_validate+0xd1/0x1a0 [ttm]\n\u003c4\u003e [317.128328]  shrink_test_run_device+0x721/0xc10 [xe]\n\u003c4\u003e [317.128360]  ? find_held_lock+0x31/0x90\n\u003c4\u003e [317.128363]  ? lock_release+0xd1/0x2a0\n\u003c4\u003e [317.128365]  ? __pfx_kunit_generic_run_threadfn_adapter+0x10/0x10\n[kunit]\n\u003c4\u003e [317.128370]  xe_bo_shrink_kunit+0x11/0x20 [xe]\n\u003c4\u003e [317.128397]  kunit_try_run_case+0x6e/0x150 [kunit]\n\u003c4\u003e [317.128400]  ? trace_hardirqs_on+0x1e/0xd0\n\u003c4\u003e [317.128402]  ? _raw_spin_unlock_irqrestore+0x31/0x60\n\u003c4\u003e [317.128404]  kunit_generic_run_threadfn_adapter+0x1e/0x40 [ku\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-49942\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-49942\nhttps://lore.kernel.org/linux-cve-announce/2024102128-CVE-2024-49942-b97c@gregkh/T"
  ]
}