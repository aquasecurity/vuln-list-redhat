{
  "mitigation": "Currently the following options exist to help mitigate the impact of this vulnerability: \n1) Restrict Permissions: the creation of PL/Python and PL/Perl functions should be limited to trusted users only. \n2) Environment Variable Sanitization: ensure that environment variables are properly sanitized and any modifications are restricted.\n3) Upgrade PostgreSQL: if a fix is released by the PostgreSQL Global Development Group, update to the latest version.\n4) Audit Database Functions: perform regular audits on user-created functions to detect and prevent potential exploitation.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "postgresql:12/postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "postgresql:13/postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "postgresql:15/postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "postgresql:16/postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "postgresql:15/postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "postgresql:16/postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-11-14T13:00:08Z",
  "bugzilla": {
    "description": "postgresql: PostgreSQL PL/Perl environment variable changes execute arbitrary code",
    "id": "2326253",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2326253"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "8.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-15",
  "statement": "This vulnerability has been given a severity rating of important because the ability to modify sensitive process environment variables (ex. PATH) can lead to unauthorized code execution and privilege escalation. Depending on the privileges of the PostgreSQL user, an attacker may be able to gain higher-level access to the underlying server and create functions who modify environment variables and execute arbitrary commands.",
  "acknowledgement": "",
  "name": "CVE-2024-10979",
  "document_distribution": "",
  "details": [
    "Incorrect control of environment variables in PostgreSQL PL/Perl allows an unprivileged database user to change sensitive process environment variables (e.g. PATH).  That often suffices to enable arbitrary code execution, even if the attacker lacks a database server operating system user.  Versions before PostgreSQL 17.1, 16.5, 15.9, 14.14, 13.17, and 12.21 are affected.",
    "A flaw was found in PostgreSQL PL/Perl. This vulnerability allows an unprivileged database user to change sensitive process environment variables (e.g., PATH) via incorrect control of environment variables."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-10979\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-10979\nhttps://www.postgresql.org/support/security/CVE-2024-10979/"
  ]
}