{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "OpenShift Lightspeed",
      "fix_state": "Affected",
      "package_name": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
      "cpe": "cpe:/a:redhat:openshift_lightspeed"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2025-03-20T10:09:06Z",
  "bugzilla": {
    "description": "llama-index: Denial of Service (DoS) in run-llama/llama_index",
    "id": "2353770",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2353770"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-755",
  "statement": "This vulnerability marked as high severity rather than moderate due to its potential to cause a complete Denial of Service (DoS) in affected applications. This flaw can be triggered trivially by supplying an invalid input type.\nSince there is no exception handling when the prediction thread terminates prematurely, the get_response_gen function enters an infinite loop, consuming CPU resources indefinitely. This not only disrupts service availability but can also impact multi-threaded environments where stalled threads accumulate, degrading overall system performance.",
  "acknowledgement": "",
  "name": "CVE-2024-12704",
  "document_distribution": "",
  "details": [
    "A vulnerability in the LangChainLLM class of the run-llama/llama_index repository, version v0.12.5, allows for a Denial of Service (DoS) attack. The stream_complete method executes the llm using a thread and retrieves the result via the get_response_gen method of the StreamingGeneratorCallbackHandler class. If the thread terminates abnormally before the _llm.predict is executed, there is no exception handling for this case, leading to an infinite loop in the get_response_gen function. This can be triggered by providing an input of an incorrect type, causing the thread to terminate and the process to continue running indefinitely.",
    "A flaw was found in the run-llama/llama_index. This vulnerability allows for a denial of service (DoS) attack via improper exception handling in the stream_complete method, which leads to an infinite loop in get_response_gen when the execution thread terminates abnormally."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-12704\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-12704\nhttps://github.com/run-llama/llama_index/commit/d1ecfb77578d089cbe66728f18f635c09aa32a05\nhttps://huntr.com/bounties/a0b638fd-21c6-4ba7-b381-6ab98472a02a"
  ]
}