{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-12-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: wifi: ath12k: fix use-after-free in ath12k_dp_cc_cleanup()",
    "id": "2334456",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2334456"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-56541",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nwifi: ath12k: fix use-after-free in ath12k_dp_cc_cleanup()\nDuring ath12k module removal, in ath12k_core_deinit(),\nath12k_mac_destroy() un-registers ah-\u003ehw from mac80211 and frees\nthe ah-\u003ehw as well as all the ar's in it. After this\nath12k_core_soc_destroy()-\u003e ath12k_dp_free()-\u003e ath12k_dp_cc_cleanup()\ntries to access one of the freed ar's from pending skb.\nThis is because during mac destroy, driver failed to flush few\ndata packets, which were accessed later in ath12k_dp_cc_cleanup()\nand freed, but using ar from the packet led to this use-after-free.\nBUG: KASAN: use-after-free in ath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]\nWrite of size 4 at addr ffff888150bd3514 by task modprobe/8926\nCPU: 0 UID: 0 PID: 8926 Comm: modprobe Not tainted\n6.11.0-rc2-wt-ath+ #1746\nHardware name: Intel(R) Client Systems NUC8i7HVK/NUC8i7HVB, BIOS\nHNKBLi70.86A.0067.2021.0528.1339 05/28/2021\nCall Trace:\n\u003cTASK\u003e\ndump_stack_lvl+0x7d/0xe0\nprint_address_description.constprop.0+0x33/0x3a0\nprint_report+0xb5/0x260\n? kasan_addr_to_slab+0x24/0x80\nkasan_report+0xd8/0x110\n? ath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]\n? ath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]\nkasan_check_range+0xf3/0x1a0\n__kasan_check_write+0x14/0x20\nath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]\nath12k_dp_free+0x178/0x420 [ath12k]\nath12k_core_stop+0x176/0x200 [ath12k]\nath12k_core_deinit+0x13f/0x210 [ath12k]\nath12k_pci_remove+0xad/0x1c0 [ath12k]\npci_device_remove+0x9b/0x1b0\ndevice_remove+0xbf/0x150\ndevice_release_driver_internal+0x3c3/0x580\n? __kasan_check_read+0x11/0x20\ndriver_detach+0xc4/0x190\nbus_remove_driver+0x130/0x2a0\ndriver_unregister+0x68/0x90\npci_unregister_driver+0x24/0x240\n? find_module_all+0x13e/0x1e0\nath12k_pci_exit+0x10/0x20 [ath12k]\n__do_sys_delete_module+0x32c/0x580\n? module_flags+0x2f0/0x2f0\n? kmem_cache_free+0xf0/0x410\n? __fput+0x56f/0xab0\n? __fput+0x56f/0xab0\n? debug_smp_processor_id+0x17/0x20\n__x64_sys_delete_module+0x4f/0x70\nx64_sys_call+0x522/0x9f0\ndo_syscall_64+0x64/0x130\nentry_SYSCALL_64_after_hwframe+0x4b/0x53\nRIP: 0033:0x7f8182c6ac8b\nCommit 24de1b7b231c (\"wifi: ath12k: fix flush failure in recovery\nscenarios\") added the change to decrement the pending packets count\nin case of recovery which make sense as ah-\u003ehw as well all\nar's in it are intact during recovery, but during core deinit there\nis no use in decrementing packets count or waking up the empty waitq\nas the module is going to be removed also ar's from pending skb's\ncan't be used and the packets should just be released back.\nTo fix this, avoid accessing ar from skb-\u003ecb when driver is being\nunregistered.\nTested-on: QCN9274 hw2.0 PCI WLAN.WBE.1.1.1-00214-QCAHKSWPL_SILICONZ-1\nTested-on: WCN7850 hw2.0 PCI WLAN.HMT.1.0.c5-00481-QCAHMTSWPL_V1.0_V2.0_SILICONZ-3"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-56541\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-56541\nhttps://lore.kernel.org/linux-cve-announce/2024122727-CVE-2024-56541-1c83@gregkh/T"
  ]
}