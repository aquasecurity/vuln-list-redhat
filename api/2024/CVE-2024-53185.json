{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Low",
  "public_date": "2024-12-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: smb: client: fix NULL ptr deref in crypto_aead_setkey()",
    "id": "2334393",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2334393"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-53185",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nsmb: client: fix NULL ptr deref in crypto_aead_setkey()\nNeither SMB3.0 or SMB3.02 supports encryption negotiate context, so\nwhen SMB2_GLOBAL_CAP_ENCRYPTION flag is set in the negotiate response,\nthe client uses AES-128-CCM as the default cipher.  See MS-SMB2\n3.3.5.4.\nCommit b0abcd65ec54 (\"smb: client: fix UAF in async decryption\") added\na @server-\u003ecipher_type check to conditionally call\nsmb3_crypto_aead_allocate(), but that check would always be false as\n@server-\u003ecipher_type is unset for SMB3.02.\nFix the following KASAN splat by setting @server-\u003ecipher_type for\nSMB3.02 as well.\nmount.cifs //srv/share /mnt -o vers=3.02,seal,...\nBUG: KASAN: null-ptr-deref in crypto_aead_setkey+0x2c/0x130\nRead of size 8 at addr 0000000000000020 by task mount.cifs/1095\nCPU: 1 UID: 0 PID: 1095 Comm: mount.cifs Not tainted 6.12.0 #1\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc41\n04/01/2014\nCall Trace:\n\u003cTASK\u003e\ndump_stack_lvl+0x5d/0x80\n? crypto_aead_setkey+0x2c/0x130\nkasan_report+0xda/0x110\n? crypto_aead_setkey+0x2c/0x130\ncrypto_aead_setkey+0x2c/0x130\ncrypt_message+0x258/0xec0 [cifs]\n? __asan_memset+0x23/0x50\n? __pfx_crypt_message+0x10/0x10 [cifs]\n? mark_lock+0xb0/0x6a0\n? hlock_class+0x32/0xb0\n? mark_lock+0xb0/0x6a0\nsmb3_init_transform_rq+0x352/0x3f0 [cifs]\n? lock_acquire.part.0+0xf4/0x2a0\nsmb_send_rqst+0x144/0x230 [cifs]\n? __pfx_smb_send_rqst+0x10/0x10 [cifs]\n? hlock_class+0x32/0xb0\n? smb2_setup_request+0x225/0x3a0 [cifs]\n? __pfx_cifs_compound_last_callback+0x10/0x10 [cifs]\ncompound_send_recv+0x59b/0x1140 [cifs]\n? __pfx_compound_send_recv+0x10/0x10 [cifs]\n? __create_object+0x5e/0x90\n? hlock_class+0x32/0xb0\n? do_raw_spin_unlock+0x9a/0xf0\ncifs_send_recv+0x23/0x30 [cifs]\nSMB2_tcon+0x3ec/0xb30 [cifs]\n? __pfx_SMB2_tcon+0x10/0x10 [cifs]\n? lock_acquire.part.0+0xf4/0x2a0\n? __pfx_lock_release+0x10/0x10\n? do_raw_spin_trylock+0xc6/0x120\n? lock_acquire+0x3f/0x90\n? _get_xid+0x16/0xd0 [cifs]\n? __pfx_SMB2_tcon+0x10/0x10 [cifs]\n? cifs_get_smb_ses+0xcdd/0x10a0 [cifs]\ncifs_get_smb_ses+0xcdd/0x10a0 [cifs]\n? __pfx_cifs_get_smb_ses+0x10/0x10 [cifs]\n? cifs_get_tcp_session+0xaa0/0xca0 [cifs]\ncifs_mount_get_session+0x8a/0x210 [cifs]\ndfs_mount_share+0x1b0/0x11d0 [cifs]\n? __pfx___lock_acquire+0x10/0x10\n? __pfx_dfs_mount_share+0x10/0x10 [cifs]\n? lock_acquire.part.0+0xf4/0x2a0\n? find_held_lock+0x8a/0xa0\n? hlock_class+0x32/0xb0\n? lock_release+0x203/0x5d0\ncifs_mount+0xb3/0x3d0 [cifs]\n? do_raw_spin_trylock+0xc6/0x120\n? __pfx_cifs_mount+0x10/0x10 [cifs]\n? lock_acquire+0x3f/0x90\n? find_nls+0x16/0xa0\n? smb3_update_mnt_flags+0x372/0x3b0 [cifs]\ncifs_smb3_do_mount+0x1e2/0xc80 [cifs]\n? __pfx_vfs_parse_fs_string+0x10/0x10\n? __pfx_cifs_smb3_do_mount+0x10/0x10 [cifs]\nsmb3_get_tree+0x1bf/0x330 [cifs]\nvfs_get_tree+0x4a/0x160\npath_mount+0x3c1/0xfb0\n? kasan_quarantine_put+0xc7/0x1d0\n? __pfx_path_mount+0x10/0x10\n? kmem_cache_free+0x118/0x3e0\n? user_path_at+0x74/0xa0\n__x64_sys_mount+0x1a6/0x1e0\n? __pfx___x64_sys_mount+0x10/0x10\n? mark_held_locks+0x1a/0x90\ndo_syscall_64+0xbb/0x1d0\nentry_SYSCALL_64_after_hwframe+0x77/0x7f"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-53185\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-53185\nhttps://lore.kernel.org/linux-cve-announce/2024122721-CVE-2024-53185-16d6@gregkh/T"
  ]
}