{
  "mitigation": "To mitigate this vulnerabilty restrict user-controlled template filenames, ensuring they follow a predefined templates.",
  "affected_release": [
    {
      "product_name": "Ansible Automation Platform Execution Environments",
      "release_date": "2025-01-28T00:00:00Z",
      "advisory": "RHSA-2025:0753",
      "package": "ansible-automation-platform/ee-minimal-rhel8:2.13.10-37",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:ee::el8"
    },
    {
      "product_name": "Ansible Automation Platform Execution Environments",
      "release_date": "2025-01-28T00:00:00Z",
      "advisory": "RHSA-2025:0753",
      "package": "ansible-automation-platform/ee-minimal-rhel9:2.18.1-4",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:ee::el8"
    },
    {
      "product_name": "Ansible Automation Platform Execution Environments",
      "release_date": "2025-02-05T00:00:00Z",
      "advisory": "RHSA-2025:1101",
      "package": "ansible-automation-platform/ee-minimal-rhel8:2.13.10-39",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:ee::el8"
    },
    {
      "product_name": "Ansible Automation Platform Execution Environments",
      "release_date": "2025-02-05T00:00:00Z",
      "advisory": "RHSA-2025:1101",
      "package": "ansible-automation-platform/ee-minimal-rhel9:2.18.2-4",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:ee::el8"
    },
    {
      "product_name": "Discovery 1 for RHEL 9",
      "release_date": "2025-02-10T00:00:00Z",
      "advisory": "RHSA-2025:1249",
      "package": "discovery/discovery-server-rhel9:1.12.0-1",
      "cpe": "cpe:/o:redhat:discovery:1.0::el9"
    },
    {
      "product_name": "Discovery 1 for RHEL 9",
      "release_date": "2025-02-10T00:00:00Z",
      "advisory": "RHSA-2025:1249",
      "package": "discovery/discovery-ui-rhel9:1.12.0-1",
      "cpe": "cpe:/o:redhat:discovery:1.0::el9"
    },
    {
      "product_name": "Ironic content for Red Hat OpenShift Container Platform 4.12",
      "release_date": "2025-02-06T00:00:00Z",
      "advisory": "RHSA-2025:0834",
      "package": "python-jinja2-0:3.0.1-6.el9.2",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.12::el9"
    },
    {
      "product_name": "Ironic content for Red Hat OpenShift Container Platform 4.13",
      "release_date": "2025-02-13T00:00:00Z",
      "advisory": "RHSA-2025:1118",
      "package": "python-jinja2-0:3.0.1-6.el9.2",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.13::el9"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
      "release_date": "2025-01-27T00:00:00Z",
      "advisory": "RHSA-2025:0721",
      "package": "automation-controller-0:4.5.17-1.el8ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
      "release_date": "2025-01-27T00:00:00Z",
      "advisory": "RHSA-2025:0721",
      "package": "python3x-jinja2-0:3.1.5-1.el8ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
      "release_date": "2025-01-27T00:00:00Z",
      "advisory": "RHSA-2025:0722",
      "package": "ansible-automation-platform-24/lightspeed-rhel8-operator:2.4-33",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
      "release_date": "2025-01-27T00:00:00Z",
      "advisory": "RHSA-2025:0721",
      "package": "automation-controller-0:4.5.17-1.el9ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
      "release_date": "2025-01-27T00:00:00Z",
      "advisory": "RHSA-2025:0721",
      "package": "python-jinja2-0:3.1.5-1.el9ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.4::el9"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.5 for RHEL 8",
      "release_date": "2025-01-15T00:00:00Z",
      "advisory": "RHSA-2025:0341",
      "package": "ansible-automation-platform-25/lightspeed-rhel8:2.5.250107-1",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.5 for RHEL 8",
      "release_date": "2025-01-28T00:00:00Z",
      "advisory": "RHSA-2025:0777",
      "package": "automation-controller-0:4.6.7-1.el8ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.5 for RHEL 8",
      "release_date": "2025-01-28T00:00:00Z",
      "advisory": "RHSA-2025:0777",
      "package": "python3.11-jinja2-0:3.1.5-1.el8ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el8"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.5 for RHEL 9",
      "release_date": "2025-01-28T00:00:00Z",
      "advisory": "RHSA-2025:0777",
      "package": "automation-controller-0:4.6.7-1.el9ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el9"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2.5 for RHEL 9",
      "release_date": "2025-01-28T00:00:00Z",
      "advisory": "RHSA-2025:0777",
      "package": "python3.11-jinja2-0:3.1.5-1.el9ap",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2.5::el9"
    },
    {
      "product_name": "Red Hat Developer Hub 1.3 on RHEL 9",
      "release_date": "2025-01-22T00:00:00Z",
      "advisory": "RHBA-2025:0610",
      "package": "rhdh-hub-container-1.3-138",
      "cpe": "cpe:/a:redhat:rhdh:1.3::el9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2025-01-14T00:00:00Z",
      "advisory": "RHSA-2025:0308",
      "package": "fence-agents-0:4.10.0-76.el9_5.4",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Update Services for SAP Solutions",
      "release_date": "2025-01-15T00:00:00Z",
      "advisory": "RHSA-2025:0345",
      "package": "fence-agents-0:4.10.0-20.el9_0.20",
      "cpe": "cpe:/a:redhat:rhel_e4s:9.0"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2025-01-15T00:00:00Z",
      "advisory": "RHSA-2025:0335",
      "package": "fence-agents-0:4.10.0-43.el9_2.11",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2025-01-15T00:00:00Z",
      "advisory": "RHSA-2025:0338",
      "package": "fence-agents-0:4.10.0-62.el9_4.10",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.14",
      "release_date": "2025-02-06T00:00:00Z",
      "advisory": "RHSA-2025:0842",
      "package": "python-jinja2-0:3.0.1-6.el9.2",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.14::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.15",
      "release_date": "2025-02-12T00:00:00Z",
      "advisory": "RHSA-2025:1130",
      "package": "python-jinja2-0:3.0.1-6.el9.2",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.15::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.16",
      "release_date": "2025-02-12T00:00:00Z",
      "advisory": "RHSA-2025:1123",
      "package": "openshift4/ose-ansible-rhel9-operator:v4.16.0-202501311735.p0.g2cb0020.assembly.stream.el9",
      "cpe": "cpe:/a:redhat:openshift:4.16::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.16",
      "release_date": "2025-02-10T00:00:00Z",
      "advisory": "RHSA-2025:0830",
      "package": "python-jinja2-0:3.0.1-6.el9.2",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.16::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.17",
      "release_date": "2025-02-05T00:00:00Z",
      "advisory": "RHSA-2025:0875",
      "package": "openshift4/ose-ansible-rhel9-operator:v4.17.0-202501300634.p0.g9cb5839.assembly.stream.el9",
      "cpe": "cpe:/a:redhat:openshift:4.17::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.17",
      "release_date": "2025-01-28T00:00:00Z",
      "advisory": "RHSA-2025:0656",
      "package": "python-jinja2-0:3.1.5-1.el9",
      "cpe": "cpe:/a:redhat:openshift_ironic:4.17::el9"
    },
    {
      "product_name": "Red Hat OpenStack Platform 17.1 for RHEL 9",
      "release_date": "2025-02-25T00:00:00Z",
      "advisory": "RHSA-2025:1861",
      "package": "openstack-ansible-core-0:2.14.2-4.6.el9ost",
      "cpe": "cpe:/a:redhat:openstack:17.1::el9"
    },
    {
      "product_name": "Red Hat Developer Hub (RHDH) 1.4",
      "release_date": "2025-01-20T00:00:00Z",
      "advisory": "RHBA-2025:0409",
      "package": "registry.redhat.io/rhdh/rhdh-hub-rhel9:sha256:d8268197ba0466643efb818fcad8f0fc29e32463f75b0f7f51d9ce75ec717572",
      "cpe": "cpe:/a:redhat:rhdh:1.4::el9"
    }
  ],
  "package_state": [
    {
      "product_name": "OpenShift Lightspeed",
      "fix_state": "Affected",
      "package_name": "openshift-lightspeed-tech-preview/lightspeed-service-api-rhel9",
      "cpe": "cpe:/a:redhat:openshift_lightspeed"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 1.2",
      "fix_state": "Will not fix",
      "package_name": "ansible-tower",
      "cpe": "cpe:/a:redhat:ansible_automation_platform"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Will not fix",
      "package_name": "aap-cloud-metrics-collector-container",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Will not fix",
      "package_name": "ansible-automation-platform-24/de-supported-rhel8",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Will not fix",
      "package_name": "ansible-automation-platform-24/ee-dellemc-openmanage-rhel8",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Will not fix",
      "package_name": "ansible-automation-platform-25/ansible-dev-tools-rhel8",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Ansible Automation Platform 2",
      "fix_state": "Will not fix",
      "package_name": "ansible-automation-platform-25/platform-resource-runner-rhel8",
      "cpe": "cpe:/a:redhat:ansible_automation_platform:2"
    },
    {
      "product_name": "Red Hat Developer Hub",
      "fix_state": "Not affected",
      "package_name": "rhdh/rhdh-rhel9-operator",
      "cpe": "cpe:/a:redhat:rhdh:1"
    },
    {
      "product_name": "Red Hat Discovery",
      "fix_state": "Affected",
      "package_name": "discovery-server-container",
      "cpe": "cpe:/a:redhat:discovery:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "keylime-registrar-container",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-amd-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-aws-nvidia-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-azure-amd-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-azure-nvidia-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-gcp-nvidia-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-ibm-nvidia-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-intel-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/bootc-nvidia-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/instructlab-amd-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/instructlab-intel-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat Enterprise Linux AI (RHEL AI)",
      "fix_state": "Affected",
      "package_name": "rhelai1/instructlab-nvidia-rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux_ai:1"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Not affected",
      "package_name": "rhoai/odh-ml-pipelines-api-server-v2-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Not affected",
      "package_name": "rhoai/odh-ml-pipelines-driver-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Not affected",
      "package_name": "rhoai/odh-ml-pipelines-launcher-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Not affected",
      "package_name": "rhoai/odh-ml-pipelines-persistenceagent-v2-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Not affected",
      "package_name": "rhoai/odh-ml-pipelines-scheduledworkflow-v2-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift AI (RHOAI)",
      "fix_state": "Affected",
      "package_name": "rhoai/odh-model-registry-rhel8",
      "cpe": "cpe:/a:redhat:openshift_ai"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Not affected",
      "package_name": "openshift4/cnf-tests-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "openshift4/ose-ovn-kubernetes",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "openshift4/ose-ovn-kubernetes-microshift-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "openshift4/ztp-site-generate-rhel8",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-collector-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-operator-bundle",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Affected",
      "package_name": "rhosdt/opentelemetry-rhel8-operator",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenShift distributed tracing 3",
      "fix_state": "Will not fix",
      "package_name": "rhosdt/opentelemetry-target-allocator-rhel8",
      "cpe": "cpe:/a:redhat:openshift_distributed_tracing:3"
    },
    {
      "product_name": "Red Hat OpenStack Platform 18.0",
      "fix_state": "Affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:openstack:18.0"
    },
    {
      "product_name": "Red Hat Quay 3",
      "fix_state": "Affected",
      "package_name": "quay/quay-rhel8",
      "cpe": "cpe:/a:redhat:quay:3"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Update Infrastructure 4 for Cloud Providers",
      "fix_state": "Not affected",
      "package_name": "python-jinja2",
      "cpe": "cpe:/a:redhat:rhui:4::el8"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-12-23T15:37:36Z",
  "bugzilla": {
    "description": "jinja2: Jinja has a sandbox breakout through malicious filenames",
    "id": "2333854",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2333854"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-150",
  "statement": "This vulnerability has rated as a IMPORTANT flaw because an attacker controlling both the template content and filename to execute arbitrary Python code, bypassing the sandbox.",
  "acknowledgement": "",
  "name": "CVE-2024-56201",
  "document_distribution": "",
  "details": [
    "Jinja is an extensible templating engine. In versions on the 3.x branch prior to 3.1.5, a bug in the Jinja compiler allows an attacker that controls both the content and filename of a template to execute arbitrary Python code, regardless of if Jinja's sandbox is used. To exploit the vulnerability, an attacker needs to control both the filename and the contents of a template. Whether that is the case depends on the type of application using Jinja. This vulnerability impacts users of applications which execute untrusted templates where the template author can also choose the template filename. This vulnerability is fixed in 3.1.5.",
    "A flaw was found in the Jinja2 package. A bug in the Jinja compiler allows an attacker that controls both the content and filename of a template to execute arbitrary Python code, regardless of Jinja's sandbox being used. An attacker needs to be able to control both the filename and the contents of a template. Whether that is the case depends on the type of application using Jinja. This vulnerability impacts users of applications that execute untrusted templates where the template author can also choose the template filename."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-56201\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-56201\nhttps://github.com/pallets/jinja/commit/767b23617628419ae3709ccfb02f9602ae9fe51f\nhttps://github.com/pallets/jinja/issues/1792\nhttps://github.com/pallets/jinja/releases/tag/3.1.5\nhttps://github.com/pallets/jinja/security/advisories/GHSA-gmj6-6f8f-6699"
  ]
}