{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-11-07T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net/mlx5: Fix command bitmask initialization",
    "id": "2324338",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2324338"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-50147",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet/mlx5: Fix command bitmask initialization\nCommand bitmask have a dedicated bit for MANAGE_PAGES command, this bit\nisn't Initialize during command bitmask Initialization, only during\nMANAGE_PAGES.\nIn addition, mlx5_cmd_trigger_completions() is trying to trigger\ncompletion for MANAGE_PAGES command as well.\nHence, in case health error occurred before any MANAGE_PAGES command\nhave been invoke (for example, during mlx5_enable_hca()),\nmlx5_cmd_trigger_completions() will try to trigger completion for\nMANAGE_PAGES command, which will result in null-ptr-deref error.[1]\nFix it by Initialize command bitmask correctly.\nWhile at it, re-write the code for better understanding.\n[1]\nBUG: KASAN: null-ptr-deref in mlx5_cmd_trigger_completions+0x1db/0x600 [mlx5_core]\nWrite of size 4 at addr 0000000000000214 by task kworker/u96:2/12078\nCPU: 10 PID: 12078 Comm: kworker/u96:2 Not tainted 6.9.0-rc2_for_upstream_debug_2024_04_07_19_01 #1\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\nWorkqueue: mlx5_health0000:08:00.0 mlx5_fw_fatal_reporter_err_work [mlx5_core]\nCall Trace:\n\u003cTASK\u003e\ndump_stack_lvl+0x7e/0xc0\nkasan_report+0xb9/0xf0\nkasan_check_range+0xec/0x190\nmlx5_cmd_trigger_completions+0x1db/0x600 [mlx5_core]\nmlx5_cmd_flush+0x94/0x240 [mlx5_core]\nenter_error_state+0x6c/0xd0 [mlx5_core]\nmlx5_fw_fatal_reporter_err_work+0xf3/0x480 [mlx5_core]\nprocess_one_work+0x787/0x1490\n? lockdep_hardirqs_on_prepare+0x400/0x400\n? pwq_dec_nr_in_flight+0xda0/0xda0\n? assign_work+0x168/0x240\nworker_thread+0x586/0xd30\n? rescuer_thread+0xae0/0xae0\nkthread+0x2df/0x3b0\n? kthread_complete_and_exit+0x20/0x20\nret_from_fork+0x2d/0x70\n? kthread_complete_and_exit+0x20/0x20\nret_from_fork_asm+0x11/0x20\n\u003c/TASK\u003e"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-50147\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-50147\nhttps://lore.kernel.org/linux-cve-announce/2024110744-CVE-2024-50147-d5b6@gregkh/T"
  ]
}