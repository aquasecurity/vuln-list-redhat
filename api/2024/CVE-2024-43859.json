{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-08-17T00:00:00Z",
  "bugzilla": {
    "description": "kernel: f2fs: fix to truncate preallocated blocks in f2fs_file_open()",
    "id": "2305517",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2305517"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-476",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-43859",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nf2fs: fix to truncate preallocated blocks in f2fs_file_open()\nchenyuwen reports a f2fs bug as below:\nUnable to handle kernel NULL pointer dereference at virtual address 0000000000000011\nfscrypt_set_bio_crypt_ctx+0x78/0x1e8\nf2fs_grab_read_bio+0x78/0x208\nf2fs_submit_page_read+0x44/0x154\nf2fs_get_read_data_page+0x288/0x5f4\nf2fs_get_lock_data_page+0x60/0x190\ntruncate_partial_data_page+0x108/0x4fc\nf2fs_do_truncate_blocks+0x344/0x5f0\nf2fs_truncate_blocks+0x6c/0x134\nf2fs_truncate+0xd8/0x200\nf2fs_iget+0x20c/0x5ac\ndo_garbage_collect+0x5d0/0xf6c\nf2fs_gc+0x22c/0x6a4\nf2fs_disable_checkpoint+0xc8/0x310\nf2fs_fill_super+0x14bc/0x1764\nmount_bdev+0x1b4/0x21c\nf2fs_mount+0x20/0x30\nlegacy_get_tree+0x50/0xbc\nvfs_get_tree+0x5c/0x1b0\ndo_new_mount+0x298/0x4cc\npath_mount+0x33c/0x5fc\n__arm64_sys_mount+0xcc/0x15c\ninvoke_syscall+0x60/0x150\nel0_svc_common+0xb8/0xf8\ndo_el0_svc+0x28/0xa0\nel0_svc+0x24/0x84\nel0t_64_sync_handler+0x88/0xec\nIt is because inode.i_crypt_info is not initialized during below path:\n- mount\n- f2fs_fill_super\n- f2fs_disable_checkpoint\n- f2fs_gc\n- f2fs_iget\n- f2fs_truncate\nSo, let's relocate truncation of preallocated blocks to f2fs_file_open(),\nafter fscrypt_file_open()."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-43859\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-43859\nhttps://lore.kernel.org/linux-cve-announce/2024081733-CVE-2024-43859-62b4@gregkh/T"
  ]
}