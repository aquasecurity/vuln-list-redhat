{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-07-02T00:00:00Z",
      "advisory": "RHSA-2024:4247",
      "package": "libuv-1:1.41.1-2.el8_10",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8.8 Extended Update Support",
      "release_date": "2024-10-15T00:00:00Z",
      "advisory": "RHSA-2024:8132",
      "package": "libuv-1:1.41.1-1.el8_8.1",
      "cpe": "cpe:/a:redhat:rhel_eus:8.8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-07-23T00:00:00Z",
      "advisory": "RHSA-2024:4756",
      "package": "libuv-1:1.42.0-2.el9_4",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "nodejs",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-02-07T00:00:00Z",
  "bugzilla": {
    "description": "libuv: Improper Domain Lookup that potentially leads to SSRF attacks",
    "id": "2263292",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2263292"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-918",
  "statement": "The CVE-2024-24806 vulnerability in libuv, can be classified as a moderate severity issue rather than critical due to several mitigating factors. Firstly, the exploit requires specific conditions to be met, including the use of hostnames exceeding 256 characters, limiting its applicability. Additionally, the vulnerability primarily exposes servers to SSRF attacks and unauthorized access to internal APIs, rather than facilitating direct system compromise or data exfiltration. Furthermore, the exploit's detection and exploitation require a degree of sophistication, reducing the likelihood of widespread exploitation. While the potential impact on systems leveraging libuv is notable, prudent security measures, such as network controls and vigilant monitoring, can effectively mitigate the risk, thus warranting a moderate severity classification.",
  "acknowledgement": "",
  "name": "CVE-2024-24806",
  "document_distribution": "",
  "details": [
    "libuv is a multi-platform support library with a focus on asynchronous I/O. The `uv_getaddrinfo` function in `src/unix/getaddrinfo.c` (and its windows counterpart `src/win/getaddrinfo.c`), truncates hostnames to 256 characters before calling `getaddrinfo`. This behavior can be exploited to create addresses like `0x00007f000001`, which are considered valid by `getaddrinfo` and could allow an attacker to craft payloads that resolve to unintended IP addresses, bypassing developer checks. The vulnerability arises due to how the `hostname_ascii` variable (with a length of 256 bytes) is handled in `uv_getaddrinfo` and subsequently in `uv__idna_toascii`. When the hostname exceeds 256 characters, it gets truncated without a terminating null byte. As a result attackers may be able to access internal APIs or for websites (similar to MySpace) that allows users to have `username.example.com` pages. Internal services that crawl or cache these user pages can be exposed to SSRF attacks if a malicious user chooses a long vulnerable username. This issue has been addressed in release version 1.48.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "A server-side request forgery (SSRF) flaw was found in the libuv package due to how the `hostname_ascii` variable is handled in `uv_getaddrinfo` and `uv__idna_toascii`. When the hostname exceeds 256 characters, it gets truncated without a terminating null byte. As a result, attackers may be able to access internal APIs or for websites that allow users to have `username.example.com` pages. Internal services that crawl or cache these user pages can be exposed to SSRF attacks if a malicious user chooses a long vulnerable username. This issue could allow an attacker to craft payloads that resolve to unintended IP addresses, bypassing developer checks."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-24806\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-24806\nhttps://github.com/libuv/libuv/security/advisories/GHSA-f74f-cvh7-c6q6\nhttps://www.chainguard.dev/unchained/unpacking-libuvs-cve-2024-24806-software-dark-matter-will-go-under-the-radar-not-in-chainguard-images-tho"
  ]
}