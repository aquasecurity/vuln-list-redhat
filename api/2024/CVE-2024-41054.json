{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": null,
  "threat_severity": "Moderate",
  "public_date": "2024-07-29T00:00:00Z",
  "bugzilla": {
    "description": "kernel: scsi: ufs: core: Fix ufshcd_clear_cmd racing issue",
    "id": "2300428",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2300428"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-362",
  "statement": "Red Hat Enterprise Linux is not vulnerable to this CVE, as it does not affect the versions or configurations of the Linux kernel used in its distributions.",
  "acknowledgement": "",
  "name": "CVE-2024-41054",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nscsi: ufs: core: Fix ufshcd_clear_cmd racing issue\nWhen ufshcd_clear_cmd is racing with the completion ISR, the completed tag\nof the request's mq_hctx pointer will be set to NULL by the ISR.  And\nufshcd_clear_cmd's call to ufshcd_mcq_req_to_hwq will get NULL pointer KE.\nReturn success when the request is completed by ISR because sq does not\nneed cleanup.\nThe racing flow is:\nThread A\nufshcd_err_handlerstep 1\nufshcd_try_to_abort_task\nufshcd_cmd_inflight(true)step 3\nufshcd_clear_cmd\n...\nufshcd_mcq_req_to_hwq\nblk_mq_unique_tag\nrq-\u003emq_hctx-\u003equeue_numstep 5\nThread B\nufs_mtk_mcq_intr(cq complete ISR)step 2\nscsi_done\n...\n__blk_mq_free_request\nrq-\u003emq_hctx = NULL;step 4\nBelow is KE back trace:\nufshcd_try_to_abort_task: cmd pending in the device. tag = 6\nUnable to handle kernel NULL pointer dereference at virtual address 0000000000000194\npc : [0xffffffd589679bf8] blk_mq_unique_tag+0x8/0x14\nlr : [0xffffffd5862f95b4] ufshcd_mcq_sq_cleanup+0x6c/0x1cc [ufs_mediatek_mod_ise]\nWorkqueue: ufs_eh_wq_0 ufshcd_err_handler [ufs_mediatek_mod_ise]\nCall trace:\ndump_backtrace+0xf8/0x148\nshow_stack+0x18/0x24\ndump_stack_lvl+0x60/0x7c\ndump_stack+0x18/0x3c\nmrdump_common_die+0x24c/0x398 [mrdump]\nipanic_die+0x20/0x34 [mrdump]\nnotify_die+0x80/0xd8\ndie+0x94/0x2b8\n__do_kernel_fault+0x264/0x298\ndo_page_fault+0xa4/0x4b8\ndo_translation_fault+0x38/0x54\ndo_mem_abort+0x58/0x118\nel1_abort+0x3c/0x5c\nel1h_64_sync_handler+0x54/0x90\nel1h_64_sync+0x68/0x6c\nblk_mq_unique_tag+0x8/0x14\nufshcd_clear_cmd+0x34/0x118 [ufs_mediatek_mod_ise]\nufshcd_try_to_abort_task+0x2c8/0x5b4 [ufs_mediatek_mod_ise]\nufshcd_err_handler+0xa7c/0xfa8 [ufs_mediatek_mod_ise]\nprocess_one_work+0x208/0x4fc\nworker_thread+0x228/0x438\nkthread+0x104/0x1d4\nret_from_fork+0x10/0x20"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-41054\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-41054\nhttps://lore.kernel.org/linux-cve-announce/2024072928-CVE-2024-41054-d2e1@gregkh/T"
  ]
}