{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-09-18T00:00:00Z",
      "advisory": "RHSA-2024:6744",
      "package": "kernel-0:5.14.0-284.84.1.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-09-18T00:00:00Z",
      "advisory": "RHSA-2024:6745",
      "package": "kernel-rt-0:5.14.0-284.84.1.rt14.369.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10771",
      "package": "kernel-0:5.14.0-427.47.1.el9_4",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-07-29T00:00:00Z",
  "bugzilla": {
    "description": "kernel: mm/filemap: skip to create PMD-sized page cache if needed",
    "id": "2300395",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2300395"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-99",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-41031",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nmm/filemap: skip to create PMD-sized page cache if needed\nOn ARM64, HPAGE_PMD_ORDER is 13 when the base page size is 64KB.  The\nPMD-sized page cache can't be supported by xarray as the following error\nmessages indicate.\n------------[ cut here ]------------\nWARNING: CPU: 35 PID: 7484 at lib/xarray.c:1025 xas_split_alloc+0xf8/0x128\nModules linked in: nft_fib_inet nft_fib_ipv4 nft_fib_ipv6 nft_fib  \\\nnft_reject_inet nf_reject_ipv4 nf_reject_ipv6 nft_reject nft_ct    \\\nnft_chain_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4    \\\nip_set rfkill nf_tables nfnetlink vfat fat virtio_balloon drm      \\\nfuse xfs libcrc32c crct10dif_ce ghash_ce sha2_ce sha256_arm64      \\\nsha1_ce virtio_net net_failover virtio_console virtio_blk failover \\\ndimlib virtio_mmio\nCPU: 35 PID: 7484 Comm: test Kdump: loaded Tainted: G W 6.10.0-rc5-gavin+ #9\nHardware name: QEMU KVM Virtual Machine, BIOS edk2-20240524-1.el9 05/24/2024\npstate: 83400005 (Nzcv daif +PAN -UAO +TCO +DIT -SSBS BTYPE=--)\npc : xas_split_alloc+0xf8/0x128\nlr : split_huge_page_to_list_to_order+0x1c4/0x720\nsp : ffff800087a4f6c0\nx29: ffff800087a4f6c0 x28: ffff800087a4f720 x27: 000000001fffffff\nx26: 0000000000000c40 x25: 000000000000000d x24: ffff00010625b858\nx23: ffff800087a4f720 x22: ffffffdfc0780000 x21: 0000000000000000\nx20: 0000000000000000 x19: ffffffdfc0780000 x18: 000000001ff40000\nx17: 00000000ffffffff x16: 0000018000000000 x15: 51ec004000000000\nx14: 0000e00000000000 x13: 0000000000002000 x12: 0000000000000020\nx11: 51ec000000000000 x10: 51ece1c0ffff8000 x9 : ffffbeb961a44d28\nx8 : 0000000000000003 x7 : ffffffdfc0456420 x6 : ffff0000e1aa6eb8\nx5 : 20bf08b4fe778fca x4 : ffffffdfc0456420 x3 : 0000000000000c40\nx2 : 000000000000000d x1 : 000000000000000c x0 : 0000000000000000\nCall trace:\nxas_split_alloc+0xf8/0x128\nsplit_huge_page_to_list_to_order+0x1c4/0x720\ntruncate_inode_partial_folio+0xdc/0x160\ntruncate_inode_pages_range+0x1b4/0x4a8\ntruncate_pagecache_range+0x84/0xa0\nxfs_flush_unmap_range+0x70/0x90 [xfs]\nxfs_file_fallocate+0xfc/0x4d8 [xfs]\nvfs_fallocate+0x124/0x2e8\nksys_fallocate+0x4c/0xa0\n__arm64_sys_fallocate+0x24/0x38\ninvoke_syscall.constprop.0+0x7c/0xd8\ndo_el0_svc+0xb4/0xd0\nel0_svc+0x44/0x1d8\nel0t_64_sync_handler+0x134/0x150\nel0t_64_sync+0x17c/0x180\nFix it by skipping to allocate PMD-sized page cache when its size is\nlarger than MAX_PAGECACHE_ORDER.  For this specific case, we will fall to\nregular path where the readahead window is determined by BDI's sysfs file\n(read_ahead_kb).",
    "A vulnerability was found in the Linux kernel related to how large page caching is handled, particularly for AMD64 architectures. The issue stems from the xarray data structure's inability to support PMD-sized page caches when the base page size is larger than MAX_PAGECACHE_ORDER. The particular configuration on ARM64 architectures can potentially lead to untenable resource allocation and system crashes when large pages are manipulated."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-41031\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-41031\nhttps://lore.kernel.org/linux-cve-announce/2024072921-CVE-2024-41031-6286@gregkh/T"
  ]
}