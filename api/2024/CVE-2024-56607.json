{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-12-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: wifi: ath12k: fix atomic calls in ath12k_mac_op_set_bitrate_mask()",
    "id": "2334454",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2334454"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-56607",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nwifi: ath12k: fix atomic calls in ath12k_mac_op_set_bitrate_mask()\nWhen I try to manually set bitrates:\niw wlan0 set bitrates legacy-2.4 1\nI get sleeping from invalid context error, see below. Fix that by switching to\nuse recently introduced ieee80211_iterate_stations_mtx().\nDo note that WCN6855 firmware is still crashing, I'm not sure if that firmware\neven supports bitrate WMI commands and should we consider disabling\nath12k_mac_op_set_bitrate_mask() for WCN6855? But that's for another patch.\nBUG: sleeping function called from invalid context at drivers/net/wireless/ath/ath12k/wmi.c:420\nin_atomic(): 0, irqs_disabled(): 0, non_block: 0, pid: 2236, name: iw\npreempt_count: 0, expected: 0\nRCU nest depth: 1, expected: 0\n3 locks held by iw/2236:\n#0: ffffffffabc6f1d8 (cb_lock){++++}-{3:3}, at: genl_rcv+0x14/0x40\n#1: ffff888138410810 (\u0026rdev-\u003ewiphy.mtx){+.+.}-{3:3}, at: nl80211_pre_doit+0x54d/0x800 [cfg80211]\n#2: ffffffffab2cfaa0 (rcu_read_lock){....}-{1:2}, at: ieee80211_iterate_stations_atomic+0x2f/0x200 [mac80211]\nCPU: 3 UID: 0 PID: 2236 Comm: iw Not tainted 6.11.0-rc7-wt-ath+ #1772\nHardware name: Intel(R) Client Systems NUC8i7HVK/NUC8i7HVB, BIOS HNKBLi70.86A.0067.2021.0528.1339 05/28/2021\nCall Trace:\n\u003cTASK\u003e\ndump_stack_lvl+0xa4/0xe0\ndump_stack+0x10/0x20\n__might_resched+0x363/0x5a0\n? __alloc_skb+0x165/0x340\n__might_sleep+0xad/0x160\nath12k_wmi_cmd_send+0xb1/0x3d0 [ath12k]\n? ath12k_wmi_init_wcn7850+0xa40/0xa40 [ath12k]\n? __netdev_alloc_skb+0x45/0x7b0\n? __asan_memset+0x39/0x40\n? ath12k_wmi_alloc_skb+0xf0/0x150 [ath12k]\n? reacquire_held_locks+0x4d0/0x4d0\nath12k_wmi_set_peer_param+0x340/0x5b0 [ath12k]\nath12k_mac_disable_peer_fixed_rate+0xa3/0x110 [ath12k]\n? ath12k_mac_vdev_stop+0x4f0/0x4f0 [ath12k]\nieee80211_iterate_stations_atomic+0xd4/0x200 [mac80211]\nath12k_mac_op_set_bitrate_mask+0x5d2/0x1080 [ath12k]\n? ath12k_mac_vif_chan+0x320/0x320 [ath12k]\ndrv_set_bitrate_mask+0x267/0x470 [mac80211]\nieee80211_set_bitrate_mask+0x4cc/0x8a0 [mac80211]\n? __this_cpu_preempt_check+0x13/0x20\nnl80211_set_tx_bitrate_mask+0x2bc/0x530 [cfg80211]\n? nl80211_parse_tx_bitrate_mask+0x2320/0x2320 [cfg80211]\n? trace_contention_end+0xef/0x140\n? rtnl_unlock+0x9/0x10\n? nl80211_pre_doit+0x557/0x800 [cfg80211]\ngenl_family_rcv_msg_doit+0x1f0/0x2e0\n? genl_family_rcv_msg_attrs_parse.isra.0+0x250/0x250\n? ns_capable+0x57/0xd0\ngenl_family_rcv_msg+0x34c/0x600\n? genl_family_rcv_msg_dumpit+0x310/0x310\n? __lock_acquire+0xc62/0x1de0\n? he_set_mcs_mask.isra.0+0x8d0/0x8d0 [cfg80211]\n? nl80211_parse_tx_bitrate_mask+0x2320/0x2320 [cfg80211]\n? cfg80211_external_auth_request+0x690/0x690 [cfg80211]\ngenl_rcv_msg+0xa0/0x130\nnetlink_rcv_skb+0x14c/0x400\n? genl_family_rcv_msg+0x600/0x600\n? netlink_ack+0xd70/0xd70\n? rwsem_optimistic_spin+0x4f0/0x4f0\n? genl_rcv+0x14/0x40\n? down_read_killable+0x580/0x580\n? netlink_deliver_tap+0x13e/0x350\n? __this_cpu_preempt_check+0x13/0x20\ngenl_rcv+0x23/0x40\nnetlink_unicast+0x45e/0x790\n? netlink_attachskb+0x7f0/0x7f0\nnetlink_sendmsg+0x7eb/0xdb0\n? netlink_unicast+0x790/0x790\n? __this_cpu_preempt_check+0x13/0x20\n? selinux_socket_sendmsg+0x31/0x40\n? netlink_unicast+0x790/0x790\n__sock_sendmsg+0xc9/0x160\n____sys_sendmsg+0x620/0x990\n? kernel_sendmsg+0x30/0x30\n? __copy_msghdr+0x410/0x410\n? __kasan_check_read+0x11/0x20\n? mark_lock+0xe6/0x1470\n___sys_sendmsg+0xe9/0x170\n? copy_msghdr_from_user+0x120/0x120\n? __lock_acquire+0xc62/0x1de0\n? do_fault_around+0x2c6/0x4e0\n? do_user_addr_fault+0x8c1/0xde0\n? reacquire_held_locks+0x220/0x4d0\n? do_user_addr_fault+0x8c1/0xde0\n? __kasan_check_read+0x11/0x20\n? __fdget+0x4e/0x1d0\n? sockfd_lookup_light+0x1a/0x170\n__sys_sendmsg+0xd2/0x180\n? __sys_sendmsg_sock+0x20/0x20\n? reacquire_held_locks+0x4d0/0x4d0\n? debug_smp_processor_id+0x17/0x20\n__x64_sys_sendmsg+0x72/0xb0\n? lockdep_hardirqs_on+0x7d/0x100\nx64_sys_call+0x894/0x9f0\ndo_syscall_64+0x64/0x130\nentry_SYSCALL_64_after_\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-56607\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-56607\nhttps://lore.kernel.org/linux-cve-announce/2024122705-CVE-2024-56607-031e@gregkh/T"
  ]
}