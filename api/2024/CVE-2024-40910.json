{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-07-12T00:00:00Z",
  "bugzilla": {
    "description": "kernel: ax25: Fix refcount imbalance on inbound connections",
    "id": "2297494",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2297494"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-911",
  "statement": "Red Hat Enterprise Linux is not vulnerable to this CVE, as it does not affect the versions or configurations of the Linux kernel used in its distributions.",
  "acknowledgement": "",
  "name": "CVE-2024-40910",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nax25: Fix refcount imbalance on inbound connections\nWhen releasing a socket in ax25_release(), we call netdev_put() to\ndecrease the refcount on the associated ax.25 device. However, the\nexecution path for accepting an incoming connection never calls\nnetdev_hold(). This imbalance leads to refcount errors, and ultimately\nto kernel crashes.\nA typical call trace for the above situation will start with one of the\nfollowing errors:\nrefcount_t: decrement hit 0; leaking memory.\nrefcount_t: underflow; use-after-free.\nAnd will then have a trace like:\nCall Trace:\n\u003cTASK\u003e\n? show_regs+0x64/0x70\n? __warn+0x83/0x120\n? refcount_warn_saturate+0xb2/0x100\n? report_bug+0x158/0x190\n? prb_read_valid+0x20/0x30\n? handle_bug+0x3e/0x70\n? exc_invalid_op+0x1c/0x70\n? asm_exc_invalid_op+0x1f/0x30\n? refcount_warn_saturate+0xb2/0x100\n? refcount_warn_saturate+0xb2/0x100\nax25_release+0x2ad/0x360\n__sock_release+0x35/0xa0\nsock_close+0x19/0x20\n[...]\nOn reboot (or any attempt to remove the interface), the kernel gets\nstuck in an infinite loop:\nunregister_netdevice: waiting for ax0 to become free. Usage count = 0\nThis patch corrects these issues by ensuring that we call netdev_hold()\nand ax25_dev_hold() for new connections in ax25_accept(). This makes the\nlogic leading to ax25_accept() match the logic for ax25_bind(): in both\ncases we increment the refcount, which is ultimately decremented in\nax25_release().",
    "A vulnerability was found in the Linux kernel, related to the ax25 protocol. This issue can cause a reference count imbalance during the handling of inbound connections. The ax25_release() function incorrectly decrements the reference count of the associated ax.25 device using netdev_put() without a corresponding netdev_hold() in the connection acceptance path. This imbalance can lead to kernel crashes and memory errors, indicated by messages such as refcount_t: decrement hit 0; leaking memory and refcount_t: underflow; use-after-free."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-40910\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-40910\nhttps://lore.kernel.org/linux-cve-announce/2024071210-CVE-2024-40910-d7d9@gregkh/T"
  ]
}