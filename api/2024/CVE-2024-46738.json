{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-09-18T00:00:00Z",
  "bugzilla": {
    "description": "kernel: VMCI: Fix use-after-free when removing resource in vmci_resource_remove()",
    "id": "2313086",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2313086"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-46738",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nVMCI: Fix use-after-free when removing resource in vmci_resource_remove()\nWhen removing a resource from vmci_resource_table in\nvmci_resource_remove(), the search is performed using the resource\nhandle by comparing context and resource fields.\nIt is possible though to create two resources with different types\nbut same handle (same context and resource fields).\nWhen trying to remove one of the resources, vmci_resource_remove()\nmay not remove the intended one, but the object will still be freed\nas in the case of the datagram type in vmci_datagram_destroy_handle().\nvmci_resource_table will still hold a pointer to this freed resource\nleading to a use-after-free vulnerability.\nBUG: KASAN: use-after-free in vmci_handle_is_equal include/linux/vmw_vmci_defs.h:142 [inline]\nBUG: KASAN: use-after-free in vmci_resource_remove+0x3a1/0x410 drivers/misc/vmw_vmci/vmci_resource.c:147\nRead of size 4 at addr ffff88801c16d800 by task syz-executor197/1592\nCall Trace:\n\u003cTASK\u003e\n__dump_stack lib/dump_stack.c:88 [inline]\ndump_stack_lvl+0x82/0xa9 lib/dump_stack.c:106\nprint_address_description.constprop.0+0x21/0x366 mm/kasan/report.c:239\n__kasan_report.cold+0x7f/0x132 mm/kasan/report.c:425\nkasan_report+0x38/0x51 mm/kasan/report.c:442\nvmci_handle_is_equal include/linux/vmw_vmci_defs.h:142 [inline]\nvmci_resource_remove+0x3a1/0x410 drivers/misc/vmw_vmci/vmci_resource.c:147\nvmci_qp_broker_detach+0x89a/0x11b9 drivers/misc/vmw_vmci/vmci_queue_pair.c:2182\nctx_free_ctx+0x473/0xbe1 drivers/misc/vmw_vmci/vmci_context.c:444\nkref_put include/linux/kref.h:65 [inline]\nvmci_ctx_put drivers/misc/vmw_vmci/vmci_context.c:497 [inline]\nvmci_ctx_destroy+0x170/0x1d6 drivers/misc/vmw_vmci/vmci_context.c:195\nvmci_host_close+0x125/0x1ac drivers/misc/vmw_vmci/vmci_host.c:143\n__fput+0x261/0xa34 fs/file_table.c:282\ntask_work_run+0xf0/0x194 kernel/task_work.c:164\ntracehook_notify_resume include/linux/tracehook.h:189 [inline]\nexit_to_user_mode_loop+0x184/0x189 kernel/entry/common.c:187\nexit_to_user_mode_prepare+0x11b/0x123 kernel/entry/common.c:220\n__syscall_exit_to_user_mode_work kernel/entry/common.c:302 [inline]\nsyscall_exit_to_user_mode+0x18/0x42 kernel/entry/common.c:313\ndo_syscall_64+0x41/0x85 arch/x86/entry/common.c:86\nentry_SYSCALL_64_after_hwframe+0x6e/0x0\nThis change ensures the type is also checked when removing\nthe resource from vmci_resource_table in vmci_resource_remove().",
    "A use-after-free vulnerability was found in the Linux kernel. When removing a resource from vmci_resource_table in vmci_resource_remove(), the search is performed using the resource handle by comparing context and resource fields. However, it is possible to create two resources with different types but the same handle, for example, the same context and resource fields. When trying to remove one of the resources, vmci_resource_remove() may not remove the intended one, but the object will still be freed as in the case of the datagram type in vmci_datagram_destroy_handle().vmci_resource_table will still hold a pointer to this freed resource, leading to a use-after-free issue."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-46738\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-46738\nhttps://lore.kernel.org/linux-cve-announce/2024091833-CVE-2024-46738-d871@gregkh/T"
  ]
}