{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-1/argocd-rhel8",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-1/gitops-rhel8",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    },
    {
      "product_name": "Red Hat OpenShift GitOps",
      "fix_state": "Affected",
      "package_name": "openshift-gitops-argocd-rhel9-container",
      "cpe": "cpe:/a:redhat:openshift_gitops:1"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-07-24T00:00:00Z",
  "bugzilla": {
    "description": "argocd: The Argo CD web terminal session does not handle the revocation of user permissions properly.",
    "id": "2299725",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2299725"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.7",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-269",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-41666",
  "document_distribution": "",
  "details": [
    "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Argo CD has a Web-based terminal that allows users to get a shell inside a running pod, just as they would with kubectl exec. Starting in version 2.6.0, when the administrator enables this function and grants permission to the user `p, role:myrole, exec, create, */*, allow`, even if the user revokes this permission, the user can still perform operations in the container, as long as the user keeps the terminal view open for a long time. Although the token expiration and revocation of the user are fixed, however, the fix does not address the situation of revocation of only user `p, role:myrole, exec, create, */*, allow` permissions, which may still lead to the leakage of sensitive information. A patch for this vulnerability has been released in Argo CD versions 2.11.7, 2.10.16, and 2.9.21.",
    "A vulnerability was found in ArgoCD's web-based terminal. This issue may allow a user to continue sending WebSocket messages and access sensitive information even after their p, role:myrole, exec, create, */*, and allow permissions are revoked. The terminal session remains active as long as it is kept open, enabling unauthorized operations within the container, allowing an attacker to maintain the terminal session to gain access and view sensitive data despite revoked permissions."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-41666\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-41666\nhttps://drive.google.com/file/d/1Fynj5Sho8Lf8CETqsNXZyPKlTDdmgJuN/view?usp=sharing\nhttps://github.com/argoproj/argo-cd/commit/05edb2a9ca48f0f10608c1b49fbb0cf7164f6476\nhttps://github.com/argoproj/argo-cd/commit/e96f32d233504101ddac028a5bf8117433d333d6\nhttps://github.com/argoproj/argo-cd/commit/ef535230d8bd8ad7b18aab1ea1063e9751d348c4\nhttps://github.com/argoproj/argo-cd/security/advisories/GHSA-v8wx-v5jq-qhhw"
  ]
}