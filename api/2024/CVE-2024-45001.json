{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Will not fix",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-09-04T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net: mana: Fix RX buf alloc_size alignment and atomic op panic",
    "id": "2309864",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2309864"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-45001",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet: mana: Fix RX buf alloc_size alignment and atomic op panic\nThe MANA driver's RX buffer alloc_size is passed into napi_build_skb() to\ncreate SKB. skb_shinfo(skb) is located at the end of skb, and its alignment\nis affected by the alloc_size passed into napi_build_skb(). The size needs\nto be aligned properly for better performance and atomic operations.\nOtherwise, on ARM64 CPU, for certain MTU settings like 4000, atomic\noperations may panic on the skb_shinfo(skb)-\u003edataref due to alignment fault.\nTo fix this bug, add proper alignment to the alloc_size calculation.\nSample panic info:\n[  253.298819] Unable to handle kernel paging request at virtual address ffff000129ba5cce\n[  253.300900] Mem abort info:\n[  253.301760]   ESR = 0x0000000096000021\n[  253.302825]   EC = 0x25: DABT (current EL), IL = 32 bits\n[  253.304268]   SET = 0, FnV = 0\n[  253.305172]   EA = 0, S1PTW = 0\n[  253.306103]   FSC = 0x21: alignment fault\nCall trace:\n__skb_clone+0xfc/0x198\nskb_clone+0x78/0xe0\nraw6_local_deliver+0xfc/0x228\nip6_protocol_deliver_rcu+0x80/0x500\nip6_input_finish+0x48/0x80\nip6_input+0x48/0xc0\nip6_sublist_rcv_finish+0x50/0x78\nip6_sublist_rcv+0x1cc/0x2b8\nipv6_list_rcv+0x100/0x150\n__netif_receive_skb_list_core+0x180/0x220\nnetif_receive_skb_list_internal+0x198/0x2a8\n__napi_poll+0x138/0x250\nnet_rx_action+0x148/0x330\nhandle_softirqs+0x12c/0x3a0",
    "A flaw was found in the MANA driver in the Linux Kernel, where the RX buffer alloc_size is passed into napi_build_skb() to create SKB. skb_shinfo(skb) is located at the end of skb, and its alignment is affected by the alloc_size passed into napi_build_skb(). The size needs to be aligned properly for better performance and atomic operations, otherwise, on ARM64 CPU for certain MTU settings such as 4000, atomic operations may panic on the skb_shinfo(skb)-\u003edataref due to alignment fault. To mitigate, add proper alignment to the alloc_size calculation."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-45001\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-45001\nhttps://lore.kernel.org/linux-cve-announce/2024090450-CVE-2024-45001-50df@gregkh/T"
  ]
}