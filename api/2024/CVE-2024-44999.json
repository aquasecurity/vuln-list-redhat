{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-09-04T00:00:00Z",
  "bugzilla": {
    "description": "kernel: gtp: pull network headers in gtp_dev_xmit()",
    "id": "2309862",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2309862"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-20",
  "statement": "This issue is classified as Moderate severity rather than Important due to the specific nature of the uninitialized value problem. The vulnerability involves the potential use of uninitialized memory in network header fields, which, while potentially exposing sensitive data or causing erratic behavior, generally requires a specific set of conditions to be exploited. The `pskb_inet_may_pull()` function addresses this by ensuring that necessary headers are correctly initialized before use.",
  "acknowledgement": "",
  "name": "CVE-2024-44999",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\ngtp: pull network headers in gtp_dev_xmit()\nsyzbot/KMSAN reported use of uninit-value in get_dev_xmit() [1]\nWe must make sure the IPv4 or Ipv6 header is pulled in skb-\u003ehead\nbefore accessing fields in them.\nUse pskb_inet_may_pull() to fix this issue.\n[1]\nBUG: KMSAN: uninit-value in ipv6_pdp_find drivers/net/gtp.c:220 [inline]\nBUG: KMSAN: uninit-value in gtp_build_skb_ip6 drivers/net/gtp.c:1229 [inline]\nBUG: KMSAN: uninit-value in gtp_dev_xmit+0x1424/0x2540 drivers/net/gtp.c:1281\nipv6_pdp_find drivers/net/gtp.c:220 [inline]\ngtp_build_skb_ip6 drivers/net/gtp.c:1229 [inline]\ngtp_dev_xmit+0x1424/0x2540 drivers/net/gtp.c:1281\n__netdev_start_xmit include/linux/netdevice.h:4913 [inline]\nnetdev_start_xmit include/linux/netdevice.h:4922 [inline]\nxmit_one net/core/dev.c:3580 [inline]\ndev_hard_start_xmit+0x247/0xa20 net/core/dev.c:3596\n__dev_queue_xmit+0x358c/0x5610 net/core/dev.c:4423\ndev_queue_xmit include/linux/netdevice.h:3105 [inline]\npacket_xmit+0x9c/0x6c0 net/packet/af_packet.c:276\npacket_snd net/packet/af_packet.c:3145 [inline]\npacket_sendmsg+0x90e3/0xa3a0 net/packet/af_packet.c:3177\nsock_sendmsg_nosec net/socket.c:730 [inline]\n__sock_sendmsg+0x30f/0x380 net/socket.c:745\n__sys_sendto+0x685/0x830 net/socket.c:2204\n__do_sys_sendto net/socket.c:2216 [inline]\n__se_sys_sendto net/socket.c:2212 [inline]\n__x64_sys_sendto+0x125/0x1d0 net/socket.c:2212\nx64_sys_call+0x3799/0x3c10 arch/x86/include/generated/asm/syscalls_64.h:45\ndo_syscall_x64 arch/x86/entry/common.c:52 [inline]\ndo_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c:83\nentry_SYSCALL_64_after_hwframe+0x77/0x7f\nUninit was created at:\nslab_post_alloc_hook mm/slub.c:3994 [inline]\nslab_alloc_node mm/slub.c:4037 [inline]\nkmem_cache_alloc_node_noprof+0x6bf/0xb80 mm/slub.c:4080\nkmalloc_reserve+0x13d/0x4a0 net/core/skbuff.c:583\n__alloc_skb+0x363/0x7b0 net/core/skbuff.c:674\nalloc_skb include/linux/skbuff.h:1320 [inline]\nalloc_skb_with_frags+0xc8/0xbf0 net/core/skbuff.c:6526\nsock_alloc_send_pskb+0xa81/0xbf0 net/core/sock.c:2815\npacket_alloc_skb net/packet/af_packet.c:2994 [inline]\npacket_snd net/packet/af_packet.c:3088 [inline]\npacket_sendmsg+0x749c/0xa3a0 net/packet/af_packet.c:3177\nsock_sendmsg_nosec net/socket.c:730 [inline]\n__sock_sendmsg+0x30f/0x380 net/socket.c:745\n__sys_sendto+0x685/0x830 net/socket.c:2204\n__do_sys_sendto net/socket.c:2216 [inline]\n__se_sys_sendto net/socket.c:2212 [inline]\n__x64_sys_sendto+0x125/0x1d0 net/socket.c:2212\nx64_sys_call+0x3799/0x3c10 arch/x86/include/generated/asm/syscalls_64.h:45\ndo_syscall_x64 arch/x86/entry/common.c:52 [inline]\ndo_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c:83\nentry_SYSCALL_64_after_hwframe+0x77/0x7f\nCPU: 0 UID: 0 PID: 7115 Comm: syz.1.515 Not tainted 6.11.0-rc1-syzkaller-00043-g94ede2a3e913 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 06/27/2024",
    "A use-after-free vulnerability was found in the Linux kernel's GPRS Tunneling Protocol ( GTP ) driver, specifically in the gtp_dev_xmit() function. This issue is due to the IPv4 or IPv6 headers not being properly pulled into the skb-\u003ehead before being accessed. This led to the use of uninitialized values, as reported by Kernel Memory Sanitizer (KMSAN)."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-44999\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-44999\nhttps://lore.kernel.org/linux-cve-announce/2024090449-CVE-2024-44999-187d@gregkh/T"
  ]
}