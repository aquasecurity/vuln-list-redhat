{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-08-26T00:00:00Z",
  "bugzilla": {
    "description": "kernel: media: xc2028: avoid use-after-free in load_firmware_cb()",
    "id": "2307873",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2307873"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-43900",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nmedia: xc2028: avoid use-after-free in load_firmware_cb()\nsyzkaller reported use-after-free in load_firmware_cb() [1].\nThe reason is because the module allocated a struct tuner in tuner_probe(),\nand then the module initialization failed, the struct tuner was released.\nA worker which created during module initialization accesses this struct\ntuner later, it caused use-after-free.\nThe process is as follows:\ntask-6504           worker_thread\ntuner_probe                             \u003c= alloc dvb_frontend [2]\n...\nrequest_firmware_nowait                 \u003c= create a worker\n...\ntuner_remove                            \u003c= free dvb_frontend\n...\nrequest_firmware_work_func  \u003c= the firmware is ready\nload_firmware_cb    \u003c= but now the dvb_frontend has been freed\nTo fix the issue, check the dvd_frontend in load_firmware_cb(), if it is\nnull, report a warning and just return.\n[1]:\n==================================================================\nBUG: KASAN: use-after-free in load_firmware_cb+0x1310/0x17a0\nRead of size 8 at addr ffff8000d7ca2308 by task kworker/2:3/6504\nCall trace:\nload_firmware_cb+0x1310/0x17a0\nrequest_firmware_work_func+0x128/0x220\nprocess_one_work+0x770/0x1824\nworker_thread+0x488/0xea0\nkthread+0x300/0x430\nret_from_fork+0x10/0x20\nAllocated by task 6504:\nkzalloc\ntuner_probe+0xb0/0x1430\ni2c_device_probe+0x92c/0xaf0\nreally_probe+0x678/0xcd0\ndriver_probe_device+0x280/0x370\n__device_attach_driver+0x220/0x330\nbus_for_each_drv+0x134/0x1c0\n__device_attach+0x1f4/0x410\ndevice_initial_probe+0x20/0x30\nbus_probe_device+0x184/0x200\ndevice_add+0x924/0x12c0\ndevice_register+0x24/0x30\ni2c_new_device+0x4e0/0xc44\nv4l2_i2c_new_subdev_board+0xbc/0x290\nv4l2_i2c_new_subdev+0xc8/0x104\nem28xx_v4l2_init+0x1dd0/0x3770\nFreed by task 6504:\nkfree+0x238/0x4e4\ntuner_remove+0x144/0x1c0\ni2c_device_remove+0xc8/0x290\n__device_release_driver+0x314/0x5fc\ndevice_release_driver+0x30/0x44\nbus_remove_device+0x244/0x490\ndevice_del+0x350/0x900\ndevice_unregister+0x28/0xd0\ni2c_unregister_device+0x174/0x1d0\nv4l2_device_unregister+0x224/0x380\nem28xx_v4l2_init+0x1d90/0x3770\nThe buggy address belongs to the object at ffff8000d7ca2000\nwhich belongs to the cache kmalloc-2k of size 2048\nThe buggy address is located 776 bytes inside of\n2048-byte region [ffff8000d7ca2000, ffff8000d7ca2800)\nThe buggy address belongs to the page:\npage:ffff7fe00035f280 count:1 mapcount:0 mapping:ffff8000c001f000 index:0x0\nflags: 0x7ff800000000100(slab)\nraw: 07ff800000000100 ffff7fe00049d880 0000000300000003 ffff8000c001f000\nraw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000\npage dumped because: kasan: bad access detected\nMemory state around the buggy address:\nffff8000d7ca2200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\nffff8000d7ca2280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n\u003effff8000d7ca2300: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n^\nffff8000d7ca2380: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\nffff8000d7ca2400: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\n==================================================================\n[2]\nActually, it is allocated for struct tuner, and dvb_frontend is inside."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-43900\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-43900\nhttps://lore.kernel.org/linux-cve-announce/2024082616-CVE-2024-43900-029c@gregkh/T"
  ]
}