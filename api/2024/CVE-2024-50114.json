{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-11-05T00:00:00Z",
  "bugzilla": {
    "description": "kernel: KVM: arm64: Unregister redistributor for failed vCPU creation",
    "id": "2323916",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2323916"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-416",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-50114",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nKVM: arm64: Unregister redistributor for failed vCPU creation\nAlex reports that syzkaller has managed to trigger a use-after-free when\ntearing down a VM:\nBUG: KASAN: slab-use-after-free in kvm_put_kvm+0x300/0xe68 virt/kvm/kvm_main.c:5769\nRead of size 8 at addr ffffff801c6890d0 by task syz.3.2219/10758\nCPU: 3 UID: 0 PID: 10758 Comm: syz.3.2219 Not tainted 6.11.0-rc6-dirty #64\nHardware name: linux,dummy-virt (DT)\nCall trace:\ndump_backtrace+0x17c/0x1a8 arch/arm64/kernel/stacktrace.c:317\nshow_stack+0x2c/0x3c arch/arm64/kernel/stacktrace.c:324\n__dump_stack lib/dump_stack.c:93 [inline]\ndump_stack_lvl+0x94/0xc0 lib/dump_stack.c:119\nprint_report+0x144/0x7a4 mm/kasan/report.c:377\nkasan_report+0xcc/0x128 mm/kasan/report.c:601\n__asan_report_load8_noabort+0x20/0x2c mm/kasan/report_generic.c:381\nkvm_put_kvm+0x300/0xe68 virt/kvm/kvm_main.c:5769\nkvm_vm_release+0x4c/0x60 virt/kvm/kvm_main.c:1409\n__fput+0x198/0x71c fs/file_table.c:422\n____fput+0x20/0x30 fs/file_table.c:450\ntask_work_run+0x1cc/0x23c kernel/task_work.c:228\ndo_notify_resume+0x144/0x1a0 include/linux/resume_user_mode.h:50\nel0_svc+0x64/0x68 arch/arm64/kernel/entry-common.c:169\nel0t_64_sync_handler+0x90/0xfc arch/arm64/kernel/entry-common.c:730\nel0t_64_sync+0x190/0x194 arch/arm64/kernel/entry.S:598\nUpon closer inspection, it appears that we do not properly tear down the\nMMIO registration for a vCPU that fails creation late in the game, e.g.\na vCPU w/ the same ID already exists in the VM.\nIt is important to consider the context of commit that introduced this bug\nby moving the unregistration out of __kvm_vgic_vcpu_destroy(). That\nchange correctly sought to avoid an srcu v. config_lock inversion by\nbreaking up the vCPU teardown into two parts, one guarded by the\nconfig_lock.\nFix the use-after-free while avoiding lock inversion by adding a\nspecial-cased unregistration to __kvm_vgic_vcpu_destroy(). This is safe\nbecause failed vCPUs are torn down outside of the config_lock."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-50114\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-50114\nhttps://lore.kernel.org/linux-cve-announce/2024110555-CVE-2024-50114-80e0@gregkh/T"
  ]
}