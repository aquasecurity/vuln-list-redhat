{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-11-25T00:00:00Z",
  "bugzilla": {
    "description": "kernel: mm: resolve faulty mmap_region() error path behaviour",
    "id": "2328791",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2328791"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-99",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-53096",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nmm: resolve faulty mmap_region() error path behaviour\nThe mmap_region() function is somewhat terrifying, with spaghetti-like\ncontrol flow and numerous means by which issues can arise and incomplete\nstate, memory leaks and other unpleasantness can occur.\nA large amount of the complexity arises from trying to handle errors late\nin the process of mapping a VMA, which forms the basis of recently\nobserved issues with resource leaks and observable inconsistent state.\nTaking advantage of previous patches in this series we move a number of\nchecks earlier in the code, simplifying things by moving the core of the\nlogic into a static internal function __mmap_region().\nDoing this allows us to perform a number of checks up front before we do\nany real work, and allows us to unwind the writable unmap check\nunconditionally as required and to perform a CONFIG_DEBUG_VM_MAPLE_TREE\nvalidation unconditionally also.\nWe move a number of things here:\n1. We preallocate memory for the iterator before we call the file-backed\nmemory hook, allowing us to exit early and avoid having to perform\ncomplicated and error-prone close/free logic. We carefully free\niterator state on both success and error paths.\n2. The enclosing mmap_region() function handles the mapping_map_writable()\nlogic early. Previously the logic had the mapping_map_writable() at the\npoint of mapping a newly allocated file-backed VMA, and a matching\nmapping_unmap_writable() on success and error paths.\nWe now do this unconditionally if this is a file-backed, shared writable\nmapping. If a driver changes the flags to eliminate VM_MAYWRITE, however\ndoing so does not invalidate the seal check we just performed, and we in\nany case always decrement the counter in the wrapper.\nWe perform a debug assert to ensure a driver does not attempt to do the\nopposite.\n3. We also move arch_validate_flags() up into the mmap_region()\nfunction. This is only relevant on arm64 and sparc64, and the check is\nonly meaningful for SPARC with ADI enabled. We explicitly add a warning\nfor this arch if a driver invalidates this check, though the code ought\neventually to be fixed to eliminate the need for this.\nWith all of these measures in place, we no longer need to explicitly close\nthe VMA on error paths, as we place all checks which might fail prior to a\ncall to any driver mmap hook.\nThis eliminates an entire class of errors, makes the code easier to reason\nabout and more robust."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-53096\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-53096\nhttps://lore.kernel.org/linux-cve-announce/2024112506-CVE-2024-53096-5bcc@gregkh/T"
  ]
}