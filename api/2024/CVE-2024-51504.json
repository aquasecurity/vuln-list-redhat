{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "A-MQ Clients 2",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:a_mq_clients:2"
    },
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "Red Hat AMQ Broker 7",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat build of Apache Camel for Spring Boot 3",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3"
    },
    {
      "product_name": "Red Hat build of Apache Camel for Spring Boot 4",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:camel_spring_boot:4"
    },
    {
      "product_name": "Red Hat build of Debezium",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:debezium:2"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Fuse 7",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 8",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:8"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "streams for Apache Kafka",
      "fix_state": "Not affected",
      "package_name": "org.apache.zookeeper/zookeeper",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-11-07T09:52:03Z",
  "bugzilla": {
    "description": "org.apache.zookeeper: Apache ZooKeeper: Authentication bypass with IP-based authentication in Admin Server",
    "id": "2324330",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2324330"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-290",
  "statement": "This vulnerability is considered an Important severity because it allows an attacker to bypass authentication by spoofing the client’s IP address, exploiting a weakness in ZooKeeper Admin Server's reliance on the `X-Forwarded-For` HTTP header for IP-based authentication. Unlike moderate vulnerabilities that might require additional conditions for exploitation, this flaw directly exposes critical admin commands—such as snapshot and restore—without requiring complex attack vectors. Successful exploitation can lead to unauthorized execution of sensitive commands, resulting in potential information leakage, data integrity risks, and service availability issues.",
  "acknowledgement": "",
  "name": "CVE-2024-51504",
  "document_distribution": "",
  "details": [
    "When using IPAuthenticationProvider in ZooKeeper Admin Server there is a possibility of Authentication Bypass by Spoofing -- this only impacts IP based authentication implemented in ZooKeeper Admin Server. Default configuration of client's IP address detection in IPAuthenticationProvider, which uses HTTP request headers, is weak and allows an attacker to bypass authentication via spoofing client's IP address in request headers. Default configuration honors X-Forwarded-For HTTP header to read client's IP address. X-Forwarded-For request header is mainly used by proxy servers to identify the client and can be easily spoofed by an attacker pretending that the request comes from a different IP address. Admin Server commands, such as snapshot and restore arbitrarily can be executed on successful exploitation which could potentially lead to information leakage or service availability issues. Users are recommended to upgrade to version 3.9.3, which fixes this issue.",
    "An authentication bypass vulnerability was found in Apache Zookeeper. The default configuration of the client's IP address detection in IPAuthenticationProvider, which uses HTTP request headers, is weak and allows an attacker to bypass authentication by spoofing the client's IP address in request headers. The default configuration honors the X-Forwarded-For HTTP header to read the client's IP address, which can be easily spoofed by an attacker pretending that the request came from a different IP address. Admin Server commands, such as snapshot and restore arbitrarily, can be executed on successful exploitation, potentially leading to information leakage or service availability issues."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-51504\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-51504\nhttps://lists.apache.org/thread/b3qrmpkto5r6989qr61fw9y2x646kqlh"
  ]
}