{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-12-04T00:00:00Z",
  "bugzilla": {
    "description": "kernel: sctp: fix possible UAF in sctp_v6_available()",
    "id": "2330347",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2330347"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-53139",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nsctp: fix possible UAF in sctp_v6_available()\nA lockdep report [1] with CONFIG_PROVE_RCU_LIST=y hints\nthat sctp_v6_available() is calling dev_get_by_index_rcu()\nand ipv6_chk_addr() without holding rcu.\n[1]\n=============================\nWARNING: suspicious RCU usage\n6.12.0-rc5-virtme #1216 Tainted: G        W\n-----------------------------\nnet/core/dev.c:876 RCU-list traversed in non-reader section!!\nother info that might help us debug this:\nrcu_scheduler_active = 2, debug_locks = 1\n1 lock held by sctp_hello/31495:\n#0: ffff9f1ebbdb7418 (sk_lock-AF_INET6){+.+.}-{0:0}, at: sctp_bind (./arch/x86/include/asm/jump_label.h:27 net/sctp/socket.c:315) sctp\nstack backtrace:\nCPU: 7 UID: 0 PID: 31495 Comm: sctp_hello Tainted: G        W          6.12.0-rc5-virtme #1216\nTainted: [W]=WARN\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\nCall Trace:\n\u003cTASK\u003e\ndump_stack_lvl (lib/dump_stack.c:123)\nlockdep_rcu_suspicious (kernel/locking/lockdep.c:6822)\ndev_get_by_index_rcu (net/core/dev.c:876 (discriminator 7))\nsctp_v6_available (net/sctp/ipv6.c:701) sctp\nsctp_do_bind (net/sctp/socket.c:400 (discriminator 1)) sctp\nsctp_bind (net/sctp/socket.c:320) sctp\ninet6_bind_sk (net/ipv6/af_inet6.c:465)\n? security_socket_bind (security/security.c:4581 (discriminator 1))\n__sys_bind (net/socket.c:1848 net/socket.c:1869)\n? do_user_addr_fault (./include/linux/rcupdate.h:347 ./include/linux/rcupdate.h:880 ./include/linux/mm.h:729 arch/x86/mm/fault.c:1340)\n? do_user_addr_fault (./arch/x86/include/asm/preempt.h:84 (discriminator 13) ./include/linux/rcupdate.h:98 (discriminator 13) ./include/linux/rcupdate.h:882 (discriminator 13) ./include/linux/mm.h:729 (discriminator 13) arch/x86/mm/fault.c:1340 (discriminator 13))\n__x64_sys_bind (net/socket.c:1877 (discriminator 1) net/socket.c:1875 (discriminator 1) net/socket.c:1875 (discriminator 1))\ndo_syscall_64 (arch/x86/entry/common.c:52 (discriminator 1) arch/x86/entry/common.c:83 (discriminator 1))\nentry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\nRIP: 0033:0x7f59b934a1e7\nCode: 44 00 00 48 8b 15 39 8c 0c 00 f7 d8 64 89 02 b8 ff ff ff ff eb bd 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 b8 31 00 00 00 0f 05 \u003c48\u003e 3d 01 f0 ff ff 73 01 c3 48 8b 0d 09 8c 0c 00 f7 d8 64 89 01 48\nAll code\n========\n0:44 00 00             add    %r8b,(%rax)\n3:48 8b 15 39 8c 0c 00 mov    0xc8c39(%rip),%rdx        # 0xc8c43\na:f7 d8                neg    %eax\nc:64 89 02             mov    %eax,%fs:(%rdx)\nf:b8 ff ff ff ff       mov    $0xffffffff,%eax\n14:eb bd                jmp    0xffffffffffffffd3\n16:66 2e 0f 1f 84 00 00 cs nopw 0x0(%rax,%rax,1)\n1d:00 00 00\n20:0f 1f 00             nopl   (%rax)\n23:b8 31 00 00 00       mov    $0x31,%eax\n28:0f 05                syscall\n2a:*48 3d 01 f0 ff ff    cmp    $0xfffffffffffff001,%rax\u003c-- trapping instruction\n30:73 01                jae    0x33\n32:c3                   ret\n33:48 8b 0d 09 8c 0c 00 mov    0xc8c09(%rip),%rcx        # 0xc8c43\n3a:f7 d8                neg    %eax\n3c:64 89 01             mov    %eax,%fs:(%rcx)\n3f:48                   rex.W\nCode starting with the faulting instruction\n===========================================\n0:48 3d 01 f0 ff ff    cmp    $0xfffffffffffff001,%rax\n6:73 01                jae    0x9\n8:c3                   ret\n9:48 8b 0d 09 8c 0c 00 mov    0xc8c09(%rip),%rcx        # 0xc8c19\n10:f7 d8                neg    %eax\n12:64 89 01             mov    %eax,%fs:(%rcx)\n15:48                   rex.W\nRSP: 002b:00007ffe2d0ad398 EFLAGS: 00000202 ORIG_RAX: 0000000000000031\nRAX: ffffffffffffffda RBX: 00007ffe2d0ad3d0 RCX: 00007f59b934a1e7\nRDX: 000000000000001c RSI: 00007ffe2d0ad3d0 RDI: 0000000000000005\nRBP: 0000000000000005 R08: 1999999999999999 R09: 0000000000000000\nR10: 00007f59b9253298 R11: 000000000000\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-53139\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-53139\nhttps://lore.kernel.org/linux-cve-announce/2024120453-CVE-2024-53139-4311@gregkh/T"
  ]
}