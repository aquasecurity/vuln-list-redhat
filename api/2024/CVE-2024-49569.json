{
  "mitigation": "To mitigate this issue, prevent module nvme-rdma from being loaded. Please see https://access.redhat.com/solutions/41278 for how to blacklist a kernel module to prevent it from loading automatically.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-01-11T00:00:00Z",
  "bugzilla": {
    "description": "kernel: nvme-rdma: unquiesce admin_q before destroy it",
    "id": "2337136",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2337136"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.7",
    "cvss3_scoring_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-460",
  "statement": "The bug could happen only if NVME over RDMA Transport being used. It happens during disconnection and leads to hang of NVME only (that is deny of service). The security impact is limited.",
  "acknowledgement": "",
  "name": "CVE-2024-49569",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnvme-rdma: unquiesce admin_q before destroy it\nKernel will hang on destroy admin_q while we create ctrl failed, such\nas following calltrace:\nPID: 23644    TASK: ff2d52b40f439fc0  CPU: 2    COMMAND: \"nvme\"\n#0 [ff61d23de260fb78] __schedule at ffffffff8323bc15\n#1 [ff61d23de260fc08] schedule at ffffffff8323c014\n#2 [ff61d23de260fc28] blk_mq_freeze_queue_wait at ffffffff82a3dba1\n#3 [ff61d23de260fc78] blk_freeze_queue at ffffffff82a4113a\n#4 [ff61d23de260fc90] blk_cleanup_queue at ffffffff82a33006\n#5 [ff61d23de260fcb0] nvme_rdma_destroy_admin_queue at ffffffffc12686ce\n#6 [ff61d23de260fcc8] nvme_rdma_setup_ctrl at ffffffffc1268ced\n#7 [ff61d23de260fd28] nvme_rdma_create_ctrl at ffffffffc126919b\n#8 [ff61d23de260fd68] nvmf_dev_write at ffffffffc024f362\n#9 [ff61d23de260fe38] vfs_write at ffffffff827d5f25\nRIP: 00007fda7891d574  RSP: 00007ffe2ef06958  RFLAGS: 00000202\nRAX: ffffffffffffffda  RBX: 000055e8122a4d90  RCX: 00007fda7891d574\nRDX: 000000000000012b  RSI: 000055e8122a4d90  RDI: 0000000000000004\nRBP: 00007ffe2ef079c0   R8: 000000000000012b   R9: 000055e8122a4d90\nR10: 0000000000000000  R11: 0000000000000202  R12: 0000000000000004\nR13: 000055e8122923c0  R14: 000000000000012b  R15: 00007fda78a54500\nORIG_RAX: 0000000000000001  CS: 0033  SS: 002b\nThis due to we have quiesced admi_q before cancel requests, but forgot\nto unquiesce before destroy it, as a result we fail to drain the\npending requests, and hang on blk_mq_freeze_queue_wait() forever. Here\ntry to reuse nvme_rdma_teardown_admin_queue() to fix this issue and\nsimplify the code."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-49569\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-49569\nhttps://lore.kernel.org/linux-cve-announce/2025011122-CVE-2024-49569-c532@gregkh/T"
  ]
}