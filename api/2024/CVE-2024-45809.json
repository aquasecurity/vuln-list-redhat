{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "OpenShift Service Mesh 2",
      "fix_state": "Affected",
      "package_name": "openshift-service-mesh/istio-cni-rhel8",
      "cpe": "cpe:/a:redhat:service_mesh:2"
    },
    {
      "product_name": "OpenShift Service Mesh 2",
      "fix_state": "Affected",
      "package_name": "openshift-service-mesh/pilot-rhel8",
      "cpe": "cpe:/a:redhat:service_mesh:2"
    },
    {
      "product_name": "OpenShift Service Mesh 2",
      "fix_state": "Not affected",
      "package_name": "openshift-service-mesh/proxyv2-rhel8",
      "cpe": "cpe:/a:redhat:service_mesh:2"
    },
    {
      "product_name": "OpenShift Service Mesh 2",
      "fix_state": "Not affected",
      "package_name": "openshift-service-mesh/proxyv2-rhel9",
      "cpe": "cpe:/a:redhat:service_mesh:2"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2024-09-20T00:15:02Z",
  "bugzilla": {
    "description": "envoy: JWT filter crash in the clear route cache with remote JWKs",
    "id": "2313686",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2313686"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-119",
  "statement": "This vulnerability in Envoy should be considered high-severity rather than moderate due to its potential to cause a complete crash of the service when handling JWT authentication with remote JWKs and asynchronous header processing. In cloud-native environments where Envoy is often used as a critical edge or service proxy, the conditions triggering this crash—such as the combination of route cache clearing, header operations, and JWT authentication—are not uncommon. The impact is significant because the crash occurs during normal request processing, leading to service disruption and downtime.",
  "acknowledgement": "",
  "name": "CVE-2024-45809",
  "document_distribution": "",
  "details": [
    "Envoy is a cloud-native high-performance edge/middle/service proxy. Jwt filter will lead to an Envoy crash when clear route cache with remote JWKs. In the following case: 1. remote JWKs are used, which requires async header processing; 2. clear_route_cache is enabled on the provider; 3. header operations are enabled in JWT filter, e.g. header to claims feature; 4. the routing table is configured in a way that the JWT header operations modify requests to not match any route. When these conditions are met, a crash is triggered in the upstream code due to nullptr reference conversion from route(). The root cause is the ordering of continueDecoding and clearRouteCache. This issue has been addressed in versions 1.31.2, 1.30.6, and 1.29.9. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "A flaw was found in Envoy. JWT filter will lead to a crash in Envoy when clearing the route cache with remote JWKs in the following cases: \n1. Remote JWKs are used, which requires async header processing \n2. clear_route_cache is enabled on the provider \n3. Header operations are enabled in JWT filter, for example, header to claims feature\n4. The routing table is configured in a way that the JWT header operations modify requests to not match any route\nWhen these conditions are met, a crash is triggered in the upstream code due to nullptr reference conversion from route(). The root cause is the ordering of continueDecoding and clearRouteCache."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-45809\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-45809\nhttps://github.com/envoyproxy/envoy/security/advisories/GHSA-wqr5-qmq7-3qw3"
  ]
}