{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-07-12T00:00:00Z",
  "bugzilla": {
    "description": "kernel: ext4: fix slab-out-of-bounds in ext4_mb_find_good_group_avg_frag_lists()",
    "id": "2297539",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2297539"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-125",
  "statement": "Red Hat Enterprise Linux is not vulnerable to this CVE, as it does not affect the versions or configurations of the Linux kernel used in its distributions.",
  "acknowledgement": "",
  "name": "CVE-2024-40955",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\next4: fix slab-out-of-bounds in ext4_mb_find_good_group_avg_frag_lists()\nWe can trigger a slab-out-of-bounds with the following commands:\nmkfs.ext4 -F /dev/$disk 10G\nmount /dev/$disk /tmp/test\necho 2147483647 \u003e /sys/fs/ext4/$disk/mb_group_prealloc\necho test \u003e /tmp/test/file \u0026\u0026 sync\n==================================================================\nBUG: KASAN: slab-out-of-bounds in ext4_mb_find_good_group_avg_frag_lists+0x8a/0x200 [ext4]\nRead of size 8 at addr ffff888121b9d0f0 by task kworker/u2:0/11\nCPU: 0 PID: 11 Comm: kworker/u2:0 Tainted: GL 6.7.0-next-20240118 #521\nCall Trace:\ndump_stack_lvl+0x2c/0x50\nkasan_report+0xb6/0xf0\next4_mb_find_good_group_avg_frag_lists+0x8a/0x200 [ext4]\next4_mb_regular_allocator+0x19e9/0x2370 [ext4]\next4_mb_new_blocks+0x88a/0x1370 [ext4]\next4_ext_map_blocks+0x14f7/0x2390 [ext4]\next4_map_blocks+0x569/0xea0 [ext4]\next4_do_writepages+0x10f6/0x1bc0 [ext4]\n[...]\n==================================================================\nThe flow of issue triggering is as follows:\n// Set s_mb_group_prealloc to 2147483647 via sysfs\next4_mb_new_blocks\next4_mb_normalize_request\next4_mb_normalize_group_request\nac-\u003eac_g_ex.fe_len = EXT4_SB(sb)-\u003es_mb_group_prealloc\next4_mb_regular_allocator\next4_mb_choose_next_group\next4_mb_choose_next_group_best_avail\nmb_avg_fragment_size_order\norder = fls(len) - 2 = 29\next4_mb_find_good_group_avg_frag_lists\nfrag_list = \u0026sbi-\u003es_mb_avg_fragment_size[order]\nif (list_empty(frag_list)) // Trigger SOOB!\nAt 4k block size, the length of the s_mb_avg_fragment_size list is 14,\nbut an oversized s_mb_group_prealloc is set, causing slab-out-of-bounds\nto be triggered by an attempt to access an element at index 29.\nAdd a new attr_id attr_clusters_in_group with values in the range\n[0, sbi-\u003es_clusters_per_group] and declare mb_group_prealloc as\nthat type to fix the issue. In addition avoid returning an order\nfrom mb_avg_fragment_size_order() greater than MB_NUM_ORDERS(sb)\nand reduce some useless loops.",
    "A slab-out-of-bounds vulnerability was found in the ext4 filesystem of the Linux kernel. This issue occurs when an excessively large value is set for s_mb_group_prealloc, leading to out-of-bounds reads in the ext4_mb_find_good_group_avg_frag_lists() function. This issue can be triggered by setting a high preallocation value, causing the kernel to access invalid memory locations, which can result in crashes or undefined behavior."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-40955\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-40955\nhttps://lore.kernel.org/linux-cve-announce/2024071224-CVE-2024-40955-43e2@gregkh/T"
  ]
}