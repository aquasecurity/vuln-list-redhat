{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-09-24T00:00:00Z",
      "advisory": "RHSA-2024:6997",
      "package": "kernel-0:5.14.0-427.37.1.el9_4",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-09-24T00:00:00Z",
      "advisory": "RHSA-2024:6997",
      "package": "kernel-0:5.14.0-427.37.1.el9_4",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-05-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: fork: defer linking file vma until vma is fully initialized",
    "id": "2278252",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2278252"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.1",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-362",
  "statement": "The Linux kernel as shipped in Red Hat Enterprise Linux 8 is not affected by this vulnerability because the vulnerable code was introduced in a newer version of the Linux kernel.",
  "acknowledgement": "",
  "name": "CVE-2024-27022",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nfork: defer linking file vma until vma is fully initialized\nThorvald reported a WARNING [1]. And the root cause is below race:\nCPU 1CPU 2\nforkhugetlbfs_fallocate\ndup_mmap hugetlbfs_punch_hole\ni_mmap_lock_write(mapping);\nvma_interval_tree_insert_after -- Child vma is visible through i_mmap tree.\ni_mmap_unlock_write(mapping);\nhugetlb_dup_vma_private -- Clear vma_lock outside i_mmap_rwsem!\ni_mmap_lock_write(mapping);\nhugetlb_vmdelete_list\nvma_interval_tree_foreach\nhugetlb_vma_trylock_write -- Vma_lock is cleared.\ntmp-\u003evm_ops-\u003eopen -- Alloc new vma_lock outside i_mmap_rwsem!\nhugetlb_vma_unlock_write -- Vma_lock is assigned!!!\ni_mmap_unlock_write(mapping);\nhugetlb_dup_vma_private() and hugetlb_vm_op_open() are called outside\ni_mmap_rwsem lock while vma lock can be used in the same time.  Fix this\nby deferring linking file vma until vma is fully initialized.  Those vmas\nshould be initialized first before they can be used."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-27022\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-27022\nhttps://lore.kernel.org/linux-cve-announce/2024050143-CVE-2024-27022-4325@gregkh/T"
  ]
}