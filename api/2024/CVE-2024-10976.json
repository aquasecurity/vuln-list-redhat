{
  "mitigation": "Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10785",
      "package": "postgresql:12-8100020241122084405.489197e6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-12-05T00:00:00Z",
      "advisory": "RHSA-2024:10830",
      "package": "postgresql:15-8100020241122084744.489197e6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-12-05T00:00:00Z",
      "advisory": "RHSA-2024:10831",
      "package": "postgresql:16-8100020241122085009.489197e6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-12-05T00:00:00Z",
      "advisory": "RHSA-2024:10832",
      "package": "postgresql:13-8100020241122084628.489197e6",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10787",
      "package": "postgresql:15-9050020241122141928.rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10788",
      "package": "postgresql:16-9050020241122142517.rhel9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10791",
      "package": "postgresql-0:13.18-1.el9_5",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "postgresql",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-11-14T13:00:01Z",
  "bugzilla": {
    "description": "postgresql: PostgreSQL row security below e.g. subqueries disregards user ID changes",
    "id": "2326263",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2326263"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.2",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-1250",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-10976",
  "document_distribution": "",
  "details": [
    "Incomplete tracking in PostgreSQL of tables with row security allows a reused query to view or change different rows from those intended.  CVE-2023-2455 and CVE-2016-2193 fixed most interaction between row security and user ID changes.  They missed cases where a subquery, WITH query, security invoker view, or SQL-language function references a table with a row-level security policy.  This has the same consequences as the two earlier CVEs.  That is to say, it leads to potentially incorrect policies being applied in cases where role-specific policies are used and a given query is planned under one role and then executed under other roles.  This scenario can happen under security definer functions or when a common user and query is planned initially and then re-used across multiple SET ROLEs.  Applying an incorrect policy may permit a user to complete otherwise-forbidden reads and modifications.  This affects only databases that have used CREATE POLICY to define a row security policy.  An attacker must tailor an attack to a particular application's pattern of query plan reuse, user ID changes, and role-specific row security policies.  Versions before PostgreSQL 17.1, 16.5, 15.9, 14.14, 13.17, and 12.21 are affected.",
    "A flaw was found in PostgreSQL. This vulnerability allows incorrect row-level security policies to be applied via subqueries, WITH queries, security invoker views, or SQL-language functions that reference tables with row-level security policies. This issue arises when a query is planned under one role and executed under another, potentially leading to unauthorized reads or modifications of data."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-10976\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-10976\nhttps://www.postgresql.org/support/security/CVE-2024-10976/"
  ]
}