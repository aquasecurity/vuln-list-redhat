{
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-09-24T00:00:00Z",
      "advisory": "RHSA-2024:7001",
      "package": "kernel-rt-0:4.18.0-553.22.1.rt7.363.el8_10",
      "cpe": "cpe:/a:redhat:enterprise_linux:8::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2024-09-24T00:00:00Z",
      "advisory": "RHSA-2024:7000",
      "package": "kernel-0:4.18.0-553.22.1.el8_10",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-11-12T00:00:00Z",
      "advisory": "RHSA-2024:9315",
      "package": "kernel-0:5.14.0-503.11.1.el9_5",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2024-11-12T00:00:00Z",
      "advisory": "RHSA-2024:9315",
      "package": "kernel-0:5.14.0-503.11.1.el9_5",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10772",
      "package": "kernel-0:5.14.0-284.95.1.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.2 Extended Update Support",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10773",
      "package": "kernel-rt-0:5.14.0-284.95.1.rt14.380.el9_2",
      "cpe": "cpe:/a:redhat:rhel_eus:9.2::nfv"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.4 Extended Update Support",
      "release_date": "2024-12-04T00:00:00Z",
      "advisory": "RHSA-2024:10771",
      "package": "kernel-0:5.14.0-427.47.1.el9_4",
      "cpe": "cpe:/a:redhat:rhel_eus:9.4"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-08-07T00:00:00Z",
  "bugzilla": {
    "description": "kernel: x86/bhi: Avoid warning in #DB handler due to BHI mitigation",
    "id": "2303508",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2303508"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-99",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2024-42240",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nx86/bhi: Avoid warning in #DB handler due to BHI mitigation\nWhen BHI mitigation is enabled, if SYSENTER is invoked with the TF flag set\nthen entry_SYSENTER_compat() uses CLEAR_BRANCH_HISTORY and calls the\nclear_bhb_loop() before the TF flag is cleared. This causes the #DB handler\n(exc_debug_kernel()) to issue a warning because single-step is used outside the\nentry_SYSENTER_compat() function.\nTo address this issue, entry_SYSENTER_compat() should use CLEAR_BRANCH_HISTORY\nafter making sure the TF flag is cleared.\nThe problem can be reproduced with the following sequence:\n$ cat sysenter_step.c\nint main()\n{ asm(\"pushf; pop %ax; bts $8,%ax; push %ax; popf; sysenter\"); }\n$ gcc -o sysenter_step sysenter_step.c\n$ ./sysenter_step\nSegmentation fault (core dumped)\nThe program is expected to crash, and the #DB handler will issue a warning.\nKernel log:\nWARNING: CPU: 27 PID: 7000 at arch/x86/kernel/traps.c:1009 exc_debug_kernel+0xd2/0x160\n...\nRIP: 0010:exc_debug_kernel+0xd2/0x160\n...\nCall Trace:\n\u003c#DB\u003e\n? show_regs+0x68/0x80\n? __warn+0x8c/0x140\n? exc_debug_kernel+0xd2/0x160\n? report_bug+0x175/0x1a0\n? handle_bug+0x44/0x90\n? exc_invalid_op+0x1c/0x70\n? asm_exc_invalid_op+0x1f/0x30\n? exc_debug_kernel+0xd2/0x160\nexc_debug+0x43/0x50\nasm_exc_debug+0x1e/0x40\nRIP: 0010:clear_bhb_loop+0x0/0xb0\n...\n\u003c/#DB\u003e\n\u003cTASK\u003e\n? entry_SYSENTER_compat_after_hwframe+0x6e/0x8d\n\u003c/TASK\u003e\n[ bp: Massage commit message. ]",
    "A denial of service vulnerability was found in the Linux kernel. When BHI mitigation is enabled, if SYSENTER is invoked with the TF flag set, then entry_SYSENTER_compat() uses CLEAR_BRANCH_HISTORY and calls the clear_bhb_loop() before the TF flag is cleared. This causes the #DB handler (exc_debug_kernel()) to issue a warning that results in a software crash."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2024-42240\nhttps://nvd.nist.gov/vuln/detail/CVE-2024-42240\nhttps://lore.kernel.org/linux-cve-announce/2024080741-CVE-2024-42240-3d04@gregkh/T"
  ]
}