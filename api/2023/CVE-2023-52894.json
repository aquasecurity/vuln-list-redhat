{
  "mitigation": "Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2024-08-21T00:00:00Z",
  "bugzilla": {
    "description": "kernel: usb: gadget: f_ncm: fix potential NULL ptr deref in ncm_bitrate()",
    "id": "2306422",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2306422"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-476",
  "statement": "Red Hat Enterprise Linux is not impacted by this CVE, as the vulnerability in question does not affect the specific versions or configurations of the Linux kernel used in its distributions. This makes sure that users of Red Hat Enterprise Linux are not exposed to the potential risks associated with this issue, and no further action or mitigation is necessary for systems running this operating system.",
  "acknowledgement": "",
  "name": "CVE-2023-52894",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nusb: gadget: f_ncm: fix potential NULL ptr deref in ncm_bitrate()\nIn Google internal bug 265639009 we've received an (as yet) unreproducible\ncrash report from an aarch64 GKI 5.10.149-android13 running device.\nAFAICT the source code is at:\nhttps://android.googlesource.com/kernel/common/+/refs/tags/ASB-2022-12-05_13-5.10\nThe call stack is:\nncm_close() -\u003e ncm_notify() -\u003e ncm_do_notify()\nwith the crash at:\nncm_do_notify+0x98/0x270\nCode: 79000d0b b9000a6c f940012a f9400269 (b9405d4b)\nWhich I believe disassembles to (I don't know ARM assembly, but it looks sane enough to me...):\n// halfword (16-bit) store presumably to event-\u003ewLength (at offset 6 of struct usb_cdc_notification)\n0B 0D 00 79    strh w11, [x8, #6]\n// word (32-bit) store presumably to req-\u003eLength (at offset 8 of struct usb_request)\n6C 0A 00 B9    str  w12, [x19, #8]\n// x10 (NULL) was read here from offset 0 of valid pointer x9\n// IMHO we're reading 'cdev-\u003egadget' and getting NULL\n// gadget is indeed at offset 0 of struct usb_composite_dev\n2A 01 40 F9    ldr  x10, [x9]\n// loading req-\u003ebuf pointer, which is at offset 0 of struct usb_request\n69 02 40 F9    ldr  x9, [x19]\n// x10 is null, crash, appears to be attempt to read cdev-\u003egadget-\u003emax_speed\n4B 5D 40 B9    ldr  w11, [x10, #0x5c]\nwhich seems to line up with ncm_do_notify() case NCM_NOTIFY_SPEED code fragment:\nevent-\u003ewLength = cpu_to_le16(8);\nreq-\u003elength = NCM_STATUS_BYTECOUNT;\n/* SPEED_CHANGE data is up/down speeds in bits/sec */\ndata = req-\u003ebuf + sizeof *event;\ndata[0] = cpu_to_le32(ncm_bitrate(cdev-\u003egadget));\nMy analysis of registers and NULL ptr deref crash offset\n(Unable to handle kernel NULL pointer dereference at virtual address 000000000000005c)\nheavily suggests that the crash is due to 'cdev-\u003egadget' being NULL when executing:\ndata[0] = cpu_to_le32(ncm_bitrate(cdev-\u003egadget));\nwhich calls:\nncm_bitrate(NULL)\nwhich then calls:\ngadget_is_superspeed(NULL)\nwhich reads\n((struct usb_gadget *)NULL)-\u003emax_speed\nand hits a panic.\nAFAICT, if I'm counting right, the offset of max_speed is indeed 0x5C.\n(remember there's a GKI KABI reservation of 16 bytes in struct work_struct)\nIt's not at all clear to me how this is all supposed to work...\nbut returning 0 seems much better than panic-ing...",
    "A vulnerability was found in the Linux kernel's USB f_ncm.c driver where a lack of proper sanitization can result in a potential NULL pointer dereference in the ncm_bitrate() function. This issue can occur if cdev-\u003egadget happens to be NULL when it is referenced by the ncm_bitrate() function, which then passes it to the gadget_is_superspeed() function, where the eventual NULL pointer dereference occurs. This vulnerability potentially leads to undefined behavior or crashes."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-52894\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-52894\nhttps://lore.kernel.org/linux-cve-announce/2024082111-CVE-2023-52894-c8ee@gregkh/T"
  ]
}