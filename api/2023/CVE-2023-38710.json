{
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "release_date": "2023-11-14T00:00:00Z",
      "advisory": "RHSA-2023:7052",
      "package": "libreswan-0:4.12-2.el8",
      "cpe": "cpe:/a:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-11-07T00:00:00Z",
      "advisory": "RHSA-2023:6549",
      "package": "libreswan-0:4.12-1.el9",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9.0 Update Services for SAP Solutions",
      "release_date": "2024-12-02T00:00:00Z",
      "advisory": "RHSA-2024:10594",
      "package": "libreswan-0:4.6-3.el9_0.3",
      "cpe": "cpe:/a:redhat:rhel_e4s:9.0"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.15",
      "release_date": "2025-01-02T00:00:00Z",
      "advisory": "RHBA-2024:11565",
      "package": "libreswan-0:4.6-3.el9_0.3",
      "cpe": "cpe:/a:redhat:openshift:4.15::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.16",
      "release_date": "2025-01-02T00:00:00Z",
      "advisory": "RHBA-2024:11505",
      "package": "libreswan-0:4.6-3.el9_0.3",
      "cpe": "cpe:/a:redhat:openshift:4.16::el9"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4.17",
      "release_date": "2025-01-02T00:00:00Z",
      "advisory": "RHBA-2024:11525",
      "package": "libreswan-0:4.6-3.el9_0.3",
      "cpe": "cpe:/a:redhat:openshift:4.17::el9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "libreswan",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "libreswan",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-08-08T00:00:00Z",
  "bugzilla": {
    "description": "libreswan: Invalid IKEv2 REKEY proposal causes restart",
    "id": "2225368",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2225368"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-617",
  "statement": "IKEv2 REKEY requests are only processed when received from authenticated peers, limiting the scope of possible attackers to peers who have successfully authenticated.",
  "acknowledgement": "Red Hat would like to thank X1AOxiang for reporting this issue.",
  "name": "CVE-2023-38710",
  "document_distribution": "",
  "details": [
    "An issue was discovered in Libreswan before 4.12. When an IKEv2 Child SA REKEY packet contains an invalid IPsec protocol ID number of 0 or 1, an error notify INVALID_SPI is sent back. The notify payload's protocol ID is copied from the incoming packet, but the code that verifies outgoing packets fails an assertion that the protocol ID must be ESP (2) or AH(3) and causes the pluto daemon to crash and restart. NOTE: the earliest affected version is 3.20.",
    "An assertion failure flaw was found in the Libreswan package that occurs when processing IKEv2 REKEY requests. When an IKEv2 Child SA REKEY packet contains an invalid IPsec protocol ID number of 0 or 1, an error notification INVALID_SPI is sent back. The notify payload's protocol ID is copied from the incoming packet, but the code that verifies outgoing packets fails an assertion that the protocol ID must be ESP (2) or AH(3). This flaw allows a malicious client or attacker to send a malformed IKEv2 REKEY packet, causing a crash and restarting the libreswan pluto daemon. When sent continuously, this could lead to a denial of service attack."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2023-38710\nhttps://nvd.nist.gov/vuln/detail/CVE-2023-38710\nhttps://github.com/libreswan/libreswan/releases/tag/v4.12\nhttps://libreswan.org/security/CVE-2023-38710/CVE-2023-38710.txt"
  ]
}